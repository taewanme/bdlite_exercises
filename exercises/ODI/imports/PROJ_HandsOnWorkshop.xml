<?xml version="1.0" encoding="ISO-8859-1"?>
<SunopsisExport>
<Admin RepositoryVersion="05.01.01.16" IsLegacyIdCompatible="false" />
<Object class="com.sunopsis.dwg.dbobj.SnpProject">
		<Field name="BegVersion" type="java.sql.Timestamp">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ff0075bc-ff55-4a52-b3a7-f6aa674d2046]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ProjectCode" type="java.lang.String"><![CDATA[HANDSONWORKSHOP]]></Field>
	<Field name="ProjectName" type="java.lang.String"><![CDATA[HandsOnWorkshop]]></Field>
	<Field name="PrvVersion" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpGrpState">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7bc0ee0b-2008-4e55-8967-1e8672031c86]]></Field>
	<Field name="GrpOrderDisp" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="GrpStateCode" type="java.lang.String"><![CDATA[PRIORITIES]]></Field>
	<Field name="GrpStateName" type="java.lang.String"><![CDATA[Priorities]]></Field>
	<Field name="IndAutoIncrement" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IndInternal" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndMultiStates" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[14]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="TreeDisplay" type="java.lang.String"><![CDATA[A]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5bf0d5a5-0515-4a42-a05f-7524b9557c94]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskprior_1.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[14]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[39]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PRIORITY_1]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Priority 1]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b9b0f6c9-c5bd-4299-87cb-df95f7d7de07]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskprior_2.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[14]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PRIORITY_2]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Priority 2]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[584a0624-89ac-4df4-b49e-c89a8f39b3cd]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskprior_3.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[14]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[41]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PRIORITY_3]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Priority 3]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d552f409-a94f-4f1f-9c0d-00b1df30e3fc]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskprior_4.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[14]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[42]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PRIORITY_4]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Priority 4]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ed94ecd6-5e8e-4d5f-95b6-2887cc8dd2b3]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskprior_5.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[14]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[43]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PRIORITY_5]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Priority 5]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpGrpState">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c9d974de-3420-424d-831b-9f9890babd55]]></Field>
	<Field name="GrpOrderDisp" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="GrpStateCode" type="java.lang.String"><![CDATA[PROGRESS]]></Field>
	<Field name="GrpStateName" type="java.lang.String"><![CDATA[Progress]]></Field>
	<Field name="IndAutoIncrement" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IndInternal" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndMultiStates" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="TreeDisplay" type="java.lang.String"><![CDATA[A]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7e0c4b45-58e1-452b-841d-c14375ae5c2f]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskdone.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[51]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[DONE]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Done]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[80]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e5587c8e-cd7c-421c-8728-d0669a107263]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskcomp_10.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[44]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PROGRESS_10__]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Progress 10 %]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[bbb6361e-ab29-4049-9f8a-02bfdf1a59cb]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskcomp_25.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[45]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PROGRESS_25__]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Progress 25 %]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7687a74e-8c09-4a10-97b2-4131134d7919]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskcomp_35.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[46]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PROGRESS_35__]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Progress 35 %]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2e7b8544-1870-4848-ae50-95803d4bc63e]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskcomp_50.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[47]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PROGRESS_50__]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Progress 50 %]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[05daee28-b680-425b-9a69-2d5b2937a5db]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskcomp_65.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[48]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PROGRESS_65__]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Progress 65 %]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c4f06e38-9931-4654-8790-e5cc2b2a1ead]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskcomp_75.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[49]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PROGRESS_75__]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Progress 75 %]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a86fb7bf-7d37-4860-bff4-431c661bd8d8]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/taskcomp_90.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[15]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[PROGRESS_90__]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Progress 90 %]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpGrpState">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[38b62e1f-0614-478b-9abb-c05f8e66ace2]]></Field>
	<Field name="GrpOrderDisp" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
	<Field name="GrpStateCode" type="java.lang.String"><![CDATA[SMILEYS]]></Field>
	<Field name="GrpStateName" type="java.lang.String"><![CDATA[Smileys]]></Field>
	<Field name="IndAutoIncrement" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IndInternal" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndMultiStates" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[16]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="TreeDisplay" type="java.lang.String"><![CDATA[B]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ca7a2266-a646-4b2a-b519-a451f6aabe2d]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/smiley_1.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[16]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[52]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[SMILEY_1]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Smiley 1]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[62304fd8-9ce1-409c-b503-db983caa0bcf]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/smiley_2.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[16]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[53]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[SMILEY_2]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Smiley 2]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[cd994d82-4c13-4154-9597-6a06363bca9b]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/smiley_3.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[16]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[54]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[SMILEY_3]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Smiley 3]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0e171c86-935c-47b3-8dca-3261dbbfb81a]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/smiley_4.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[16]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[55]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[SMILEY_4]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Smiley 4]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpState2">
		<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9444c3f0-74d5-406c-b68f-884a91215156]]></Field>
	<Field name="IconRes" type="java.lang.String"><![CDATA[/markers/smiley_5.gif]]></Field>
	<Field name="IndChange" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="InUse" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IGrpState" type="com.sunopsis.sql.DbInt"><![CDATA[16]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[56]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="ShowDesc" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="StateCode" type="java.lang.String"><![CDATA[SMILEY_5]]></Field>
	<Field name="StateDatatype" type="java.lang.String"><![CDATA[A]]></Field>
	<Field name="StateName" type="java.lang.String"><![CDATA[Smiley 5]]></Field>
	<Field name="StateOrder" type="com.sunopsis.sql.DbInt"><![CDATA[4]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="BaseKmType" type="java.lang.String">null</Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GenType" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ea761be9-9f0c-460b-bb6a-5f18a4e716f7]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="IsConcurrent" type="java.lang.String">null</Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[513]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmDefault" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="KmVersion" type="java.lang.String"><![CDATA[9]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:19.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[1378629286]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[CKM Hive]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[KC]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp"><![CDATA[2009-05-28 16:01:34.0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ec6aadd7-004a-4f5e-a7c7-c6c72fa47873]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[513]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[COMPONENT NAME: CKM Hive
AUTHOR: Oracle

DESCRIPTION
	This KM checks data integrity for Hive tables. It verifies the validity of the constraints of a Datastore and 
	rejects the invalid records into an error table. It can be used for static control as well as flow control.

REQUIREMENTS
	- Data cleansing can be performed only if an update key/ primary key is defined on the controlled table.
	- UNIX environment variable ODI_HIVE_SESSION_JARS must contain hive-contrib.jar, if RegExSerDe used anywhere; 

OPTIONS (Refer to Option descriptions for more information on each option)
	- DROP_ERROR_TABLE: drop error table prior to execution?

LIMITATIONS
	- Row counter/ insert/ error counter does not reflect number of rows loaded
	- Complex SQL RI constraints are not supported
	- Concurrency: only a single CKM can be executed for the same datastore at a time, no matter whether static 
	   or flow control.

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Edit Command]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_TRT_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[12390497-52f6-4b59-9f4a-a57dfa51efa6]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[514]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DROP_ERROR_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Drop the Error table]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5591ef7a-02d9-475e-903d-23ae2988653e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[514]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[When this option is set to YES, the error table will be dropped each time a control is performed on the target table. This means that any rejected records, identified and stored during previous control operations, will be lost. Otherwise previous rejects will be preserved.  In addition to the error table, any table called <error table>_tmp will also be dropped.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[User Exit help]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_UE_HELP]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_USER_EXIT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[32c44e73-54a6-4fbd-97c7-729b104b450f]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[515]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[147]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0.8]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[HIVE_COMPATIBLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Hive version compatibility]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e0e33a27-0179-4eb8-a825-2391f9ecbba2]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[515]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Hive version compatibility.

Permitted values: 0.7 or 0.8
Default: 0.8]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[516]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[84911d9f-eaf8-4bf5-bf80-4d3cb0f8d98a]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[E]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[282]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[371]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Control records]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4218bc2e-2ec9-4f0c-ac9d-a8c5ba9c310d]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[516]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% legacyHive 	= odiRef.getOption("HIVE_COMPATIBLE").equals("0.7"); %>

<% if ( legacyHive ) { %>
// Duplicate error table
hive.executeQuery( '''
     drop table if exists <%=odiRef.getTable("L","ERR_NAME", "W")%>_tmp
''' )
hive.executeQuery( '''
     create table <%=odiRef.getTable("L","ERR_NAME", "W")%>_tmp like <%=odiRef.getTable("L","ERR_NAME", "W")%>
''' )
<% } %>


// Insert errors
sql = '''

<% if ( legacyHive ) { %>
   insert overwrite table <%=odiRef.getTable("L","ERR_NAME", "W")%>_tmp 
<% } else { %>
   insert into table <%=odiRef.getTable("L","ERR_NAME", "W")%> 
<% } %>

<%=ckmRef.getColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>

select	ODI_ERR_TYPE, 
	ODI_ERR_MESS,
	ODI_CHECK_DATE, 
	<% if (odiRef.getInfo( "CT_ERR_TYPE" ).equals("S")) { /* Static Control */
		%><%=ckmRef.getAllTargetColList("", "[COL_NAME]", ",\n\t", "", "NOT PARTITION")%><%
	} else { /* Flow Control */ 
		%><%=ckmRef.getAllTargetColList("", "[COL_NAME__NULL_IF_ON_TARGET] \tas [COL_NAME]", ",\n\t", "", "NOT PARTITION")%><%
	} %>,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ODI_SESS_NO
	<%=ckmRef.getAllTargetColList(",", "[COL_NAME__NULL_IF_ON_TARGET] \tas [COL_NAME]", ",\n\t", "", "PARTITION")%>
from (

<% if (odiRef.getInfo( "CT_ERR_TYPE" ).equals("F") && odiRef.getOption("DROP_ERROR_TABLE").equals("0")) { 
/* For FlowControl when preserving old error table ... */ %>
   <% if ( legacyHive ) { %>
	-- Combine with all old errors, except those, which would be deleted in step "Delete previous errors"
	select	ODI_SESS_NO, 
		ODI_ERR_TYPE, 
		ODI_ERR_MESS,
		ODI_ORIGIN,
		ODI_CHECK_DATE,
		ODI_CONS_NAME,
		ODI_CONS_TYPE,	
		<%=odiRef.getColList("", "[COL_NAME]", ",\n\t\t", "", "MAP")%>
	from	<%=odiRef.getTable("L","ERR_NAME", "W")%> ERR
	where	not(
		(ODI_ERR_TYPE = 'S'	and '<%=odiRef.getInfo("CT_ERR_TYPE")%>' = 'S')
		or	(ODI_ERR_TYPE = '<%=odiRef.getInfo("CT_ERR_TYPE")%>'	and ODI_ORIGIN = '<%=odiRef.getInfo("CT_ORIGIN")%>')
		)

	union all
   <% } %>
<% } %>

<%=selectErrors%>

) ALL_ERRORS

<%= /* add distribute expression to avoid unbalanced dynamic partition creation and resulting failures */ 
	ckmRef.getAllTargetColList( "distribute by\t", "[COL_NAME]", ",", "", "PARTITION")%>

'''

hive.executeQuery( sql )


<% if ( legacyHive ) { %>

// Drop old check table
hive.executeQuery( '''
     drop table <%=odiRef.getTable("L","ERR_NAME", "W")%>
''' )


// Rename new check table
hive.executeQuery( '''
     alter table <%=odiRef.getInfo("ERR_NAME")%>_tmp rename to <%=odiRef.getInfo("ERR_NAME")%>
     <% /* Omitting the schema names to work-around  HIVE-2496. The correct code should be
     --alter table < %=odiRef.getTable("L","ERR_NAME", "W")% >_tmp rename to < %=odiRef.getTable("L","ERR_NAME", "W")% >
     */ %>
''' )

<% } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Target Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[DEF_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[517]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2cc9c840-cadf-48c9-8632-d3c97b9fc0b5]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[283]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Prepare Hive session]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5e2c54b3-5b45-4b40-9d8b-ad3a13d2b2e6]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[517]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% isODI12cOrLater = !odiRef.getInfo("ODI_MAJOR_VERSION").contains("ODI_MAJOR_VERSION"); %>

<% /* -------- Begin of block ----- Keep this block in sync across all Hive KMs ----------- */ %>
<%

/* Begin of BSh code gen extensions */

out2 = null;
buffer = null;

startCapture() {
    out2 = out;
    buffer = new ByteArrayOutputStream();
    out = new PrintWriter( buffer );
}

endCapture() {
    out.flush();
    out.close();
    captured = buffer.toString();
    out = out2;
    return captured;
}

getQuotedMLString( s ) {
// escape tripple single quotes
// escape backslashes
    return 
        "'''" + 
        s.replace(""+(char)92, ""+(char)92+(char)92)
        .replace( "'''", ""+(char)92+"'"+(char)92+"'"+(char)92+"'") +
        "'''";
}

/* End of BSh code gen extensions */

%>


<% /* Begin of Hive Runtime-API */ %>

import java.lang.System
import java.sql.Statement
import java.sql.Connection
import java.sql.SQLException


class flexUtilHive {
    Statement stmt;
    public Connection con;

    flexUtilHive( Connection pCon ) {
        con = pCon
        if (con == null) 
            throw new RuntimeException( "\nFailure to open JDBC connection. Please test DataServer connection." );


        // Set session parameters for dynamic partitions
        stmt = con.createStatement()
        stmt.execute( """set hive.exec.dynamic.partition=true""" )
        stmt.execute( """set hive.exec.dynamic.partition.mode=nonstrict""" )
        stmt.execute( """set hive.enforce.bucketing=true""" )
        stmt.execute( """set hive.optimize.bucketmapjoin=true""" )
        //stmt.execute( """set mapred.job.reuse.jvm.num.tasks=-1""" )
        // Add custom jars to this Hive session
        String sExtraJars = """<?=(System.getenv("ODI_HIVE_SESSION_JARS")!=null)?System.getenv("ODI_HIVE_SESSION_JARS"):""?>"""
        if (sExtraJars != "") {
            def lstExtraJars = sExtraJars.split( ":" )
            for (j in lstExtraJars) {
                stmt.execute( """add jar """ + j )
            }
        }
    }

    // Function for executing Hive SQL statements
    def executeQuery( String sql ) {
        try {
            stmt.executeUpdate( sql )
        } catch (SQLException re) {
            def msg = "Exception encountered while submitting: \n-------------------\n" + sql + "\n-------------------"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

    // Check if a table already exists
    def tableExists( String schema, String table ) {
        try {
            def dbm = con.getMetaData()
            def rs = dbm.getTables(null, schema.toLowerCase(), table.toLowerCase(), null)
            return rs.next()
        } catch (SQLException re) {
            def msg = "Exception encountered while checking existence of table "+schema+"."+table+" !"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

}

<% /* End of hive Runtime-API */ %>


<%

// Is there already an API defined?
if (IkmHiveApi != void) {

    // Verify correct version and error out, if not
    if (IkmHiveApi.getVersion() != 1) 
        out.print( "<? throw new RuntimeException( \u0022\u0022+(char)10+(char)10+(char)10+\u0022You are using Hive KMs from different versions. Please make sure to use all Hive KMs from the same ODI version/patch.\u0022+(char)10+(char)10+(char)10 );?>");

} else {

/* Begin of IkmHiveApi.java */

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;

import com.sun.org.apache.xpath.internal.Expression;


public class IkmHiveApi {
	public static final String DELIMITER = ""+(char)1;
	public static final String RE_Q = ""+(char)92+"Q";
	public static final String RE_E = ""+(char)92+"E";

	       static final String MISSING_FLEXFIELD_GETCOLLIST = "Exception getColList(";
           static final String MISSING_FLEXFIELD_GETINFO = "Exception getInfo(";
           static final String EXPRESSION_NOT_SUPPORTED = "[EXPRESSION] not supported in getAllTargetColList";
	       static final String DELIMITER_REGEX = RE_Q+ DELIMITER +RE_E;
	public static final String SELECTOR_PARTITION =              "PARTITION";
	public static final String SELECTOR_NOT_PARTITION =          "NOT PARTITION";
    public static final String SELECTOR_PARTITION_COND1 =        "PARTITION AND (UNMAPPED OR TARGET)";
    public static final String SELECTOR_CLUSTER =                "CLUSTER";
	public static final String SELECTOR_PARTITION_OR_CLUSTER =   "PARTITION OR CLUSTER";
    public static final String SELECTOR_SORT =                   "SORT";
           static final String PATTERN_COL_NAME = "[COL_NAME]";
           static final String PATTERN_DEST_CRE_DT = "[DEST_CRE_DT]";
           static final String PATTERN_EXPRESSION = "[EXPRESSION]";
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED =      "[EXPRESSION__NULL_IF_UNMAPPED]";
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET = "[COL_NAME__EXPRESSION_IF_ON_TARGET]";
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET =       "[COL_NAME__NULL_IF_ON_TARGET]";
           static final String PATTERN_MAPPED_ON_TARGET =                  "[MAPPED_ON_TARGET]";
           static final String PATTERN_UNMAPPED =                          "[UNMAPPED]";
           /*static final String PATTERN_COL_NAME_REGEX = RE_Q+ PATTERN_COL_NAME +RE_E;
           static final String PATTERN_DEST_CRE_DT_REGEX = RE_Q+ PATTERN_DEST_CRE_DT +RE_E;
           static final String PATTERN_EXPRESSION_REGEX = RE_Q+ PATTERN_EXPRESSION +RE_E;
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED_REGEX = RE_Q+ PATTERN_EXPRESSION__NULL_IF_UNMAPPED +RE_E;
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET +RE_E;
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__NULL_IF_ON_TARGET +RE_E;
           static final String PATTERN_MAPPED_ON_TARGET_REGEX = RE_Q+ PATTERN_MAPPED_ON_TARGET +RE_E;
           */
	       
           static final String MARKER_SCRIPTNAME = "SNP$SCRIPTNAME";
           static final String MARKER_SCRIPTFULLNAME = "SNP$SCRIPTFULLNAME";
           static final String MARKER_SCRIPT = "SNP$SCRIPTTEXT";
           static final String MARKER_SCRIPTEND = "SNP$SCRIPTTEXTEND";
	
	LinkedHashMap 
	    cols,          // contains all columns (getColList)
	    allTargetCols; // contains all columns including the target columns (getAllTargetColList)
	String buckets;    // contains the number of buckets for this target

	private class ColInfo {
		static final String PROP_TRG = "TRG";
		static final String PROP_UD1 = "UD1";
		static final String PROP_UD2 = "UD2";
		static final String PROP_UD3 = "UD3";
		static final String PROP_FF_PART = "PART";
		static final String PROP_FF_CLUST = "CUST";
		static final String PROP_FF_SORT = "SORT";
		
		String colName, colDt, colExpr;
		boolean bTarget, bUd1, bUd2, bUd3, bFlexPartCol, bFlexClustCol, bFlexSortCol = false;
		
		public ColInfo( String pColName, String pColDt, String pColExpr, boolean pIsPartCol, boolean pIsClustCol, boolean pIsSortCol ) {
			colName = pColName;
			colDt   = pColDt;
			colExpr = pColExpr;
			bFlexPartCol = pIsPartCol;
            bFlexClustCol = pIsClustCol;
            bFlexSortCol = pIsSortCol;
		}
		public void set( String pProperty, boolean v )		{ 
			if      ( pProperty == PROP_TRG ) 	bTarget = v;
			else if ( pProperty == PROP_UD1 ) 	bUd1 = v;
			else if ( pProperty == PROP_UD2 ) 	bUd2 = v;
			else if ( pProperty == PROP_UD3 ) 	bUd3 = v;
			else if ( pProperty == PROP_FF_PART )	bFlexPartCol  = v;
			else if ( pProperty == PROP_FF_CLUST )  bFlexClustCol = v;
			else if ( pProperty == PROP_FF_SORT )	bFlexSortCol  = v;
		};
		public String getColName() { return colName; }
		public String getDataType() { return colDt; }
		public String getExpression() { return colExpr; }
		public boolean isTarget() { return bTarget; }
		public boolean isMapped() { return !colExpr.equals(EXPRESSION_NOT_SUPPORTED) && colExpr.trim().length()>0; };
		public boolean isUd1() { return bUd1; }
		public boolean isUd2() { return bUd2; }
		public boolean isUd3() { return bUd3; }
		public boolean isPartitionBy() { return bFlexPartCol; }
        public boolean isClusterBy() { return bFlexClustCol; }
        public boolean isSortBy() { return bFlexSortCol; }
	}

	// Return the version of the code gen API. 
	// Used for testing that all KMs in a session are using the same API version
	public static int getVersion() {
	    return 1;
	}
	
	public String initMetadata(
	        boolean dumpMetadata,
			String pAllCols,
			String pAllDts,
			String pAllExpr,
			String pTrgCols,
			String pUd1Cols,
			String pUd2Cols,
			String pUd3Cols,
			String pAllPartCols,
			String pAllClustCols,
			String pAllSortCols,
            String pAllTrgCols,
            String pAllTrgDts,
            String pAllTrgPartCols,
            String pAllTrgClustCols,
            String pAllTrgSortCols,
            String pKMOptionBuckets,
            String pFFBuckets
			) {	    
	    if (dumpMetadata) {
	        String pre = ""+(char)34;
	        String post = ""+(char)34+","+(char)10;
	        return 
            "/* inst.initMetadata("+(char)10+
            "false,"+(char)10+
            pre+pAllCols+post+
            pre+pAllDts+post+
            pre+pAllExpr+post+
            pre+pTrgCols+post+
            pre+pUd1Cols+post+
            pre+pUd2Cols+post+
            pre+pUd3Cols+post+
            pre+pAllPartCols+post+
            pre+pAllClustCols+post+
            pre+pAllSortCols+post+
            pre+pAllTrgCols+post+
            pre+pAllTrgDts+post+
            pre+pAllTrgPartCols+post+
            pre+pAllTrgClustCols+post+
            pre+pAllTrgSortCols+post+
            pre+pKMOptionBuckets+post+
            pre+pFFBuckets+(char)34+(char)10+
            "); */";
	    };
	    
        /* TODO: Sort cols still needs to be implemented */
		String[] allCols         = pAllCols.split(DELIMITER_REGEX,-1);
		String[] allDts          = pAllDts.split(DELIMITER_REGEX,-1);
		String[] allExpr         = pAllExpr.split(DELIMITER_REGEX,-1);
		String[] allPartCols     = pAllPartCols.split(DELIMITER_REGEX,-1);
		String[] allClustCols    = pAllClustCols.split(DELIMITER_REGEX,-1);
        String[] allSortCols     = pAllSortCols.split(DELIMITER_REGEX,-1);
        String[] allTrgCols      = pAllTrgCols.split(DELIMITER_REGEX,-1);
        String[] allTrgDts       = pAllTrgDts.split(DELIMITER_REGEX,-1);
        String[] allTrgPartCols  = pAllTrgPartCols.split(DELIMITER_REGEX,-1);
        String[] allTrgClustCols = pAllTrgClustCols.split(DELIMITER_REGEX,-1);
        String[] allTrgSortCols  = pAllTrgSortCols.split(DELIMITER_REGEX,-1);
		
		/* Create all column objects */
        cols = new LinkedHashMap();
	    for(int j=0; j<allCols.length; j++){
	        String  colName    = allCols[j];
	        String  colDt      = allDts[j];
	        String  colExpr    = allExpr[j];
        	boolean isPartCol  = false;
            boolean isClustCol = false; 
            boolean isSortCol  = false; 
	        /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
	           and must be ignored. */
	        if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isPartCol  = (allPartCols[j].equals("0"))? false : true;
	        }
	        if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isClustCol = (allClustCols[j].equals("0"))? false : true; 
	        }
            if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                isSortCol = (allSortCols[j].equals("0"))? false : true; 
            }
	        cols.put(colName, new ColInfo( colName, colDt, colExpr, isPartCol, isClustCol, isSortCol ) );
	    };
	    set( cols, ColInfo.PROP_TRG, pTrgCols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD1, pUd1Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD2, pUd2Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD3, pUd3Cols.split(DELIMITER_REGEX) );

	    /* Create allTargetCols list */
        allTargetCols = new LinkedHashMap();
        for(int j=0; j<allTrgCols.length; j++){
            String  colName    = allTrgCols[j];
            // Does this column already exist in cols ?
            ColInfo colObj = (ColInfo) cols.get( colName );
            if ( colObj != null )
                // then lets copy it
                allTargetCols.put( colName, colObj );
            else {
                // otherwise it's a column without any mapping and we need to create a new ColInfo Object for it
                String  colDt      = allTrgDts[j];
                boolean isPartCol  = false;
                boolean isClustCol = false; 
                boolean isSortCol = false; 
                /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
                   and must be ignored. */
                if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isPartCol  = (allTrgPartCols[j].equals("0"))? false : true;
                }
                if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isClustCol = (allTrgClustCols[j].equals("0"))? false : true; 
                }
                if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isSortCol = (allTrgSortCols[j].equals("0"))? false : true; 
                }
                allTargetCols.put(colName, new ColInfo( colName, colDt, EXPRESSION_NOT_SUPPORTED, isPartCol, isClustCol, isSortCol ) );
            };

        };
        
        /* Process buckets information */
        buckets = "";
        if ( pFFBuckets.length() > 0 && !pFFBuckets.startsWith(MISSING_FLEXFIELD_GETINFO) )
            buckets = pFFBuckets;
        if ( pKMOptionBuckets.length() > 0 )
            buckets = pKMOptionBuckets;
        
        return "";
	}
	
	/**
	 * Set property pField (UD1, UD2 etc) for all columns listed in pCols
	 * @param pAllCols
	 * @param pField
	 * @param pCols
	 */
	static void set( HashMap pAllCols, String pProperty, String[] pCols ){
		/* Check, if pCols just contains a single empty string */
		if ( pCols.length == 1 && pCols[0].length() == 0 ) return;
		/* Loop over all columns and set the respective property */
	    for(int j=0; j<pCols.length; j++){
	        String colName = pCols[j];
	    	ColInfo col = (ColInfo) pAllCols.get( colName );
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) throw new RuntimeException( "IKM Hive Control Append: set(): Internal Error: Cannot find column: " + colName );
	    	col.set( pProperty, true );
	    };			
	}
	
    public String getColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( cols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    public String getAllTargetColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( allTargetCols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    static private String getColList(
            LinkedHashMap cols,
			String pStart,
			String pPattern,
			String pSeparator,
			String pEnd,
			String pSelector) {
		StringBuffer rv = new StringBuffer();
		if ( ! (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) ||
						pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) ||
                        pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_SORT ) )) {
		    String msg = "IKM Hive Control Append: getColList(): invalid selector received: " + pSelector;
			/* Not yet supported in ODI 11.1.1.6.0:
			 * throw new RuntimeException( msg ); 
			 */
			return msg;
    }
        Iterator iter = cols.keySet().iterator();       
        while(iter. hasNext()){
        	String colName = (String) iter.next();
        	ColInfo col = (ColInfo) cols.get( colName );
        	
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) {
	    	    String msg = "IKM Hive Control Append: getColList(): Internal Error: Cannot find column: " + colName;
	    	    /* Not yet supported in ODI 11.1.1.6.0:
	    	     * throw new RuntimeException( msg );
	    	     */
	    	    return msg;
	    	}
	    	    
            /* Does the column match the selector? */
            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) &&          (col.isPartitionBy() && (!col.isMapped() || col.isTarget())) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isPartitionBy() || col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isSortBy()) ) || 
                    (pSelector.toUpperCase().equals( "" )) 
//            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isUd2() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isUd1() || col.isUd2() || col.isPartitionBy() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isUd3() || col.isSortBy()) ) || 
//                    (pSelector.toUpperCase().equals( "" )) 
        	) {
        		String s = pPattern;
        		/* Replace all patterns with their respective values */
        		s = s.replace( PATTERN_COL_NAME, col.getColName() );
        		s = s.replace( PATTERN_DEST_CRE_DT, col.getDataType() );
                s = s.replace( PATTERN_EXPRESSION, col.getExpression() );
                /* Handle EXPRESSION__NULL_IF_UNMAPPED_REGEX */
        		if (col.getExpression().equals(EXPRESSION_NOT_SUPPORTED)) {
        		    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, "cast(null as "+col.getDataType()+")" );
        		    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
        		} else {
                    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, col.getExpression() );        		    
        		}
                /* Handle MAPPED_ON_TARGET */
                s = s.replace( PATTERN_MAPPED_ON_TARGET, (col.isTarget())?"1":"0" );
                
                /* Handle UNMAPPED */
                s = s.replace( PATTERN_UNMAPPED, (!col.isMapped())?"1":"0" );
                
                /* Handle COL_NAME__EXPRESSION_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET, 
                        (col.isTarget())?col.getExpression():
                            ((!col.isMapped())?
                                    "cast(null as "+col.getDataType()+")":
                                    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                                    col.getColName())
                );
        		
                /* Handle COL_NAME__NULL_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__NULL_IF_ON_TARGET, 
                        (col.isTarget() || !col.isMapped())?
                            "cast(null as "+col.getDataType()+")" :
                            /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                            col.getColName()
                );
                
                /* Add separator for second and later columns */
        		if ( rv.length() > 0 )
        		  rv.append(pSeparator);
        		rv.append( s );

        	}
        }
		/* if any columns selected, insert/append pStart/pEnd */ 
		if (rv.length() > 0) {
			rv.insert(0, pStart);
			rv.append( pEnd );
		};
		/* return buffer after unescaping control characters */
		return rv.toString()
			.replaceAll( ""+(char)92+"Q"+(char)92+"n"+(char)92+"E", ""+(char)10 )
			.replaceAll( ""+(char)92+"Q"+(char)92+"t"+(char)92+"E", ""+(char)9 );
	}
    
    public String getBuckets(
            String pBefore,
            String pAfter) {
        /* Does this target have any cluster by columns ? */
        boolean isTargetClustered = (getAllTargetColList("","X","","",SELECTOR_CLUSTER).length()>0);
        return isTargetClustered ? (pBefore + buckets + pAfter) : "";
    }
    
    public static List getScriptInfo( String getFrom ) {
        String s = getFrom;
        List lst = new ArrayList();
        while ( s.indexOf( MARKER_SCRIPTNAME ) > -1 ) {
            int beginName     = s.indexOf( MARKER_SCRIPTNAME );
            int endName       = s.indexOf( MARKER_SCRIPTFULLNAME);
            int beginFullName = endName + MARKER_SCRIPTFULLNAME.length();
            int endFullName   = s.indexOf( MARKER_SCRIPT );
            int beginScript   = endFullName + MARKER_SCRIPT.length();
            int endScript     = s.indexOf( MARKER_SCRIPTEND );
            lst.add( new String[] {s.substring(beginName + MARKER_SCRIPTNAME.length(), endName), 
                                   s.substring(beginFullName, endFullName), 
                                   s.substring(beginScript, endScript)} );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return lst;
    }
    
    public static String removeScriptInfo( String getFrom ) {
        String s = getFrom;
        while ( s.indexOf( MARKER_SCRIPT ) > -1 ) {
            int beginName = s.indexOf( MARKER_SCRIPTNAME );
            int endScript = s.indexOf( MARKER_SCRIPTEND );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return s;
    }
        
	/**
	 * Some test stub
	 */
	public static void main(String[] args) {
	    
		/* getColList: Test for a permanent interface */
		IkmHiveApi inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"", 
				"", 
				"", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "",
                "4"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
		System.out.println();
		System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println("------------------------------"); 

		/* getColList: Test for a temporary interface */
		inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"sales_pers_id", 
				"sales_pers_id", 
				"sales_last_name", 
				"Exception getColList(...)", 
				"Exception getColList(...)", 
				"Exception getColList(...)",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "Exception getColList(...)", 
                "Exception getColList(...)", 
                "Exception getColList(...)",
                "4",
                "Exception getInfo(...)"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println("------------------------------"); 
        
        /* my test case */
        inst = new IkmHiveApi();
        inst.initMetadata(
                false,
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CUSTID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.LAST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.FIRST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.AGE$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CITY_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.SALES_PERS_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.DEAR$$SUNOPSIS$$1$$SUNOPSIS$$CUS.ADDRESS$$SUNOPSIS$$1$$SUNOPSIS$$CUS.PHONE",
                "",
                "",
                "dear",
                "",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "",
                "4"
                );
        System.out.println( inst.getColList("partition by (", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", ")", "PARTITION") );
        System.out.println( inst.getAllTargetColList("partition or cluster by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "PARTITION OR CLUSTER") );
        System.out.println( inst.getAllTargetColList("not partition by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "NOT PARTITION") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println( inst.getAllTargetColList("sort by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "SORT") );
        System.out.println("------------------------------"); 

        String getFrom = "select c1, c2, c3 from ( select c4, c5, c6 from (T1" + MARKER_SCRIPTNAME + "trafo1.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo1.pl" + MARKER_SCRIPT + "my script 1" + MARKER_SCRIPTEND + ") ODI_FROM, T2" +
                         MARKER_SCRIPTNAME + "trafo2.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo2.pl" + MARKER_SCRIPT + "my script 2" + MARKER_SCRIPTEND + ")";
        Iterator iter = getScriptInfo(getFrom).iterator();
        /* List scripts */
        while (iter.hasNext()) {
            String[] script = (String[])iter.next();
            System.out.println( script[0] + " : " + script[1] + " : " + script[2] ); 
        }
        System.out.println("------------------------------"); 
        System.out.println( removeScriptInfo(getFrom) ); 
        System.out.println("------------------------------"); 

	}

}

/* End of IkmHiveApi.java */

};

%>
<% /* -------- End of block ----- Keep this block in sync across all Hive KMs ----------- */ %>


<%
/* Pass metadata into KM specific code generation */
ckmRef = new IkmHiveApi();

String sColList_HIVE_PARTITION_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sColList_HIVE_CLUSTER_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sColList_HIVE_SORT_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetTable_HIVE_BUCKETS = IkmHiveApi.MISSING_FLEXFIELD_GETINFO;

try { 
  sColList_HIVE_PARTITION_COLUMN = odiRef.getColList("", "[HIVE_PARTITION_COLUMN]", ""+(char)1, "", ""); 
  sColList_HIVE_CLUSTER_COLUMN = odiRef.getColList("", "[HIVE_CLUSTER_COLUMN]", ""+(char)1, "", ""); 
  sColList_HIVE_SORT_COLUMN = odiRef.getColList("", "[HIVE_SORT_COLUMN]", ""+(char)1, "", "");  
  sTargetTable_HIVE_BUCKETS = odiRef.getTable("HIVE_BUCKETS"); 
} catch (Exception e) {}

out.print (ckmRef.initMetadata( 
	false,
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, ""), 
	odiRef.getColList("", "[DEST_CRE_DT]", ""+(char)1, ""), 
	odiRef.getColList("", "[EXPRESSION]", ""+(char)1, ""), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "TRG"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD1"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD2"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD3"), 
	sColList_HIVE_PARTITION_COLUMN, 
	sColList_HIVE_CLUSTER_COLUMN, 
	sColList_HIVE_SORT_COLUMN,
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", ""), 
	odiRef.getColList("", "[DEST_CRE_DT]", ""+(char)1, "", ""), 
	sColList_HIVE_PARTITION_COLUMN, 
	sColList_HIVE_CLUSTER_COLUMN, 
	sColList_HIVE_SORT_COLUMN,
	"",
	sTargetTable_HIVE_BUCKETS
));
%>

hive = new flexUtilHive( odiRef.getJDBCConnection("DEST") )

<% selectErrors = ""; %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[518]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3b3ea5ad-c7de-4bdd-859a-f58fa012fd29]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[284]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[381]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete errors from controlled table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[aeec37ad-6d59-47e9-af67-2669012d261e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[518]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (odiRef.getInfo( "CT_ERR_TYPE" ).equals("S")) { %>

// Create temp checked table
hive.executeQuery( '''create table <%=odiRef.getTable("L", "CT_NAME", "A")%>_tmp like <%=odiRef.getTable("L", "CT_NAME", "A")%>''' )

hive.executeQuery( '''
insert overwrite table	 <%=odiRef.getTable("L", "CT_NAME", "A")%>_tmp <%=ckmRef.getAllTargetColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>

select	<%= /* first all non-partition columns */ ckmRef.getAllTargetColList( "", "CT.[COL_NAME]", ",\n\t", "", "NOT PARTITION")%>
	<%= /* then all partition columns */ ckmRef.getAllTargetColList( ",", "CT.[COL_NAME]", ",\n\t", "", "PARTITION")%>
from (
	-- Select checked table data with coalesced key
	select	<%= /* first all non-partition columns */ ckmRef.getAllTargetColList( "", "CT_INNER.[COL_NAME]", ",\n\t\t", "", "NOT PARTITION")%>
		<%if (odiRef.getInfo("CT_ERR_TYPE").equals("F")) {%>
		<%=odiRef.getColList(",","coalesce( cast( CT_INNER.[COL_NAME] as string ), '<<<NULL>>>' ) \tas coalesced_[COL_NAME]", ",\n\t\t", "", "UK")%>  
		<%}else{%>  
		<%=odiRef.getColList(",","coalesce( cast( CT_INNER.[COL_NAME] as string ), '<<<NULL>>>' ) \tas coalesced_[COL_NAME]", ",\n\t\t", "", "PK")%>  
		<%}%>  	
		<%= /* then all partition columns */ ckmRef.getAllTargetColList( ",", "CT_INNER.[COL_NAME]", ",\n\t\t", "", "PARTITION")%>
	from <%=snpRef.getTable("L", "CT_NAME", "A")%> CT_INNER
	) CT
left outer join (
	-- Create a list of unique, coalesced PKs/UKs, which are in the error table
	select distinct 
	<%if (odiRef.getInfo("CT_ERR_TYPE").equals("F")) {%>
	<%=odiRef.getColList("","coalesce( cast( E_INNER.[COL_NAME] as string ), '<<<NULL>>>' ) \tas coalesced_[COL_NAME]", ",\n\t\t", "", "UK")%>  
	<%}else{%>  
	<%=odiRef.getColList("","coalesce( cast( E_INNER.[COL_NAME] as string ), '<<<NULL>>>' ) \tas coalesced_[COL_NAME]", ",\n\t\t", "", "PK")%>  
	<%}%>  
	from <%=odiRef.getTable("L","ERR_NAME", "W")%> E_INNER
	where
		ODI_ERR_TYPE	= '<%=snpRef.getInfo("CT_ERR_TYPE")%>'  and
		ODI_ORIGIN	= '<%=snpRef.getInfo("CT_ORIGIN")%>'  and
		<% if (isODI12cOrLater) 
		{%>ODI_SESS_NO = '<%=snpRef.getSession("SESS_GUID")%>'<% } else 
		{%>ODI_SESS_NO = <%=snpRef.getSession("SESS_NO")%><% } %>
	) E
on (
	<%if (odiRef.getInfo("CT_ERR_TYPE").equals("F")) {%>
	<%=odiRef.getColList("","(E.coalesced_[COL_NAME] = CT.coalesced_[COL_NAME])", " and\n\t\t", "", "UK")%>  
	<%}else{%>  
	<%=odiRef.getColList("","(E.coalesced_[COL_NAME] = CT.coalesced_[COL_NAME])", " and\n\t\t", "", "PK")%>  
	<%}%>  
)
where 
	-- Only copy those rows, which are not in the error table
	<%if (odiRef.getInfo("CT_ERR_TYPE").equals("F")) {%>
	<%=odiRef.getColList("","E.coalesced_[COL_NAME] is null", "and\n\t\t", "", "UK")%>  
	<%}else{%>  
	<%=odiRef.getColList("","E.coalesced_[COL_NAME] is null", "and\n\t\t", "", "PK")%>  
	<%}%>  

<%= /* add distribute expression to avoid unbalanced dynamic partition creation and resulting failures */ 
	ckmRef.getAllTargetColList( "distribute by\t", "[COL_NAME]", ",", "", "PARTITION")%>
''')


// Drop old checked table
hive.executeQuery( '''drop table <%=odiRef.getTable("L", "CT_NAME", "A")%>''')


<$ unqualifiedTableName = "<%=odiRef.getTable("L", "CT_NAME", "A")%>".replaceAll( "(?i)"+(char)92+"Qdefault."+(char)92+"E", "" ); $>
// Rename temp checked table to new checked table
hive.executeQuery( '''alter table <$=unqualifiedTableName$>_tmp rename to <$=unqualifiedTableName$>''' )
<% /* Omitting the schema names to work-around  HIVE-2496. The correct code should be
hive.executeQuery( '''alter table < %=odiRef.getTable("L", "CT_NAME", "A")% >_tmp rename to < %=odiRef.getTable("L", "CT_NAME", "A")% >''' ) 
*/ %>


<% } else { %>
// In FlowControl erroneous records are removed during step "Insert new rows"
<% }; %>

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[519]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[912be322-a4c7-4b31-a31d-d957b3e56b6e]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[285]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[241]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop error table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[53fc44db-93e5-49dc-ab4a-5d88d919816b]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[519]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[hive.executeQuery( '''

drop table if exists <%=odiRef.getTable("L","ERR_NAME", "W")%>

''' )

hive.executeQuery( '''

drop table if exists <%=odiRef.getTable("L","ERR_NAME", "W")%>_tmp

''' )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[520]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[807d6e03-8600-4c35-9075-9e83e9d04f07]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[286]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[271]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create error table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8ae2f68c-1171-4fe4-8b7c-d4ceadb56e05]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[520]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[hive.executeQuery( '''

create table if not exists <%=odiRef.getTable("L","ERR_NAME", "W")%>
(
	ODI_ERR_TYPE		<%=odiRef.getDataType("DEST_VARCHAR", "1", "")%>, 
	ODI_ERR_MESS		<%=odiRef.getDataType("DEST_VARCHAR", "250", "")%>,
	ODI_CHECK_DATE	<%=odiRef.getDataType("DEST_DATE", "", "")%>, 
	<%=ckmRef.getAllTargetColList("", "[COL_NAME]\t[DEST_CRE_DT] ", ",\n\t", "", "NOT PARTITION")%>,
	ODI_ORIGIN		<%=odiRef.getDataType("DEST_VARCHAR", "100", "")%>,
	ODI_CONS_NAME	<%=odiRef.getDataType("DEST_VARCHAR", "35", "")%>,
	ODI_CONS_TYPE		<%=odiRef.getDataType("DEST_VARCHAR", "2", "")%>,
	<% if (isODI12cOrLater) 
	{%>ODI_SESS_NO		<%=odiRef.getDataType("DEST_VARCHAR", "26", "")%><% } else 
	{%>ODI_SESS_NO		<%=odiRef.getDataType("DEST_NUMERIC", "19", "")%><% } %>
)
<%
%><%=ckmRef.getAllTargetColList("partitioned by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", ")\n", "PARTITION")
%><%=ckmRef.getAllTargetColList("clustered by (", "[COL_NAME]", ", ", ")\n", "CLUSTER")
%><%=ckmRef.getAllTargetColList("sorted by (", "[COL_NAME]", ", ", ")\n", "SORT")
%><%=ckmRef.getBuckets("into ", " buckets\n")%>

''' )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[521]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[919355ec-6999-4ce2-af42-1e16ba6fc6f0]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[E]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[287]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert PK errors]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d226802c-bd08-40c6-ae7c-3eceab5c5167]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[521]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% startCapture(); %>

<% if ( selectErrors.length() > 0 ) { %>	union all<%};%>

	-- Check for PK violations
	select	<% if (isODI12cOrLater) 
		{%>cast( '<%=odiRef.getSession("SESS_GUID")%>' as <%=odiRef.getDataType("DEST_VARCHAR", "36", "")%> )	as ODI_SESS_NO, <% } else 
		{%>cast( <%=odiRef.getSession("SESS_NO")%> as <%=odiRef.getDataType("DEST_NUMERIC", "19", "")%> )	as ODI_SESS_NO, <% } %>
		'<%=odiRef.getInfo("CT_ERR_TYPE")%>'	as ODI_ERR_TYPE, 
		'<%=odiRef.getPK("MESS")%>'	as ODI_ERR_MESS,
		'<%=odiRef.getInfo("CT_ORIGIN")%>'	as ODI_ORIGIN,
		<%=odiRef.getInfo("DEST_DATE_FCT")%>	as ODI_CHECK_DATE,
		'<%=odiRef.getPK("KEY_NAME")%>'	as ODI_CONS_NAME,
		'PK'	as ODI_CONS_TYPE,	
		<%=odiRef.getColList("", odiRef.getTargetTable("TABLE_ALIAS")+".[COL_NAME]", ",\n\t\t", "", "MAP")%>
	from	<%=odiRef.getTable("L", "CT_NAME", "A")%>   <%=odiRef.getTargetTable("TABLE_ALIAS")%>
	join (
		select	<%=odiRef.getColList("", "SUB.[COL_NAME]", ",\n\t\t", "", "PK")%>
		from	<%=odiRef.getTable("L","CT_NAME","A")%> SUB
		group by 	<%=odiRef.getColList("", "SUB.[COL_NAME]", ",\n\t\t", "", "PK")%>
		having 	count(1) > 1
	) DUP
	on	(<%=odiRef.getColList("", "DUP.[COL_NAME]="+odiRef.getTargetTable("TABLE_ALIAS")+".[COL_NAME]", "\n\t\t\tand ", "", "PK")%>)
	<%=odiRef.getFilter()%>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[522]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2e45ede0-a0f5-4fe1-aca3-4551d1a71d2f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[E]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[288]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[321]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert AK errors]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[20798d8e-586b-453f-b7f7-4df4008acdb2]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[522]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% startCapture(); %>

<% if ( selectErrors.length() > 0 ) { %>	union all<%};%>

	-- Check for AK violations
	select	<% if (isODI12cOrLater) 
		{%>cast( '<%=odiRef.getSession("SESS_GUID")%>' as <%=odiRef.getDataType("DEST_VARCHAR", "36", "")%> )	as ODI_SESS_NO, <% } else 
		{%>cast( <%=odiRef.getSession("SESS_NO")%> as <%=odiRef.getDataType("DEST_NUMERIC", "19", "")%> )	as ODI_SESS_NO, <% } %>
		'<%=odiRef.getInfo("CT_ERR_TYPE")%>'	as ODI_ERR_TYPE, 
		'<%=odiRef.getAK("MESS")%>'	as ODI_ERR_MESS,
		'<%=odiRef.getInfo("CT_ORIGIN")%>'	as ODI_ORIGIN,
		<%=odiRef.getInfo("DEST_DATE_FCT")%>	as ODI_CHECK_DATE,
		'<%=odiRef.getPK("KEY_NAME")%>'	as ODI_CONS_NAME,
		'AK'	as ODI_CONS_TYPE,	
		<%=odiRef.getColList("", odiRef.getTargetTable("TABLE_ALIAS")+".[COL_NAME]", ",\n\t\t", "", "MAP")%>
	from	<%=odiRef.getTable("L", "CT_NAME", "A")%>   <%=odiRef.getTargetTable("TABLE_ALIAS")%>
	join (
		select	<%=odiRef.getAKColList("", "SUB.[COL_NAME]", ",\n\t\t", "")%>
		from	<%=odiRef.getTable("L","CT_NAME","A")%> SUB
		group by 	<%=odiRef.getAKColList("", "SUB.[COL_NAME]", ",\n\t\t", "")%>
		having 	count(1) > 1
	) DUP
	on	(<%=odiRef.getAKColList("", "DUP.[COL_NAME]="+odiRef.getTargetTable("TABLE_ALIAS")+".[COL_NAME]", "\n\t\t\tand ", "")%>)
	<%=odiRef.getFilter()%>

<% captured = endCapture(); 

// Append captured SQL fragment
selectErrors += captured;

%>
/* SQL captured:

<%=captured%>

*/]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[523]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[447ecacd-4af0-4428-af28-6c7137f47141]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[E]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[289]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[331]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert FK errors]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[46be3557-f517-478a-8bf3-c5d95a474898]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[523]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% startCapture(); %>

<% if ( selectErrors.length() > 0 ) { %>	union all<%};%>

	-- Check for FK violations
	select	<% if (isODI12cOrLater) 
		{%>cast( '<%=odiRef.getSession("SESS_GUID")%>' as <%=odiRef.getDataType("DEST_VARCHAR", "36", "")%> )	as ODI_SESS_NO, <% } else 
		{%>cast( <%=odiRef.getSession("SESS_NO")%> as <%=odiRef.getDataType("DEST_NUMERIC", "19", "")%> )	as ODI_SESS_NO, <% } %>
		'<%=odiRef.getInfo("CT_ERR_TYPE")%>'	as ODI_ERR_TYPE, 
		'<%=odiRef.getFK("MESS")%>'	as ODI_ERR_MESS,
		'<%=odiRef.getInfo("CT_ORIGIN")%>'	as ODI_ORIGIN,
		<%=odiRef.getInfo("DEST_DATE_FCT")%>	as ODI_CHECK_DATE,
		'<%=odiRef.getFK("FK_NAME")%>'	as ODI_CONS_NAME,
		'FK' as ODI_CONS_TYPE,	
		<%=odiRef.getColList("", odiRef.getTargetTable("TABLE_ALIAS")+".[COL_NAME]", ",\n\t\t", "", "MAP")%>
	<%if (odiRef.getFK("COMPLEX_SQL").equals("")) {%> 
	from	<%=odiRef.getTable("L", "CT_NAME", "A")%> <%=odiRef.getTargetTable("TABLE_ALIAS")%> 
	left outer join <%=odiRef.getTable("L", "FK_PK_TABLE_NAME", "A")%> <%=odiRef.getFK("PK_ALIAS")%>
	on	(<%=odiRef.getFKColList("", odiRef.getTargetTable("TABLE_ALIAS")+".[COL_NAME]="+odiRef.getFK("PK_ALIAS")+".[COL_NAME]", "\n\t\t\tand ", "")%>)
	where	(<%=odiRef.getFKColList("", odiRef.getFK("PK_ALIAS")+".[COL_NAME] is null", "\n\t\t\tand ", "")%>)
	and	(<%=odiRef.getFKColList("", odiRef.getTargetTable("TABLE_ALIAS")+".[COL_NAME] is not null", "\n\t\t\tand ", "")%>)
	<%=odiRef.getFilter()%>
	<%}else{%>

	Complex SQL Conditions not supported!

	<%}%>

<% captured = endCapture(); 

// Append captured SQL fragment
selectErrors += captured;

%>
/* SQL captured:

<%=captured%>

*/]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[524]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0c34fb7c-86eb-4f1f-98af-1b336da95030]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[E]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[290]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[341]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert CK errors]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7e7e5b1f-5b55-4299-864b-4de4499f0938]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[524]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% startCapture(); %>

<% if ( selectErrors.length() > 0 ) { %>	union all<%};%>

	-- Check for condition violations
	select	<% if (isODI12cOrLater) 
		{%>cast( '<%=odiRef.getSession("SESS_GUID")%>' as <%=odiRef.getDataType("DEST_VARCHAR", "36", "")%> )	as ODI_SESS_NO, <% } else 
		{%>cast( <%=odiRef.getSession("SESS_NO")%> as <%=odiRef.getDataType("DEST_NUMERIC", "19", "")%> )	as ODI_SESS_NO, <% } %>
		'<%=odiRef.getInfo("CT_ERR_TYPE")%>'	as ODI_ERR_TYPE, 
		'<%=odiRef.getCK("MESS")%>'	as ODI_ERR_MESS,
		'<%=odiRef.getInfo("CT_ORIGIN")%>'	as ODI_ORIGIN,
		<%=odiRef.getInfo("DEST_DATE_FCT")%>	as ODI_CHECK_DATE,
		'<%=odiRef.getCK("COND_NAME")%>'	as ODI_CONS_NAME,
		'CK' 	as ODI_CONS_TYPE,	
		<%=odiRef.getColList("", "[COL_NAME]", ",\n\t\t", "", "MAP")%>
	from	<%=odiRef.getTable("L", "CT_NAME", "A")%>  <%=odiRef.getCK("COND_ALIAS")%>
	where	not 	(
			<%=odiRef.getCK("COND_SQL")%>
			)
	<%=odiRef.getFilter()%>

<% captured = endCapture(); 

// Append captured SQL fragment
selectErrors += captured;

%>
/* SQL captured:

<%=captured%>
*/]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[525]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[83317b5e-d952-4dcc-be1e-2fab208208e7]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[E]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[291]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[351]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert Not Null errors]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[00f01d3e-76af-436d-a9e3-519241e5edfb]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[525]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% startCapture(); %>

<% if ( selectErrors.length() > 0 ) { %>	union all<%};%>

	select	<% if (isODI12cOrLater) 
		{%>cast( '<%=odiRef.getSession("SESS_GUID")%>' as <%=odiRef.getDataType("DEST_VARCHAR", "36", "")%> )	as ODI_SESS_NO, <% } else 
		{%>cast( <%=odiRef.getSession("SESS_NO")%> as <%=odiRef.getDataType("DEST_NUMERIC", "19", "")%> )	as ODI_SESS_NO, <% } %>
		'<%=odiRef.getInfo("CT_ERR_TYPE")%>'	as ODI_ERR_TYPE, 
		'<%=odiRef.getNotNullCol("MESS")%>'	as ODI_ERR_MESS,
		'<%=odiRef.getInfo("CT_ORIGIN")%>'	as ODI_ORIGIN,
		<%=odiRef.getInfo("DEST_DATE_FCT")%>	as ODI_CHECK_DATE,
		'<%=odiRef.getNotNullCol("COL_NAME")%>'	as ODI_CONS_NAME,
		'NN'	as ODI_CONS_TYPE,	
		<%=odiRef.getColList("", "[COL_NAME]", ",\n\t\t", "", "MAP")%>
	from	<%=odiRef.getTable("L", "CT_NAME", "A")%> <%=odiRef.getTargetTable("TABLE_ALIAS")%>
	where	<%=odiRef.getNotNullCol("COL_NAME")%> is null
	<%=odiRef.getFilter()%>

<% captured = endCapture(); 

// Append captured SQL fragment
selectErrors += captured;

%>
/* SQL captured:

<%=captured%>

*/]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b2942406-98a4-4aa5-b5a3-5513c4754fba]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[282]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[6328b511-b9cf-4883-9a47-514c6a11d073]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[283]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[1d2dbe87-2691-40a5-8029-cb79c6421c67]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[284]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[399b70d7-aebb-4547-9dae-302a880de05c]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[285]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3dc70464-0475-4657-8884-2bb36b0405f1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[286]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[216f16fd-78c4-4ee4-a405-f8c2c9e1b425]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[287]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ed7cd1ec-acf5-47ef-bd07-7ff8012c9c5d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[288]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ee42274a-e4ae-4205-bbb7-93d0cee1865b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[289]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[45cd6bd9-f565-42e0-a9d7-56d4cda57c79]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[290]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[fe02131c-0e2f-4640-9af7-899fac707928]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[291]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5846]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[146]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="BaseKmType" type="java.lang.String">null</Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GenType" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8cfd885b-8db3-4b2c-bfe9-0a46ae86b980]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="IsConcurrent" type="java.lang.String">null</Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[526]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmSrcTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="KmTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="KmVersion" type="java.lang.String"><![CDATA[13]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:23.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[-175200750]]></Field>
	<Field name="LCode" type="java.lang.String"><![CDATA[TeradataConnectivity]]></Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[IKM File to Hive (LOAD DATA)]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[KI]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp"><![CDATA[2009-07-07 16:41:29.0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5411b001-9f1d-4b1a-ba26-b9f429dd0efc]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[526]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[COMPONENT NAME: IKM File to Hive (LOAD DATA)
AUTHOR: Oracle

DESCRIPTION
	Integration from a flat file staging area to Hive using Hive's LOAD DATA command.
	This KM executes the following steps:
		1. Create a flow table in Hive
		2. Declare data files to Hive (LOAD DATA command)
		3. Load data from Hive staging table into target table
	Additional information can be found on KM option descriptions.
	The KM can handle filename wildcards (*, ?).

REQUIREMENTS
	- Source files must be accessible from all Hadoop cluster nodes, Hive server and ODI agent.
	- CDH3: hadoop-xxx-core.jar, hadoop-xxx-tools.jar must be on ODI class path and use same version as Hadoop cluster
	- CDH4: $HADOOP_HOME/client/* must be on ODI class path and use same version as Hadoop cluster
	- hadoop configuration directory must be on ODI class path (containing e.g. core-default.xml, core-site.xml, hdfs-site.xml)
	- UNIX environment variable ODI_HIVE_SESSION_JARS must contain hive-contrib.jar, if RegExSerDe used anywhere; 
	  e.g. when loading fixed length files

BASIC CONFIGURATION
	- Add the source file into the interface's source area
	- Add the hive target table into the interface's target area
	- Add mappings
	- Set the interface's staging area to the logical schema of the
	  source file in the definition tab of the interface

OPTIONS (Refer to Option descriptions for more information on each option)
	- CREATE_TARG_TABLE: Create target table?
	- TRUNCATE: Truncate data in target table?
	- FILE_IS_LOCAL: Is the file in the local file system? (or in HDFS?)
	- EXTERNAL_TABLE: Use an externally manager Hive table?
	- USE_STAGING_TABLE: Use a Hive staging table?
	- DELETE_TEMPORARY_OBJECTS: Remove temporary objects after execution?
	- DEFER_TARGET_LOAD: Load data into final target now? or defer?
	- OVERRIDE_ROW_FORMAT: For handling custom file formats
	- STOP_ON_FILE_NOT_FOUND: Stop, if no source file was found?

LIMITATIONS
	- supported files types:
	  fixed length (there must be neither gaps nor overlaps in the source DataStore),
	  delimited (no field enclosers/string delimiters supported)
	- only absolute path names supported
	- only straight mappings (no expressions) supported
	  Exception: for partitioning target columns constant values are allowed, 
	  if mapping location is set to target.
	- no joins, filters, lookups or set operations allowed
	- if a partitioning column is unmapped or mapped to a constant value, its name 
	  must not match (case-insensitive) any source column name
	- for external tables: 
	   all files in the directory will be "loaded". If table is partitioned, hive 
	   file/directory structure must be observed. 
	   Deferred loading not possible. The ODI file schema must point to an HDFS location. 
	   Local files are not supported for external tables.
	- only UNIX platforms supported
	- Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2537701a-3939-4acf-88e2-667d317c842b]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[527]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[CREATE_TARG_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Create the target table.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[49ca068c-d688-4e03-8f1d-3b5c9be8f2eb]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[527]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Check this option, if you wish to create the target table. - Default: false
In case of USE_STAGING_TABLE = false, please note that data will only be read correctly, if the target table definition, particularly the row format and file format details, are correct.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9066a453-b9fe-4387-ac03-3989e9fa152d]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[528]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[149]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[190]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[TRUNCATE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Truncate target table]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[316468da-eb19-4e1a-b9ed-7350f60db06d]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[528]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Set this option to true, if you wish to replace the target table/partition content with the new data. Otherwise the new data will be appended to the target table. - Default: true - Permitted values: true or false

If TRUNCATE=false and USE_STAGING_TABLE=false, all source file names must be unique and must not collide with any data files already loaded into the target table.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c1ae5988-8231-4428-891a-d7cce06b0b4d]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[529]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[210]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[FILE_IS_LOCAL]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Is this a local file?]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2fb36052-efe7-40c3-9ef9-5cfe31e70c7e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[529]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Defines whether the source file is to be considered local (= outside of the current Hadoop cluster) - Default: true

If FILE_IS_LOCAL is set to true, the data file(s) are copied into the Hadoop cluster first.

If FILE_IS_LOCAL is set to false, the data file(s) are moved into the Hadoop cluster and therefore will no longer be available at their source location. If the source file is already in HDFS, FILE_IS_LOCAL=false results in just a file rename and therefore very fast operation.
This option only applies, if EXTERNAL_TABLE is set to false.
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fe940497-0174-4b4f-9ef4-f1594c9af541]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[530]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[151]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[220]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[EXTERNAL_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Preserve file in original location?]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ddd77262-a645-46e3-8218-33b292a95b95]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[530]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Defines whether to declare the target/staging table as externally managed. - Default: false

For non-external tables Hive manages all data files. That is, it will *move* any data files into <hive.metastore.warehouse.dir>/<table_name>.
For external tables Hive does not move or delete any files. It will load data from the location given by the ODI schema.

If  EXTERNAL_TABLE is set to true, 
- All files in the directory given by the physical data schema will be loaded. So any filename or wildcard information from the source DataStore?s resource name will be ignored.
- The directory structure and file names must comply with Hives directory organization for tables,e.g. for partitioning and clustering.
- The directory and its files must reside in HDFS.
- No Hive LOAD-DATA-statements are submitted and thus loading of files to a specific partition (using a target-side expression) is not possible.
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[80e52c00-d932-4902-a5de-aa303ad6d473]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[531]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[152]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[230]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[USE_STAGING_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Create a staging table?]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[406868b6-db58-4de6-9ef9-fcabcf011968]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[531]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This option defines whether an intermediate staging table will be created. - Default: true

A Hive staging table is required
- if target table is partitioned, but data spreads across partitions
- if target table is clustered
- if target table (partition) is sorted, but input file is not
- if target table is already defined and target table definition does not match the definition required by the KM
- if target column order does not match source file column order
- if there are any unmapped source columns
- if there are any unmapped non-partition target columns
- if the source is a fixed length file and the target has non-string columns

In case none of the above being true, this option can be turned off for better performance.
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0512e867-cbf8-4843-8a23-9184a71fe67d]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[532]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[153]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[290]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DELETE_TEMPORARY_OBJECTS]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Delete temp objects]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3b03177c-753e-4dc5-9100-33a6be7432d6]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[532]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Set this option to NO, if you wish to retain temporary objects (tables, files and scripts) after integration.
Useful for debugging. - Default: true
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9cd62f6d-dbb9-4eea-b853-7b4212d1ec75]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[533]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[154]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[350]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DEFER_TARGET_LOAD]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Defer data loading]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5be10207-95bb-46dc-b031-09d30b505f64]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[533]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This value option only applies if USE_STAGE_TABLE is set to true. It defines whether the file(s), which have been declared to the staging table should be loaded into the target table now or during a later execution.  - Permitted values: START, NEXT, END or <empty> - Default: <empty>

The typical use case for this option is when there are multiple files and each of them requires data redistribution/sorting and the files are gathered by calling the interface several times.
E.g. the interface is used in a package, which retrieves (many small) files from different locations and the location, stored in an ODI variable, is to be used in a target partition column. In this case the first interface execution will have DEFER_TARGET_LOAD=START, the next interface executions will have DEFER_TARGET_LOAD=NEXT and  set to END for the last interface.

The interfaces having DEFER_ TARGET _LOAD=START/NEXT will just load the data file into HDFS (but not yet into the target table) and can be executed in parallel to accelerate file upload to cluster .
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[edb6f2fd-4aca-419c-b042-6c00c5fae320]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[534]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[155]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[360]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[OVERRIDE_ROW_FORMAT]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[custom row format clause]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[T]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0d3b344a-900d-4781-a0b7-41ebc4c11e3c]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[534]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This option allows to override the entire Hive row format definition of the staging table (in case USE_STAGE_TABLE is set to true) or the target table (in case USE_STAGE_TABLE is set to false). It contains the text to be used for row format definition.

Example for reading Apache Combined WebLog files:

ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.RegexSerDe'
WITH SERDEPROPERTIES (
  "input.regex" = "([^ ]*) ([^ ]*) ([^ ]*) (-|\\[[^\\]]*\\]) ([^ \"]*|\"[^\"]*\") (-|[0-9]*) (-|[0-9]*) (\".*?\") (\".*?\") (\".*?\")",
  "output.format.string" = "%1$s %2$s %3$s %4$s %5$s %6$s %7$s %8$s %9$s %10$s"
)
STORED AS TEXTFILE

The list of columns in the source DataStore must match the list of input groups in the regular expression (same number of columns and appropriate data types).

If USE_STAGE_TABLE=false, the number of target columns must match the number of columns returned by the SerDe, in the above example: the number of groups in the regular expression. The number of source columns is ignored. (There must be at least one column mapped to the target.). All source data is mapped into the target table structure according to the column order: the SerDe's first column is mapped to the first target column. the SerDe's second column is mapped to the second target column. etc

If USE_STAGE_TABLE=true, the source DataStore must have as many columns as the SerDe returns columns. Only data of mapped columns will be transfered.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[44d22678-11ea-4997-b2b8-68b185db4685]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[535]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[156]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[370]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[STOP_ON_FILE_NOT_FOUND]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Stop, if no input file was found]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f330a194-261c-4faa-80b4-0601b49a1f6b]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[535]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This checkbox option defines whether the KM should stop, if no input file has been found.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[98257a59-e389-4f21-a0c9-c68122066a2d]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[536]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[157]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[371]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0.8]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[HIVE_COMPATIBLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Hive version compatibility]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5fbc76c9-622e-46a6-91d1-5adc383674c9]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[536]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Hive version compatibility.

Permitted values: 0.7 or 0.8
Default: 0.8]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[538]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1de53582-c700-4a69-a9f0-5ab0d789c207]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[293]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[392]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create target table ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8af928d6-6eb9-4686-a8a4-eac10ad3bfa0]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[538]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>
// Execute only, if DEFER_TARGET_LOAD is START
if ('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.equals("START")) {
<%}%>

sql = '''
<% if (odiRef.getOption("USE_STAGING_TABLE").equals("1")) {%>

create table if not exists <%=odiRef.getTable("L","TARG_NAME","A")%>
(
	<%=myRef.getAllTargetColList("", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", "", "NOT PARTITION")%>
)
<%
%><%=myRef.getAllTargetColList("partitioned by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", ")\n", "PARTITION")
%><%=myRef.getAllTargetColList("clustered by (", "[COL_NAME]", ", ", ")\n", "CLUSTER")
%><%=myRef.getAllTargetColList("sorted by (", "[COL_NAME]", ", ", ")\n", "SORT")
%><%=myRef.getBuckets("into ", " buckets\n")%>


<% } else { /* No staging table. We need a table with appropriate storage options. */ %>

create <% if (odiRef.getOption("EXTERNAL_TABLE").equals("1")) out.print("external"); %> table if not exists <%=odiRef.getTargetTable("RES_NAME")%>
(
	<%=myRef.getAllTargetColList("", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", "", "NOT PARTITION")%>
)
<%
%><%=myRef.getAllTargetColList("partitioned by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", ")\n", "PARTITION")
%><%=myRef.getAllTargetColList("clustered by (", "[COL_NAME]", ", ", ")\n", "CLUSTER")
%><%=myRef.getAllTargetColList("sorted by (", "[COL_NAME]", ", ", ")\n", "SORT")
%><%=myRef.getBuckets("into ", " buckets\n")%>

<% if (odiRef.getOption("OVERRIDE_ROW_FORMAT").trim().length() > 0) { 
      /* Custom row format */
%><%=odiRef.getOption("OVERRIDE_ROW_FORMAT").replaceAll(""+(char)92+(char)92, ""+(char)92+(char)92+(char)92+(char)92)%>

<% } else { if (odiRef.getSrcTablesList("", "[FILE_FORMAT]", "", "").equals("D")) { 
      /* Delimited file format */ %>
row format delimited
fields terminated by '<%=odiRef.getSrcTablesList("", "[SFILE_SEP_FIELD]", "", "")%>'
lines terminated by '<%=odiRef.getSrcTablesList("", "[SFILE_SEP_ROW]", "", "")%>'
stored as textfile

<% } else { 
      /* Fixed length file format */ %>
row format serde 'org.apache.hadoop.hive.contrib.serde2.RegexSerDe'
with serdeproperties (
  "input.regex" = "<%=odiRef.getSrcColList("", "(.{[BYTES]})", "(.{[BYTES]})", "", "")%>",
  "output.format.string" = ""
)
stored as textfile

<% }    /* Delimited or fixed length file format */ 

} %><% if (odiRef.getOption("EXTERNAL_TABLE").equals("1")){ %>LOCATION '<%=odiRef.getSrcTablesList("", "[SCHEMA]", "", "")%>'<%}%>
<% } %>
'''

hive.executeQuery( sql )

<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>}<%}%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[537]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7d9c8642-3497-4bc6-a545-84f4c7124fa5]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[292]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Prepare Hive session]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a241ad9f-b61a-4ed0-8183-2182a57234cf]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[537]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% /* -------- Begin of block ----- Keep this block in sync across all Hive KMs ----------- */ %>
<%

/* Begin of BSh code gen extensions */

out2 = null;
buffer = null;

startCapture() {
    out2 = out;
    buffer = new ByteArrayOutputStream();
    out = new PrintWriter( buffer );
}

endCapture() {
    out.flush();
    out.close();
    captured = buffer.toString();
    out = out2;
    return captured;
}

getQuotedMLString( s ) {
// escape tripple single quotes
// escape backslashes
    return 
        "'''" + 
        s.replace(""+(char)92, ""+(char)92+(char)92)
        .replace( "'''", ""+(char)92+"'"+(char)92+"'"+(char)92+"'") +
        "'''";
}

/* End of BSh code gen extensions */

%>


<% /* Begin of Hive Runtime-API */ %>

import java.lang.System
import java.sql.Statement
import java.sql.Connection
import java.sql.SQLException


class flexUtilHive {
    Statement stmt;
    public Connection con;

    flexUtilHive( Connection pCon ) {
        con = pCon
        if (con == null) 
            throw new RuntimeException( "\nFailure to open JDBC connection. Please test DataServer connection." );


        // Set session parameters for dynamic partitions
        stmt = con.createStatement()
        stmt.execute( """set hive.exec.dynamic.partition=true""" )
        stmt.execute( """set hive.exec.dynamic.partition.mode=nonstrict""" )
        stmt.execute( """set hive.enforce.bucketing=true""" )
        stmt.execute( """set hive.optimize.bucketmapjoin=true""" )
        //stmt.execute( """set mapred.job.reuse.jvm.num.tasks=-1""" )
        // Add custom jars to this Hive session
        String sExtraJars = """<?=(System.getenv("ODI_HIVE_SESSION_JARS")!=null)?System.getenv("ODI_HIVE_SESSION_JARS"):""?>"""
        if (sExtraJars != "") {
            def lstExtraJars = sExtraJars.split( ":" )
            for (j in lstExtraJars) {
                stmt.execute( """add jar """ + j )
            }
        }
    }

    // Function for executing Hive SQL statements
    def executeQuery( String sql ) {
        try {
            stmt.executeUpdate( sql )
        } catch (SQLException re) {
            def msg = "Exception encountered while submitting: \n-------------------\n" + sql + "\n-------------------"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

    // Check if a table already exists
    def tableExists( String schema, String table ) {
        try {
            def dbm = con.getMetaData()
            def rs = dbm.getTables(null, schema.toLowerCase(), table.toLowerCase(), null)
            return rs.next()
        } catch (SQLException re) {
            def msg = "Exception encountered while checking existence of table "+schema+"."+table+" !"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

}

<% /* End of hive Runtime-API */ %>


<%

// Is there already an API defined?
if (IkmHiveApi != void) {

    // Verify correct version and error out, if not
    if (IkmHiveApi.getVersion() != 1) 
        out.print( "<? throw new RuntimeException( \u0022\u0022+(char)10+(char)10+(char)10+\u0022You are using Hive KMs from different versions. Please make sure to use all Hive KMs from the same ODI version/patch.\u0022+(char)10+(char)10+(char)10 );?>");

} else {

/* Begin of IkmHiveApi.java */

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;

import com.sun.org.apache.xpath.internal.Expression;


public class IkmHiveApi {
	public static final String DELIMITER = ""+(char)1;
	public static final String RE_Q = ""+(char)92+"Q";
	public static final String RE_E = ""+(char)92+"E";

	       static final String MISSING_FLEXFIELD_GETCOLLIST = "Exception getColList(";
           static final String MISSING_FLEXFIELD_GETINFO = "Exception getInfo(";
           static final String EXPRESSION_NOT_SUPPORTED = "[EXPRESSION] not supported in getAllTargetColList";
	       static final String DELIMITER_REGEX = RE_Q+ DELIMITER +RE_E;
	public static final String SELECTOR_PARTITION =              "PARTITION";
	public static final String SELECTOR_NOT_PARTITION =          "NOT PARTITION";
    public static final String SELECTOR_PARTITION_COND1 =        "PARTITION AND (UNMAPPED OR TARGET)";
    public static final String SELECTOR_CLUSTER =                "CLUSTER";
	public static final String SELECTOR_PARTITION_OR_CLUSTER =   "PARTITION OR CLUSTER";
    public static final String SELECTOR_SORT =                   "SORT";
           static final String PATTERN_COL_NAME = "[COL_NAME]";
           static final String PATTERN_DEST_CRE_DT = "[DEST_CRE_DT]";
           static final String PATTERN_EXPRESSION = "[EXPRESSION]";
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED =      "[EXPRESSION__NULL_IF_UNMAPPED]";
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET = "[COL_NAME__EXPRESSION_IF_ON_TARGET]";
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET =       "[COL_NAME__NULL_IF_ON_TARGET]";
           static final String PATTERN_MAPPED_ON_TARGET =                  "[MAPPED_ON_TARGET]";
           static final String PATTERN_UNMAPPED =                          "[UNMAPPED]";
           /*static final String PATTERN_COL_NAME_REGEX = RE_Q+ PATTERN_COL_NAME +RE_E;
           static final String PATTERN_DEST_CRE_DT_REGEX = RE_Q+ PATTERN_DEST_CRE_DT +RE_E;
           static final String PATTERN_EXPRESSION_REGEX = RE_Q+ PATTERN_EXPRESSION +RE_E;
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED_REGEX = RE_Q+ PATTERN_EXPRESSION__NULL_IF_UNMAPPED +RE_E;
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET +RE_E;
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__NULL_IF_ON_TARGET +RE_E;
           static final String PATTERN_MAPPED_ON_TARGET_REGEX = RE_Q+ PATTERN_MAPPED_ON_TARGET +RE_E;
           */
	       
           static final String MARKER_SCRIPTNAME = "SNP$SCRIPTNAME";
           static final String MARKER_SCRIPTFULLNAME = "SNP$SCRIPTFULLNAME";
           static final String MARKER_SCRIPT = "SNP$SCRIPTTEXT";
           static final String MARKER_SCRIPTEND = "SNP$SCRIPTTEXTEND";
	
	LinkedHashMap 
	    cols,          // contains all columns (getColList)
	    allTargetCols; // contains all columns including the target columns (getAllTargetColList)
	String buckets;    // contains the number of buckets for this target

	private class ColInfo {
		static final String PROP_TRG = "TRG";
		static final String PROP_UD1 = "UD1";
		static final String PROP_UD2 = "UD2";
		static final String PROP_UD3 = "UD3";
		static final String PROP_FF_PART = "PART";
		static final String PROP_FF_CLUST = "CUST";
		static final String PROP_FF_SORT = "SORT";
		
		String colName, colDt, colExpr;
		boolean bTarget, bUd1, bUd2, bUd3, bFlexPartCol, bFlexClustCol, bFlexSortCol = false;
		
		public ColInfo( String pColName, String pColDt, String pColExpr, boolean pIsPartCol, boolean pIsClustCol, boolean pIsSortCol ) {
			colName = pColName;
			colDt   = pColDt;
			colExpr = pColExpr;
			bFlexPartCol = pIsPartCol;
            bFlexClustCol = pIsClustCol;
            bFlexSortCol = pIsSortCol;
		}
		public void set( String pProperty, boolean v )		{ 
			if      ( pProperty == PROP_TRG ) 	bTarget = v;
			else if ( pProperty == PROP_UD1 ) 	bUd1 = v;
			else if ( pProperty == PROP_UD2 ) 	bUd2 = v;
			else if ( pProperty == PROP_UD3 ) 	bUd3 = v;
			else if ( pProperty == PROP_FF_PART )	bFlexPartCol  = v;
			else if ( pProperty == PROP_FF_CLUST )  bFlexClustCol = v;
			else if ( pProperty == PROP_FF_SORT )	bFlexSortCol  = v;
		};
		public String getColName() { return colName; }
		public String getDataType() { return colDt; }
		public String getExpression() { return colExpr; }
		public boolean isTarget() { return bTarget; }
		public boolean isMapped() { return !colExpr.equals(EXPRESSION_NOT_SUPPORTED) && colExpr.trim().length()>0; };
		public boolean isUd1() { return bUd1; }
		public boolean isUd2() { return bUd2; }
		public boolean isUd3() { return bUd3; }
		public boolean isPartitionBy() { return bFlexPartCol; }
        public boolean isClusterBy() { return bFlexClustCol; }
        public boolean isSortBy() { return bFlexSortCol; }
	}

	// Return the version of the code gen API. 
	// Used for testing that all KMs in a session are using the same API version
	public static int getVersion() {
	    return 1;
	}
	
	public String initMetadata(
	        boolean dumpMetadata,
			String pAllCols,
			String pAllDts,
			String pAllExpr,
			String pTrgCols,
			String pUd1Cols,
			String pUd2Cols,
			String pUd3Cols,
			String pAllPartCols,
			String pAllClustCols,
			String pAllSortCols,
            String pAllTrgCols,
            String pAllTrgDts,
            String pAllTrgPartCols,
            String pAllTrgClustCols,
            String pAllTrgSortCols,
            String pKMOptionBuckets,
            String pFFBuckets
			) {	    
	    if (dumpMetadata) {
	        String pre = ""+(char)34;
	        String post = ""+(char)34+","+(char)10;
	        return 
            "/* inst.initMetadata("+(char)10+
            "false,"+(char)10+
            pre+pAllCols+post+
            pre+pAllDts+post+
            pre+pAllExpr+post+
            pre+pTrgCols+post+
            pre+pUd1Cols+post+
            pre+pUd2Cols+post+
            pre+pUd3Cols+post+
            pre+pAllPartCols+post+
            pre+pAllClustCols+post+
            pre+pAllSortCols+post+
            pre+pAllTrgCols+post+
            pre+pAllTrgDts+post+
            pre+pAllTrgPartCols+post+
            pre+pAllTrgClustCols+post+
            pre+pAllTrgSortCols+post+
            pre+pKMOptionBuckets+post+
            pre+pFFBuckets+(char)34+(char)10+
            "); */";
	    };
	    
        /* TODO: Sort cols still needs to be implemented */
		String[] allCols         = pAllCols.split(DELIMITER_REGEX,-1);
		String[] allDts          = pAllDts.split(DELIMITER_REGEX,-1);
		String[] allExpr         = pAllExpr.split(DELIMITER_REGEX,-1);
		String[] allPartCols     = pAllPartCols.split(DELIMITER_REGEX,-1);
		String[] allClustCols    = pAllClustCols.split(DELIMITER_REGEX,-1);
        String[] allSortCols     = pAllSortCols.split(DELIMITER_REGEX,-1);
        String[] allTrgCols      = pAllTrgCols.split(DELIMITER_REGEX,-1);
        String[] allTrgDts       = pAllTrgDts.split(DELIMITER_REGEX,-1);
        String[] allTrgPartCols  = pAllTrgPartCols.split(DELIMITER_REGEX,-1);
        String[] allTrgClustCols = pAllTrgClustCols.split(DELIMITER_REGEX,-1);
        String[] allTrgSortCols  = pAllTrgSortCols.split(DELIMITER_REGEX,-1);
		
		/* Create all column objects */
        cols = new LinkedHashMap();
	    for(int j=0; j<allCols.length; j++){
	        String  colName    = allCols[j];
	        String  colDt      = allDts[j];
	        String  colExpr    = allExpr[j];
        	boolean isPartCol  = false;
            boolean isClustCol = false; 
            boolean isSortCol  = false; 
	        /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
	           and must be ignored. */
	        if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isPartCol  = (allPartCols[j].equals("0"))? false : true;
	        }
	        if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isClustCol = (allClustCols[j].equals("0"))? false : true; 
	        }
            if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                isSortCol = (allSortCols[j].equals("0"))? false : true; 
            }
	        cols.put(colName, new ColInfo( colName, colDt, colExpr, isPartCol, isClustCol, isSortCol ) );
	    };
	    set( cols, ColInfo.PROP_TRG, pTrgCols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD1, pUd1Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD2, pUd2Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD3, pUd3Cols.split(DELIMITER_REGEX) );

	    /* Create allTargetCols list */
        allTargetCols = new LinkedHashMap();
        for(int j=0; j<allTrgCols.length; j++){
            String  colName    = allTrgCols[j];
            // Does this column already exist in cols ?
            ColInfo colObj = (ColInfo) cols.get( colName );
            if ( colObj != null )
                // then lets copy it
                allTargetCols.put( colName, colObj );
            else {
                // otherwise it's a column without any mapping and we need to create a new ColInfo Object for it
                String  colDt      = allTrgDts[j];
                boolean isPartCol  = false;
                boolean isClustCol = false; 
                boolean isSortCol = false; 
                /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
                   and must be ignored. */
                if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isPartCol  = (allTrgPartCols[j].equals("0"))? false : true;
                }
                if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isClustCol = (allTrgClustCols[j].equals("0"))? false : true; 
                }
                if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isSortCol = (allTrgSortCols[j].equals("0"))? false : true; 
                }
                allTargetCols.put(colName, new ColInfo( colName, colDt, EXPRESSION_NOT_SUPPORTED, isPartCol, isClustCol, isSortCol ) );
            };

        };
        
        /* Process buckets information */
        buckets = "";
        if ( pFFBuckets.length() > 0 && !pFFBuckets.startsWith(MISSING_FLEXFIELD_GETINFO) )
            buckets = pFFBuckets;
        if ( pKMOptionBuckets.length() > 0 )
            buckets = pKMOptionBuckets;
        
        return "";
	}
	
	/**
	 * Set property pField (UD1, UD2 etc) for all columns listed in pCols
	 * @param pAllCols
	 * @param pField
	 * @param pCols
	 */
	static void set( HashMap pAllCols, String pProperty, String[] pCols ){
		/* Check, if pCols just contains a single empty string */
		if ( pCols.length == 1 && pCols[0].length() == 0 ) return;
		/* Loop over all columns and set the respective property */
	    for(int j=0; j<pCols.length; j++){
	        String colName = pCols[j];
	    	ColInfo col = (ColInfo) pAllCols.get( colName );
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) throw new RuntimeException( "IKM Hive Control Append: set(): Internal Error: Cannot find column: " + colName );
	    	col.set( pProperty, true );
	    };			
	}
	
    public String getColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( cols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    public String getAllTargetColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( allTargetCols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    static private String getColList(
            LinkedHashMap cols,
			String pStart,
			String pPattern,
			String pSeparator,
			String pEnd,
			String pSelector) {
		StringBuffer rv = new StringBuffer();
		if ( ! (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) ||
						pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) ||
                        pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_SORT ) )) {
		    String msg = "IKM Hive Control Append: getColList(): invalid selector received: " + pSelector;
			/* Not yet supported in ODI 11.1.1.6.0:
			 * throw new RuntimeException( msg ); 
			 */
			return msg;
    }
        Iterator iter = cols.keySet().iterator();       
        while(iter. hasNext()){
        	String colName = (String) iter.next();
        	ColInfo col = (ColInfo) cols.get( colName );
        	
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) {
	    	    String msg = "IKM Hive Control Append: getColList(): Internal Error: Cannot find column: " + colName;
	    	    /* Not yet supported in ODI 11.1.1.6.0:
	    	     * throw new RuntimeException( msg );
	    	     */
	    	    return msg;
	    	}
	    	    
            /* Does the column match the selector? */
            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) &&          (col.isPartitionBy() && (!col.isMapped() || col.isTarget())) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isPartitionBy() || col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isSortBy()) ) || 
                    (pSelector.toUpperCase().equals( "" )) 
//            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isUd2() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isUd1() || col.isUd2() || col.isPartitionBy() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isUd3() || col.isSortBy()) ) || 
//                    (pSelector.toUpperCase().equals( "" )) 
        	) {
        		String s = pPattern;
        		/* Replace all patterns with their respective values */
        		s = s.replace( PATTERN_COL_NAME, col.getColName() );
        		s = s.replace( PATTERN_DEST_CRE_DT, col.getDataType() );
                s = s.replace( PATTERN_EXPRESSION, col.getExpression() );
                /* Handle EXPRESSION__NULL_IF_UNMAPPED_REGEX */
        		if (col.getExpression().equals(EXPRESSION_NOT_SUPPORTED)) {
        		    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, "cast(null as "+col.getDataType()+")" );
        		    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
        		} else {
                    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, col.getExpression() );        		    
        		}
                /* Handle MAPPED_ON_TARGET */
                s = s.replace( PATTERN_MAPPED_ON_TARGET, (col.isTarget())?"1":"0" );
                
                /* Handle UNMAPPED */
                s = s.replace( PATTERN_UNMAPPED, (!col.isMapped())?"1":"0" );
                
                /* Handle COL_NAME__EXPRESSION_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET, 
                        (col.isTarget())?col.getExpression():
                            ((!col.isMapped())?
                                    "cast(null as "+col.getDataType()+")":
                                    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                                    col.getColName())
                );
        		
                /* Handle COL_NAME__NULL_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__NULL_IF_ON_TARGET, 
                        (col.isTarget() || !col.isMapped())?
                            "cast(null as "+col.getDataType()+")" :
                            /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                            col.getColName()
                );
                
                /* Add separator for second and later columns */
        		if ( rv.length() > 0 )
        		  rv.append(pSeparator);
        		rv.append( s );

        	}
        }
		/* if any columns selected, insert/append pStart/pEnd */ 
		if (rv.length() > 0) {
			rv.insert(0, pStart);
			rv.append( pEnd );
		};
		/* return buffer after unescaping control characters */
		return rv.toString()
			.replaceAll( ""+(char)92+"Q"+(char)92+"n"+(char)92+"E", ""+(char)10 )
			.replaceAll( ""+(char)92+"Q"+(char)92+"t"+(char)92+"E", ""+(char)9 );
	}
    
    public String getBuckets(
            String pBefore,
            String pAfter) {
        /* Does this target have any cluster by columns ? */
        boolean isTargetClustered = (getAllTargetColList("","X","","",SELECTOR_CLUSTER).length()>0);
        return isTargetClustered ? (pBefore + buckets + pAfter) : "";
    }
    
    public static List getScriptInfo( String getFrom ) {
        String s = getFrom;
        List lst = new ArrayList();
        while ( s.indexOf( MARKER_SCRIPTNAME ) > -1 ) {
            int beginName     = s.indexOf( MARKER_SCRIPTNAME );
            int endName       = s.indexOf( MARKER_SCRIPTFULLNAME);
            int beginFullName = endName + MARKER_SCRIPTFULLNAME.length();
            int endFullName   = s.indexOf( MARKER_SCRIPT );
            int beginScript   = endFullName + MARKER_SCRIPT.length();
            int endScript     = s.indexOf( MARKER_SCRIPTEND );
            lst.add( new String[] {s.substring(beginName + MARKER_SCRIPTNAME.length(), endName), 
                                   s.substring(beginFullName, endFullName), 
                                   s.substring(beginScript, endScript)} );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return lst;
    }
    
    public static String removeScriptInfo( String getFrom ) {
        String s = getFrom;
        while ( s.indexOf( MARKER_SCRIPT ) > -1 ) {
            int beginName = s.indexOf( MARKER_SCRIPTNAME );
            int endScript = s.indexOf( MARKER_SCRIPTEND );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return s;
    }
        
	/**
	 * Some test stub
	 */
	public static void main(String[] args) {
	    
		/* getColList: Test for a permanent interface */
		IkmHiveApi inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"", 
				"", 
				"", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "",
                "4"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
		System.out.println();
		System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println("------------------------------"); 

		/* getColList: Test for a temporary interface */
		inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"sales_pers_id", 
				"sales_pers_id", 
				"sales_last_name", 
				"Exception getColList(...)", 
				"Exception getColList(...)", 
				"Exception getColList(...)",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "Exception getColList(...)", 
                "Exception getColList(...)", 
                "Exception getColList(...)",
                "4",
                "Exception getInfo(...)"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println("------------------------------"); 
        
        /* my test case */
        inst = new IkmHiveApi();
        inst.initMetadata(
                false,
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CUSTID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.LAST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.FIRST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.AGE$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CITY_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.SALES_PERS_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.DEAR$$SUNOPSIS$$1$$SUNOPSIS$$CUS.ADDRESS$$SUNOPSIS$$1$$SUNOPSIS$$CUS.PHONE",
                "",
                "",
                "dear",
                "",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "",
                "4"
                );
        System.out.println( inst.getColList("partition by (", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", ")", "PARTITION") );
        System.out.println( inst.getAllTargetColList("partition or cluster by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "PARTITION OR CLUSTER") );
        System.out.println( inst.getAllTargetColList("not partition by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "NOT PARTITION") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println( inst.getAllTargetColList("sort by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "SORT") );
        System.out.println("------------------------------"); 

        String getFrom = "select c1, c2, c3 from ( select c4, c5, c6 from (T1" + MARKER_SCRIPTNAME + "trafo1.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo1.pl" + MARKER_SCRIPT + "my script 1" + MARKER_SCRIPTEND + ") ODI_FROM, T2" +
                         MARKER_SCRIPTNAME + "trafo2.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo2.pl" + MARKER_SCRIPT + "my script 2" + MARKER_SCRIPTEND + ")";
        Iterator iter = getScriptInfo(getFrom).iterator();
        /* List scripts */
        while (iter.hasNext()) {
            String[] script = (String[])iter.next();
            System.out.println( script[0] + " : " + script[1] + " : " + script[2] ); 
        }
        System.out.println("------------------------------"); 
        System.out.println( removeScriptInfo(getFrom) ); 
        System.out.println("------------------------------"); 

	}

}

/* End of IkmHiveApi.java */

};

%>
<% /* -------- End of block ----- Keep this block in sync across all Hive KMs ----------- */ %>


<%
/* Pass metadata into KM specific code generation */
myRef = new IkmHiveApi();

String sColList_HIVE_PARTITION_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sColList_HIVE_CLUSTER_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sColList_HIVE_SORT_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_PARTITION_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_CLUSTER_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_SORT_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetTable_HIVE_BUCKETS = IkmHiveApi.MISSING_FLEXFIELD_GETINFO;

try { 
  sColList_HIVE_PARTITION_COLUMN = odiRef.getColList("", "[HIVE_PARTITION_COLUMN]", ""+(char)1, "", ""); 
  sColList_HIVE_CLUSTER_COLUMN = odiRef.getColList("", "[HIVE_CLUSTER_COLUMN]", ""+(char)1, "", ""); 
  sColList_HIVE_SORT_COLUMN = odiRef.getColList("", "[HIVE_SORT_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_PARTITION_COLUMN = odiRef.getAllTargetColList("", "[HIVE_PARTITION_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_CLUSTER_COLUMN = odiRef.getAllTargetColList("", "[HIVE_CLUSTER_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_SORT_COLUMN = odiRef.getAllTargetColList("", "[HIVE_SORT_COLUMN]", ""+(char)1, "", ""); 
  sTargetTable_HIVE_BUCKETS = odiRef.getTargetTable("HIVE_BUCKETS"); 
} catch (Exception e) {}

out.print(myRef.initMetadata( 
	false,
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, ""), 
	odiRef.getColList("", "[DEST_CRE_DT]", ""+(char)1, ""), 
	odiRef.getColList("", "[EXPRESSION]", ""+(char)1, ""), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "TRG"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD1"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD2"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD3"), 
	sColList_HIVE_PARTITION_COLUMN, 
	sColList_HIVE_CLUSTER_COLUMN, 
	sColList_HIVE_SORT_COLUMN,
	odiRef.getAllTargetColList("", "[COL_NAME]", ""+(char)1, ""), 
	odiRef.getAllTargetColList("", "[DEST_CRE_DT]", ""+(char)1, ""), 
	sTargetColList_HIVE_PARTITION_COLUMN, 
	sTargetColList_HIVE_CLUSTER_COLUMN, 
	sTargetColList_HIVE_SORT_COLUMN,
	"",
	sTargetTable_HIVE_BUCKETS
));
%>


hive = new flexUtilHive( odiRef.getJDBCConnection("DEST") )

// Validate KM option value for DEFER_TARGET_LOAD
if ( !(('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.length()==0) ||
    ('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.equals("START")) ||
    ('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.equals("NEXT")) ||
    ('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.equals("END")) ) )
    throw new RuntimeException( "Invalid KM option value for DEFER_TARGET_LOAD: '<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'. See KM option description for permitted values." );]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[539]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3abe3308-78c2-4c58-a996-d9afdfd85dec]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[294]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[452]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop flow table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[269fa5f0-4f6b-42a5-bf0c-3e0c285ae195]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[539]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>
// Execute only, if DEFER_TARGET_LOAD is START
if ('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.equals("START")) {
<%}%>

    sql = '''drop table if exists <%=odiRef.getTable("L", "INT_NAME", "W")%>'''
    hive.executeQuery( sql )

<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>}<%}%>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[540]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f310f7a1-34f6-48fd-b1c7-5a4a44e3000e]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[295]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[502]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop flow table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c05c954b-a948-4356-8ba1-1b388144adcc]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[540]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (odiRef.getOption("DELETE_TEMPORARY_OBJECTS").equals("1")) { %>

<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>
// Execute only, if DEFER_TARGET_LOAD is END
if ('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.equals("END")) {
<%}%>

    sql = '''drop table if exists <%=odiRef.getTable("L", "INT_NAME", "W")%>'''
    hive.executeQuery( sql )

<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>}<%}%>

<% } else { %>
// Intentionally left blank, as DELETE_TEMPORARY_OBJECTS is set to false
<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[541]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8e09012d-bd46-47c9-956f-151b49f7e83f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[296]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[462]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create flow table I$]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1321cec9-7ad4-49a9-9e0e-0ebae8fb6ae7]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[541]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>
// Execute only, if DEFER_TARGET_LOAD is START
if ('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.equals("START")) {
<%}%>

sql = '''
create <% if (odiRef.getOption("EXTERNAL_TABLE").equals("1")) out.print("external"); %> table if not exists <%=odiRef.getTable("L", "INT_NAME", "W")%>
(
	<%=odiRef.getSrcColList("", "[COL_NAME]\tSTRING", "[COL_NAME]\tSTRING", ",\n\t", "")%>
)
<%=myRef.getAllTargetColList("partitioned by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", ")\n", "PARTITION AND (UNMAPPED OR TARGET)")
/* The staging table contains all source columns and all unmmapped or target-side mapped partitioning columns. These partitioning columns are populated by the partitioning clause of the LOAD DATA command. */ %>

<% if (odiRef.getOption("OVERRIDE_ROW_FORMAT").trim().length() > 0) { 
      /* Custom row format */
%><%=odiRef.getOption("OVERRIDE_ROW_FORMAT").replaceAll(""+(char)92+(char)92, ""+(char)92+(char)92+(char)92+(char)92)%>

<% } else { if (odiRef.getSrcTablesList("", "[FILE_FORMAT]", "", "").equals("D")) { 
      /* Delimited file format */ %>
row format delimited
fields terminated by '<%=odiRef.getSrcTablesList("", "[SFILE_SEP_FIELD]", "", "")%>'
lines terminated by '<%=odiRef.getSrcTablesList("", "[SFILE_SEP_ROW]", "", "")%>'
stored as textfile

<% } else { 
      /* Fixed length file format */ %>
row format serde 'org.apache.hadoop.hive.contrib.serde2.RegexSerDe'
with serdeproperties (
  "input.regex" = "<%=odiRef.getSrcColList("", "(.{[BYTES]})", "(.{[BYTES]})", "", "")%>",
  "output.format.string" = ""
)
stored as textfile

<% }    /* Delimited or fixed length file format */ 

} %><% if (odiRef.getOption("EXTERNAL_TABLE").equals("1")){ %>LOCATION '<%=odiRef.getSrcTablesList("", "[SCHEMA]", "", "")%>'<%}%>
'''

hive.executeQuery( sql )

<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>}<%}%>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[542]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9d479535-765d-4d57-9f91-b5c96d4cbf89]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[297]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[472]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Load data file(s)]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4650ed27-beab-45c5-ac00-41cd5c5a5f6e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[542]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[1]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (odiRef.getOption("EXTERNAL_TABLE").equals("1") ) { %>
// Skipped, as KM option EXTERNAL_TABLE is set to 1. (All files in the [SRC_SCHEMA] directory are automatically loaded)
<%} else {%>

import org.apache.hadoop.fs.FileSystem
import org.apache.hadoop.fs.Path
import org.apache.hadoop.conf.Configuration
import org.apache.commons.io.filefilter.WildcardFilter
import java.net.URI

bs = ""+(char)92

// Verify that the filename pattern contains as many wildcards as we have unmapped partitioning columns in the target
fileNamePattern = <$=odiRef.getQuotedString( "<%=odiRef.getSrcTablesList("", "[RES_NAME]", "", "")%>" )$>
nWildCards = fileNamePattern.count( "*" ) + fileNamePattern.findAll( "["+bs+"?]+" ).size()
nPartitionColumns = "<%=myRef.getAllTargetColList("", "X", "", "", "PARTITION") %>".length()
nPartitionColumnsUnmapped = 0<%=myRef.getAllTargetColList("+", "[UNMAPPED]", "+", "", "PARTITION")%>
if ( nWildCards < nPartitionColumnsUnmapped ) 
     throw new RuntimeException( "\n\nError: File name pattern '${fileNamePattern}' contains ${nWildCards} wildcard(s), but target table contains ${nPartitionColumns} partition column(s) of which ${nPartitionColumnsUnmapped} are unmapped. For all unmapped paritioning columns there must be one and only one file name wild card.\n\n" )


def glob_to_regex( s ) {
// Escape the backslashes, dots, stars
fileNameRegEx = s
fileNameRegEx = fileNameRegEx.replaceAll( bs+bs, bs+bs+bs+bs )
fileNameRegEx = fileNameRegEx.replaceAll( bs+".", bs+bs+"." )
// Insert capturing group for question mark
fileNameRegEx = fileNameRegEx.replaceAll( "(["+bs+"?]+)", '($1)' )
// Replace questions marks by dots
fileNameRegEx = fileNameRegEx.replaceAll( "["+bs+"?]", '.' )
fileNameRegEx = fileNameRegEx.replaceAll( bs+"*", "(.*?)" )
return fileNameRegEx
}


// Collect all matching input file names
// two implementation kept, as hadoop local filesystem URLs have some issues, when used with relative or redirected paths

jdbcUrl = """<%=odiRef.getInfo("SRC_JAVA_URL")%>"""
path = <$=odiRef.getQuotedString("<%=odiRef.getSrcTablesList("", "[SCHEMA]", "", "")%>")$>

// Are the file(s) in HDFS?
if ( jdbcUrl.toUpperCase().startsWith( "HDFS:" ) ) {
    // The file(s) are in HDFS
    fullFileNamePattern = jdbcUrl + path + "/" + fileNamePattern
    fileNameRegEx = glob_to_regex( fullFileNamePattern )

    // No wild cards in the file name?
    if ( nWildCards == 0 ) {
        // The "list" of files to process is just this file name:
        lstFileNames = [ fullFileNamePattern ]

    } else {
        // Otherwise we need to collect the matching file names

        fs = FileSystem.get( new URI( fullFileNamePattern ),  new Configuration() )
        pt = new Path( fullFileNamePattern )
        // Get list of matching elements
        lst = fs.globStatus( pt )
        if ( lst == null ) lst = []
        // Remove all dirs
        lstFiles = lst.findAll{ !it.isDir() }
        lstFileNames = lstFiles.collect { it.getPath().toString() }
    }

} else {
    // The file(s) are from local FS
    fullFileNamePattern = new File( path, fileNamePattern ).getAbsolutePath();
    fileNameRegEx = glob_to_regex( fileNamePattern )

    // No wild cards in the file name?
    if ( nWildCards == 0 ) {
        // The "list" of files to process is just this file name:
        lstFileNames = [ fullFileNamePattern ]

    } else {
        // Otherwise we need to collect the matching file names

        dir = new File( path ).getAbsoluteFile();
        matchingName = { it.name =~ fileNameRegEx }
        isFile = { it.isFile() }
        lstFiles = dir.listFiles().findAll( matchingName ).findAll( isFile )
        lstFileNames = lstFiles.collect { it.getPath().toString() }
    }
}


<% if ( odiRef.getOption("STOP_ON_FILE_NOT_FOUND").equals("1") ) { %>
// Stop, if no files found
if ( lstFileNames.size() == 0) {
    throw new RuntimeException( "\n\nNo input files matching '${fullFileNamePattern}'!\n" );
}
<% } %>


// Load data for all files
allSqls = ""
lstFileNames.sort()
fileNameRegEx = glob_to_regex( fullFileNamePattern )
sLocal = "<%=(odiRef.getOption("FILE_IS_LOCAL").equals("1"))?"local":""%>"
sOverwrite = """<%=(odiRef.getOption("TRUNCATE").equals("1") && odiRef.getOption("USE_STAGING_TABLE").equals("0"))?"overwrite":""%>"""

tableName = '''<% if (odiRef.getOption("USE_STAGING_TABLE").equals("1")){%><%=odiRef.getTable("L", "INT_NAME", "W")%><%}else{%><%=odiRef.getTargetTable("RES_NAME")%><%}%>'''

for (sFile in lstFileNames) {
    sql = """load data ${sLocal} inpath '${sFile}' ${sOverwrite}""" + "\n" + 
             """into table ${tableName}""" + "\n"
    if ( nPartitionColumns > 0 ) {
        if ( nWildCards > 0 ) {
            matcher = ( sFile =~ fileNameRegEx )
            part_col_vals_from_fileName = matcher[0]
        }

        // Mix partition column values from filename and from target-side mapping expressions
        def part_col_vals = []
        <%=myRef.getAllTargetColList("<? i=1; ?>", "part_col_vals.add( <?=([MAPPED_ON_TARGET]==1)?\u0022\u0022+(char)34+\u0022[EXPRESSION]\u0022+(char)34:\u0022part_col_vals_from_fileName[\u0022+(i++)+\u0022]\u0022?> );\t// [COL_NAME]", "\n        ", "", "PARTITION AND (UNMAPPED OR TARGET)")%>

        sql += """<%=myRef.getAllTargetColList("<? i=0; ?>partition (", "[COL_NAME]=<?=(\u0022[DEST_CRE_DT]\u0022.equals(\u0022STRING\u0022) && \u0022[MAPPED_ON_TARGET]\u0022.equals(\u00220\u0022))?\u0022'\u0022:\u0022\u0022?>${part_col_vals[<?=i++?>]}<?=(\u0022[DEST_CRE_DT]\u0022.equals(\u0022STRING\u0022) && \u0022[MAPPED_ON_TARGET]\u0022.equals(\u00220\u0022))?\u0022'\u0022:\u0022\u0022?>", ", ", ")", "PARTITION AND (UNMAPPED OR TARGET)")%>"""
    }
    hive.executeQuery( sql )

    // Gather SQLs for report in next step
    allSqls += sql + ";\n\n"
}

<%}%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[543]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d18500fc-41c9-4701-8419-5ed358e09c95]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[298]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[482]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Report Data Files]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[74fc5348-9034-4036-8e77-a17d4bc1695e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[543]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (odiRef.getOption("EXTERNAL_TABLE").equals("1") ) { %>
// Skipped, as KM option EXTERNAL_TABLE is set to 1. (All files in the [SRC_SCHEMA] directory are automatically loaded)
<%} else {%>

throw new RuntimeException( "\n\nThis is no error, just an informational message: Load data commands submitted: \n\n" + allSqls + "\n" );

<%}%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[FILE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[544]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e55c74fb-a4df-43a3-a1bd-e736c0aead98]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[299]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:22.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[492]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert new rows]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d91b91ff-c876-49f2-aab0-7363c34d9bdb]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[544]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>
// Execute only, if DEFER_TARGET_LOAD is END
if ('''<%=odiRef.getOption("DEFER_TARGET_LOAD")%>'''.equals("END")) {
<%}%>

<?
String conv( String srcDT, String destDT, String expr ) {
    boolean fixedLenFile = <%=(odiRef.getSrcTablesList("", "[FILE_FORMAT]", "", "").equals("D"))?"false":"true"%>;
    String func = "";

        if (destDT.endsWith("INT")) {
            func = "cast( trim(" + expr + ") as " + destDT + ") ";
        } else if (destDT.equals("BOOLEAN")) {
            func = "cast( case when trim(" + expr + ")='0' or \n\t" +
                        "upper(trim(" + expr + "))='FALSE' or \n\t"+
                        "upper(trim(" + expr + "))='NO' then false \n\t"+
                        "when trim(" + expr + ")='1' or \n\t" +
                        "upper(trim(" + expr + "))='TRUE' or \n\t"+
                        "upper(trim(" + expr + "))='YES' then true \n\t"+
                        "else null end as " + destDT+ ")";
        } else {
            func = "cast( " + expr + "  as "+ destDT+ ")";
        };
return func;
}
?>

<% if (odiRef.getOption("TRUNCATE").equals("1")) { %>

sql = '''
insert overwrite table <%=odiRef.getTable("L","TARG_NAME","A")%> <%=myRef.getAllTargetColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>
select 
	<%=myRef.getAllTargetColList("", 
		"<?=conv(\u0022[SRC_CRE_DT]\u0022, \u0022[DEST_CRE_DT]\u0022, \u0022[EXPRESSION__NULL_IF_UNMAPPED]\u0022)?> \tas [COL_NAME]", 
		",\n\t", "", "NOT PARTITION")%>
	<%=myRef.getAllTargetColList(",", "[COL_NAME] as [COL_NAME]", ",\n\t", "", "PARTITION")%>
from	<%=odiRef.getTable("L", "INT_NAME", "W")%> <%=odiRef.getSrcTablesList("", "[POP_TAB_ALIAS]", "", "")%>
'''

hive.executeQuery( sql )

<%} else {%>

<% if (odiRef.getOption("HIVE_COMPATIBLE").equals("0.7")) { %>

// Create empty copy of target table
sql = '''drop table if exists <%=odiRef.getTable("L","TARG_NAME","A")%>_tmp'''
hive.executeQuery( sql )
sql = '''create table <%=odiRef.getTable("L","TARG_NAME","A")%>_tmp like <%=odiRef.getTable("L","TARG_NAME","A")%>'''
hive.executeQuery( sql )

sql = '''
insert overwrite table <%=odiRef.getTable("L","TARG_NAME","A")%>_tmp <%=myRef.getAllTargetColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>
select
	<%=myRef.getAllTargetColList("", "[COL_NAME]", ",\n\t", "", "NOT PARTITION")%>
	<%=myRef.getAllTargetColList(",", "[COL_NAME]", ",\n\t", "", "PARTITION")%>
from ( select 
	<%=myRef.getAllTargetColList("", 
		"<?=conv(\u0022[SRC_CRE_DT]\u0022, \u0022[DEST_CRE_DT]\u0022, \u0022[EXPRESSION__NULL_IF_UNMAPPED]\u0022)?> \tas [COL_NAME]", 
		",\n\t", "", "NOT PARTITION")%>
	<%=myRef.getAllTargetColList(",", "[COL_NAME] as [COL_NAME]", ",\n\t", "", "PARTITION")%>
    from	<%=odiRef.getTable("L", "INT_NAME", "W")%> <%=odiRef.getSrcTablesList("", "[POP_TAB_ALIAS]", "", "")%>

    union all

    select 
	<%=myRef.getAllTargetColList("", "[COL_NAME]", ",\n\t", "", "NOT PARTITION")%>
	<%=myRef.getAllTargetColList(",", "[COL_NAME]", ",\n\t", "", "PARTITION")%>
    from 	<%=odiRef.getTable("L","TARG_NAME","A")%>
) trg
'''
hive.executeQuery( sql )

// Drop old target table
sql = '''drop table <%=odiRef.getTable("L","TARG_NAME","A")%>'''
hive.executeQuery( sql )

// Rename new target table
hive.executeQuery( '''alter table <%=odiRef.getTargetTable("RES_NAME")%>_tmp rename to <%=odiRef.getTargetTable("RES_NAME")%>''' )
<% /* Omitting the schema names to work-around  HIVE-2496. The correct code should be
     hive.executeQuery( '''alter table <%=odiRef.getTable("L","TARG_NAME","A")%>_tmp rename to <%=odiRef.getTable("L","TARG_NAME","A")%>''' )
<% */ %>

<%} else {%>

sql = '''
insert into table <%=odiRef.getTable("L","TARG_NAME","A")%> <%=myRef.getAllTargetColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>
select
	<%=myRef.getAllTargetColList("", "[COL_NAME]", ",\n\t", "", "NOT PARTITION")%>
	<%=myRef.getAllTargetColList(",", "[COL_NAME]", ",\n\t", "", "PARTITION")%>
from ( select 
	<%=myRef.getAllTargetColList("", 
		"<?=conv(\u0022[SRC_CRE_DT]\u0022, \u0022[DEST_CRE_DT]\u0022, \u0022[EXPRESSION__NULL_IF_UNMAPPED]\u0022)?> \tas [COL_NAME]", 
		",\n\t", "", "NOT PARTITION")%>
	<%=myRef.getAllTargetColList(",", "[COL_NAME] as [COL_NAME]", ",\n\t", "", "PARTITION")%>
       from	<%=odiRef.getTable("L", "INT_NAME", "W")%> <%=odiRef.getSrcTablesList("", "[POP_TAB_ALIAS]", "", "")%>
) trg
'''
hive.executeQuery( sql )

<% } %>

<% } %>

<% if (odiRef.getOption("DEFER_TARGET_LOAD").length()>0) {%>}<%}%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[54a73f43-7603-46cd-b44b-70ff4b91d6e9]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[292]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[149]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c10c9690-13c7-49a4-91fe-f08a35106004]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[292]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[153]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[00040909-018a-404a-8150-b2ef7ca82076]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[292]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ba5b550a-c561-4684-a6d7-ced15f4640d7]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[292]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[152]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[d9b779bb-a022-4389-bdb9-9595453a7060]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[292]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[151]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[110728ed-d76e-4ba3-a346-5cf35993ff55]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[292]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c64ad4e8-837d-4876-96a7-ecd20c856af8]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[293]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[da692c10-1ec5-46db-ac4f-bbacf6d4df5d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[294]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[152]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a45464d9-0ff3-4a9d-9aa6-3f16afbbae0b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[295]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[152]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[723a4786-692b-4008-ab56-9be60a64320d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[296]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[152]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b5df4095-c197-4322-bf4d-c5d7e0bc1ff1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[297]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[152]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4a778689-5961-41f8-a3b2-247d5182d697]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[297]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[148]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[0cf28eee-6aeb-4808-be90-b6cb597ccdc6]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[297]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[2a11fd0c-f3f2-48fa-a2c7-4f74850941a9]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[297]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[149]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3a4155e5-92f3-4946-8d26-2a619bc848ef]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[297]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[156]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[410712d3-7277-491a-b95c-038dbf5a8688]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[297]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[153]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[edb57b8e-742a-46ae-9f86-723895c6e31f]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[297]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[151]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ba397e22-0e1b-40c6-b039-fdc8642255ed]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[299]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[152]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[58263170-bfed-4aa3-a3cb-36c3fcb35ea5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[292]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[5351]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[156]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="BaseKmType" type="java.lang.String">null</Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GenType" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[57fbdddc-71d6-4e38-b76c-eb08bd07fc60]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="IsConcurrent" type="java.lang.String">null</Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[545]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="KmVersion" type="java.lang.String"><![CDATA[17]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:27.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[1345261378]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[IKM File-Hive to Oracle (OLH-OSCH)]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[KI]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp"><![CDATA[2009-04-17 16:17:44.0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5b0a9977-5f98-4a75-93bb-c3ff78610ee8]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[545]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[COMPONENT NAME: IKM File-Hive to Oracle (OLH-OSCH)
AUTHOR: Oracle

DESCRIPTION
	This KM integrates data from an HDFS file or Hive source into an Oracle target using Oracle Loader for Hadoop.
	It executes the following steps:
		1. For Hive sources: optionally stage source result set in a Hive table
		3. Execute OLH to load file/hive data into Oracle staging or target table
		3. Optionally load data from Oracle staging table into target table
	Depending on chosen OLH load strategy extra steps may apply.
	Additional information can be found on KM option descriptions.
	The KM can handle filename wildcards (*, ?).

REQUIREMENTS
	- Oracle Target instance, Hive and Hadoop/Cloudera versions must comply with OLH requirements.
	   Please see section "Installing Oracle Loader for Hadoop" in "Oracle Loader for Hadoop User's Guide" for details
	- Source files must be in HDFS
	- CDH3: hadoop-xxx-core.jar, hadoop-xxx-tools.jar must be on ODI class path and use same version as Hadoop cluster
	- CDH4: $HADOOP_HOME/client/* must be on ODI class path and use same version as Hadoop cluster
	- hadoop configuration directory must be on ODI class path (containing e.g. core-default.xml, core-site.xml, hdfs-site.xml)
	- when OLH_OUTPUT_MODE=DP_OSCH or OSCH: additional installation requirements must be met as detailed in 
	   "Oracle Direct Connector for Hadoop Distributed File System Setup" in "Oracle Big Data Connectors - User's Guide". 
	   Please note that this includes a Hadoop client installation on the target database nodes.
	- when OLH_OUTPUT_MODE=DP_OSCH: orahdfs.jar must be on ODI class path
	- UNIX environment variables for ODI with OLH:
		HADOOP_HOME: points to Hadoop Home
		OLH_HOME: $OLH_HOME/jlib must contain oraloader.jar
		ODI_OLH_JARS: optional env var, list any JAR files required for custom input formats, Hive, Hive SerDes, 
		    and so forth, used by Oracle Loader for Hadoop. Do not include the Oracle Loader for Hadoop JAR files.
		    For example, for extracting data from Hive, you need the extra jars listed in 
		    "Specifying Hive Input Format JAR Files". 
		    Enter valid file names for your installation:
		    $HIVE_HOME/lib/hive-metastore-*.jar,
		    $HIVE_HOME/lib/libthrift.jar,
		    $HIVE_HOME/lib/libfb*.jar
		ODI_HIVE_SESSION_JARS must contain any non-standard Hive jars required 
		    when extracting the hive source result set. 
		    E.g. hive-contrib.jar, if RegExSerDe used anywhere.
		ODI_OLH_FILES: optional env var, comma separated list of files to be copied to the map reduce cluster.
	- Other environment settings on ODI machine:
		HADOOP_CLASSPATH should include these jars when extracting from Hive:
		   HADOOP_CLASSPATH=$HIVE_HOME/lib/hive-metastore-*.jar:
		    $HIVE_HOME/lib/libthrift.jar:
		    $HIVE_HOME/lib/libfb*.jar:
		    $HIVE_HOME/lib/hive-common-*.jar:
		    $HIVE_HOME/lib/hive-exec-*.jar
		    Please note that any wildcard must be replaced by respective version no.
		    This setting enables the Hadoop script to start Hive MapReduce jobs.
		HADOOP_OPTS: if target is Infini-Band-linked Oracle Exadata, please consider adding 
		    "-Doracle.net.SDP=true -Djava.net.preferIPv4Stack=true" to activate JDBC over SDP.
		    For more details please refer to OLH BDC Documentation.
	- The Oracle connection URL in data server definition should be specified using the service name
	  Example: jdbc:oracle:thin:@//acme-dbserver:1521/orcl.localdomain
	- Depending on OLH_OUTPUT_MODE additional setup requirements may apply. Please refer 
	  to section "Output Modes during OraLoader Invocation" of "Oracle Loader for Hadoop User's Guide" for 
	  details about OutputFormats.
	- the hdfs directory defined by MAPRED_OUTPUT_BASE_DIR must exists and must be writable 
	  for the ODI (agent) os user
	- when OLH_OUTPUT_MODE=DP_COPY: 
	  downloaded data files (path defined by KM option EXT_TAB_DIR_LOCATION) must be 
	  accessible by the Linux user, which runs the Oracle database for external table access. 
	  E.g. the Oracle instance user should be in the same linux user group as the ODI agent user.
	- when OLH_OUTPUT_MODE=DP_COPY/DP_OSCH:
	  the Oracle JDBC connection must have CREATE ANY DIRECTORY privileges
	- when sourcing from Hive, the FlexField "Hive Metastore URIs" on the Hive DataServer must be set
	  Example: 
	  thrift://acme-node01:10000 
	- for improved performance during data transfer from Oracle staging table into target table,
	  please consider activating parallel DML:
	  ALTER SESSION ENABLE PARALLEL DML;

BASIC CONFIGURATION
	- Make sure that all above requirements have been met
	- Make sure that hdfs directory /user/odi/output exists and is writable for ODI (agent) os user
	- For file source: make sure that JDBC URL contains a valid hdfs url to the HDFS server
	  e.g. hdfs://acme-nn:50070
	- For hive source: make sure that JDBC URL contains a valid hive url to the Hive server
	  e.g. jdbc:hive://acme-hive:10000/default	
	- Add the source DataStore (File or Hive) into the interface's source area
	- Add the Oracle target table into the interface's target area
	- Add straight mappings on source
	- Set the interface's staging area to the logical schema of the
	  source file in the definition tab of the interface

OPTIONS (Refer to Option descriptions for more information on each option)
	- OLH_OUTPUT_MODE: use JDBC, OCI or DataPump for data transfer
	- REJECT_LIMIT: Max number of errors for OLH/EXTTAB
	- CREATE_TARG_TABLE: Create target table?
	- TRUNCATE: Truncate target table
	- DELETE_ALL: Delete target table
	- USE_HIVE_STAGING_TABLE: Materialize Hive source data before extract
	- USE_ORACLE_STAGING_TABLE: Use an Oracle staging table
	- EXT_TAB_DIR_LOCATION: Shared file path used for DataPump transfer 
	- TEMP_DIR: Local path for temporary files
	- MAPRED_OUTPUT_BASE_DIR: hdfs dir for OLH output files
	- FLOW_TABLE_OPTIONS: Options for flow table creation
	- DELETE_TEMPORARY_OBJECTS: Remove temporary objects after execution?
	- OVERRIDE_INPUTFORMAT: For handling custom file formats
	- EXTRA_OLH_CONF_PROPERTIES: Optional extra OLH config file properties

LIMITATIONS
	- only UNIX platforms supported
	- all mapping expressions must be on source
	- only Oracle [N][VAR]CHAR[2] and numeric columns can be loaded
	  Other data types should be loaded as VARCHAR2 and converted after loading
	- for OCI mode: target table must be partitioned (OLH requirement)
	- for OSCH mode: no support for Hive source, no support for custom InputFormats
	- insert counter reflects number of rows loaded only if USE_ORACLE_STAGING=1
	- for File sources: only single source table with straight mappings supported
	- for File sources: only UTF8 encoded files are supported
	- for Hive sources: transformations, joins, filters and inline-views from 
	  "IKM Hive Control Append" are supported, only if USE_HIVE_STAGING_TABLE = 1; 
	   All mappings, joins and filters must be applied on source.

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8c5f46a7-61b0-4cf1-b179-d470be270250]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[546]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[158]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[JDBC]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[OLH_OUTPUT_MODE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[How to transfer data into Oracle?]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b1f858f2-c218-4f0c-abcd-8d59f8c08e30]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[546]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This option specifies how to load the Hadoop data into Oracle. Permitted values are JDBC|OCI|DP_COPY|DP_OSCH|OSCH.

JDBC output mode:
The data is inserted using a number of direct insert JDBC connections. 
In very rare cases JDBC mode may result in duplicate records in target table due to Hadoop trying to restart tasks.

OCI output mode:
The data is inserted using a number of direct insert OCI connections in direct path mode. 
If USE_ORACLE_STAGING=0, target table must be partitioned.
If USE_ORACLE_STAGING=1, FLOW_TABLE_OPTIONS must explicitely specify partitioning: e.g. "PARTITION BY HASH(COL1)  PARTITIONS 4"
In very rare cases OCI mode may result in duplicate records in target table due to Hadoop trying to restart tasks.

DP_COPY output mode:
OLH creates a number of DataPump export files. These files are transferred by a "Hadoop fs -copyToLocal" command to the local path specified by EXT_TAB_DIR_LOCATION. - Please note that the path must be accessible by the Oracle Database engine. Once the copy job is complete, an external table is defined in the target database, which accesses the files from EXT_TAB_DIR_LOCATION.

DP_OSCH output mode:
OLH creates a number of DataPump export files. After the export phase an external table is created on the target database, which accesses these output files directly via OSCH. - Please note that the path must be accessible by the Oracle Database engine. Once the copy job is complete, an external table is defined in the target database, which accesses the files from EXT_TAB_DIR_LOCATION.

OSCH output mode:
In OSCH mode loading bypassed OLH. ODI creates an external table on the target database, which accesses the input files through OSCH. - Please note that only delimited and fixed length files can be read. No support for loading from Hive or custom InputFormats such as RegexInputFormat, as there is no OLH pre-processing. 
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d6a5cf35-af89-4448-ba86-662e5d6af7b6]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[547]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[159]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[UNLIMITED]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[REJECT_LIMIT]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Max number of errors for OLH/EXTTAB]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5b8fd849-8b50-4dbc-be47-8b10d7a71ec9]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[547]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Enter the maximum number of errors allowed in the file. Examples: UNLIMITED to except all errors. Integer value (10 to allow 10 rejections)

This value is used in OLH job definitions as well as in external table definitions.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[38685251-1e4d-444b-99b7-7557a84e48ca]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[548]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[CREATE_TARG_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Create the target table.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f23da6c4-6890-44c0-a29f-798cbd0e581a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[548]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Check this option if you wish to create the target table ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[79adefcd-dc8c-4cc4-b789-586741f1d9fc]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[549]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[TRUNCATE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Replace existing target data?]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[772eaf70-5605-489b-8f0a-5fc605e4988e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[549]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Set this option to true, if you wish to replace the target table content with the new data.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[19a59ad1-52e8-4438-a94f-90f9bc3a8b1e]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[550]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[190]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DELETE_ALL]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Delete all rows ]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[80ce6950-4ecd-40f2-8165-3b124915324e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[550]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Set this option to true, if you wish to replace the target table content with the new data.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4bf3f868-8296-4cae-9866-7a405b487290]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[551]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[390]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[USE_HIVE_STAGING_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Use intermediate staging table?]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a2fd777e-003d-4ad3-9f1f-9e4d9bfb4eb5]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[551]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Only applies, if source technology is Hive

By default the Hive source data is getting materialized in a Hive staging table prior to extraction by OLH. If USE_HIVE_STAGING_TABLE is set to false, OLH directly accesses the Hive source data.

USE_HIVE_STAGING_TABLE=0 is only possible, if all these conditions are true
- Only a single source table
- No transformations, filters, joins
- No datasets
USE_HIVE_STAGING_TABLE=0 provides better performance by avoiding an extra data transfer step.
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9a578002-e6f8-47a8-b7cf-24f112ab019c]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[552]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[400]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[USE_ORACLE_STAGING_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Use intermediate staging table?]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[03c5f14f-42ed-4f0a-88df-2de701123aed]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[552]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[The extracted data is made available to Oracle by an external table. If USE_ORACLE_STAGING_TABLE = true (default), the external table is created as a temporary (I$) table. This I$ table data is then inserted into the target table.

USE_ORACLE_STAGING_TABLE=0 is only possible, if all these conditions are true
- OLH_OUTPUT_MODE = JDBC or OCI
- All source columns are mapped
- All target columns are mapped
- No target-side mapping expressions

USE_ORACLE_STAGING_TABLE=0 provides better performance by avoiding an extra data transfer step, but may lead to partial data being loaded into the target table, as OLH loads data in multiple transactions.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[cf8e1a07-c6bd-4392-983d-8627f7ada83c]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[553]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[165]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[405]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[<Please specify external table file location>]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[EXT_TAB_DIR_LOCATION]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Directory for ext tab data files]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7c2387f8-e4e7-4a82-a68e-f48f6b8cbcff]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[553]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[File system path of the external table.

Note 1: Only applicable, if OLH_OUTPUT_MODE = DP_*|OSCH
Note 2: for OLH_OUTPUT_MODE = DP_*: this path must be accessible both from the ODI agent and from the target database engine.
Note 3: for OLH_OUTPUT_MODE = DP_*: the name of the external directory object is the I$ table name.
Note 4: for OLH_OUTPUT_MODE = DP_COPY: ODI agent will use hadoop-fs command to copy dp files into this directory.
Note 5: for OLH_OUTPUT_MODE = DP_*|OSCH: this path will contain any external table log/bad/dsc files.
Note 6: ODI agent will remove any files from this directory during clean up before launching OLH/OSCH.
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[744d33af-e0f1-4181-9e88-eaf201a9a7d3]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[554]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[166]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[410]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[TEMP_DIR]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Directory for temporary files]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c4f8e377-2c76-4966-8ecb-e86e54e732cd]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[554]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Path used for temporary files such as OLH config file, map file, stdout/stderr redirects

leave blank to use system's default temp dir (<?=System.getProperty(?java.io.tmp?)?>)

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f6ad1128-dc14-45fa-a0d8-88d75c076348]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[555]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[167]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[440]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[/user/odi/output]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[MAPRED_OUTPUT_BASE_DIR]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[MapReduce Output Directory]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d23e9e07-f9f5-459e-883a-6f0ba9d92f3b]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[555]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This option specifies an hdfs directory, where the OLH job will create subdirectories for temporary files / datapump output files.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[16082bb7-35eb-4cad-a0c0-a0189122022a]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[556]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[168]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[450]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[NOLOGGING]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[FLOW_TABLE_OPTIONS]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Option for Flow table creation]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ec44ddef-4a66-466d-9803-bdbb9d5b069a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[556]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Use this option to specify the attributes for the integration table at create time and used for increasing performance.
This option is set by default to NOLOGGING.
This option may be left empty.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d05999db-1200-4e39-9b03-c323f8d82bf6]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[557]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[460]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DELETE_TEMPORARY_OBJECTS]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Delete temp objects post int]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[96ebc139-73cd-4779-9731-f2badede47c9]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[557]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Set this option to NO if you wish to retain temporary objects (tables, files and scripts) after integration.
Useful for debugging.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1303feb9-0caa-4e0a-bf2c-ed6794e6fac5]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[558]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[800]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[OVERRIDE_INPUTFORMAT]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Class name of InputFormat]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4b764d01-3ef2-418c-90b3-78f2e6263046]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[558]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[By default the InputFormat class is derived from the source DataStore/Technology (DelimitedTextInputFormat or HiveToAvroInputFormat). This option allows the user to specify the class name of a custom InputFormat. - Default: <empty>

Cannot be used with OLH_OUTPUT_MODE=OSCH

Example:
For reading custom file formats like web log files the OLH RegexInputFormat can be used by assigning the value: oracle.hadoop.loader.lib.input.RegexInputFormat
See KM option EXTRA_OLH_CONF_PROPERTIES for details on how to specify the regular expression
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f18fc1bf-2c43-49d3-901b-f0263ef69c4d]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[559]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[171]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[810]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[EXTRA_OLH_CONF_PROPERTIES]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Optional extra OLH properties]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[T]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ffc2db53-11d5-4e8c-927a-521174852ed0]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[559]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Particularly when using custom InputFormats (see KM option OVERRIDE_INPUTFORMAT for details) the InputFormat may require additional configuration parameters. These are provided in the OLH configuration file. This KM option allows adding extra properties to the OLH configuration file. - Default: <empty>

Cannot be used with OLH_OUTPUT_MODE=OSCH

Example (loading apache weblog file format):
When OLH RegexInputFormat is used for reading custom file formats, this KM option specified the regular expression and other parsing details:

    <property>
        <name>oracle.hadoop.loader.input.regexPattern</name>
        <value>([^ ]*) ([^ ]*) ([^ ]*) (-|\[[^\]]*\]) ([^ \"]*|\"[^\"]*\") (-|[0-9]*) (-|[0-9]*) (\".*?\") (\".*?\") (\".*?\")</value>
        <description>RegEx for Apache WebLog format</description>
    </property>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[560]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6b46a03c-99f0-45e5-8bfa-17fc90135e41]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Launch Loader]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c7172967-d693-43ff-a773-389daa6124f3]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[560]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( !odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH") ) { 

%>OdiOSCommand -OUT_FILE=<?=loaderStdOutFileName?> -ERR_FILE=<?=loaderErrFileName?>
$HADOOP_HOME/bin/hadoop jar $OLH_HOME/jlib/oraloader.jar oracle.hadoop.loader.OraLoader -conf <?=confFileNameLocal?> <?=odiOlhJars?> <?=odiOlhSharedLibs?>

<% } else { 

%>OdiSleep -DELAY=1

<% /* Skipped, as OLH_OUTPUT_MODE == OSCH */ 
} %>

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[561]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4c6d3d58-4fd7-4a6c-a5ce-03673f177e71]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[190]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create Oracle Directory Object]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[dde96ca9-2efd-4495-9d3b-2fb4dbd2e68c]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[561]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")) 
{ %>

create or replace directory ODI_OLH_EXTTAB_DIR_<%=odiRef.getSession("SESS_NO")%> as '<?=extTabDir?>'

<% } else { %>

-- Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH

<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[562]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5052c0dc-9b48-43fe-a8ca-eb650d17d908]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[302]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Truncate target table ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c5c6755f-0f19-41f8-b21c-169b78752327]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[562]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[truncate table <%=odiRef.getTable("L", "TARG_NAME", "A")%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[563]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[196ca6c3-1ae7-4c9c-a8e7-25d967bb5a5b]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[303]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[200]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop Hive staging table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1b6361ab-4993-45b2-bd6b-9690d3367288]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[563]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (	
	odiRef.getInfo("SRC_TECHNO_NAME").toUpperCase().equals("HIVE") &&
	odiRef.getOption("DELETE_TEMPORARY_OBJECTS").equals("1")
) { %>

// Drop Hive I$ table, if exists
hive.executeQuery( '''drop table if exists <%=odiRef.getTable("L", "INT_NAME", "W")%>''' )

<%} else { %>
// Step skipped due to SOURCE_TECHNO != HIVE or DELETE_TEMPORARY_OBJECTS = 0
<%}%>


]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Source Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[COL_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[564]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[57bea543-277e-461f-ab5a-af16ccfd9552]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[304]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[210]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Make ext tab dir]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[039d517b-a11b-4615-b17a-a4fe2d87820a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[564]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")) { 
%>OdiOSCommand -OUT_FILE=<?=loaderStdOutFileName?> -ERR_FILE=<?=loaderErrFileName?>
mkdir '<?=extTabDir?>'

<% } else { %>OdiSleep -DELAY=1 <@ /* -- Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH */ @>
<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[565]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6df097c9-77a3-4513-99ee-f207bd3b63ee]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[305]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[230]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Clean ext tab dir]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[08585054-416f-433a-89be-eed29238c509]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[565]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")) { 
%>OdiOSCommand -OUT_FILE=<?=loaderStdOutFileName?> -ERR_FILE=<?=loaderErrFileName?>
rm -f '<?=extTabDir?>'/*

<% } else { %>OdiSleep -DELAY=1 <@ /* -- Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH */ @>
<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[566]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3b8d9e8d-818d-476f-a407-6d7935490f1d]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[306]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[240]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Set ext tab dir permissions]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[bca01b15-5b64-4929-ae1f-435bfc3ca294]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[566]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")) { 
%>OdiOSCommand -OUT_FILE=<?=loaderStdOutFileName?> -ERR_FILE=<?=loaderErrFileName?>
chmod g+rw '<?=extTabDir?>'

<% } else { %>OdiSleep -DELAY=1 <@ /* -- Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH */ @>
<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[567]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[db4b5399-112e-4e9a-86a4-fc1182e09853]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[307]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[250]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create Oracle external (staging) table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[807ed9c7-0aa3-4511-a172-2d1881704e99]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[567]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY")  ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")
) { %>

import java.sql.SQLException

<% } %><% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ) { %>
import org.apache.hadoop.fs.FileSystem
import org.apache.hadoop.fs.Path
import org.apache.hadoop.conf.Configuration
import org.apache.commons.io.filefilter.WildcardFilter
import java.net.URI

conf = new Configuration();
// Load config files
// Not needed, as default config files are imported automatically from classpath
//conf.addResource( new Path("<?=System.getenv("HADOOP_HOME")?>/conf/core-default.xml") );
//conf.addResource( new Path("<?=System.getenv("HADOOP_HOME")?>/conf/core-site.xml") );

// Collect all matching input file names
<% if ( odiRef.getInfo("SRC_TECHNO_NAME").toUpperCase().equals("HIVE") ) { %>
jdbcUrl = ''''''
<% } else { %>
jdbcUrl = '''<%=odiRef.getInfo("SRC_JAVA_URL")%>'''
<% }; %>
fullFileNamePattern = jdbcUrl + '''<?=mapredOutputDir?>/*.dat'''
fs = FileSystem.get( new URI( fullFileNamePattern ),  conf )
pt = new Path( fullFileNamePattern )
// Get list of matching elements
lst = fs.globStatus( pt )
if ( lst == null ) lst = []
// Remove all dirs
lstFiles = lst.findAll{ !it.isDir() }
lstFileNames = lstFiles.collect { it.getPath().getName() }


// Stop, if no files found
if ( lstFileNames.size() == 0) {
    throw new RuntimeException( "\n\nNo data pump files found at: '${fullFileNamePattern}'!\n" );
}


// Build location string
locations = ''
for (sFile in lstFileNames) {
    locations += (locations.length()>0)?",":""
    locations += "'${sFile}'"
}

<% } %><% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH") ) { %>

locations = ''' '<%=(odiRef.getOption("USE_ORACLE_STAGING_TABLE").equals("1"))?odiRef.getTable("L", "INT_NAME", "W"):odiRef.getTable("L", "TARG_NAME", "A")%>.loc' '''.replaceAll(""+(char)34, "")

<% } %><% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY")  ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")
) { %>


sql = '''

create table <%=(odiRef.getOption("USE_ORACLE_STAGING_TABLE").equals("1"))?odiRef.getTable("L", "INT_NAME", "W"):odiRef.getTable("L", "TARG_NAME", "A")%>
(
	<%=odiRef.getColList("", "[COL_NAME]\t[DEST_CRE_DT] NULL", ",\n\t", "")%>
)
ORGANIZATION EXTERNAL
  (TYPE <% if (	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ) {
	%>ORACLE_DATAPUMP<%} else {
	%>ORACLE_LOADER<%};%>
   DEFAULT DIRECTORY ODI_OLH_EXTTAB_DIR_<%=odiRef.getSession("SESS_NO")%>
   <% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ) { 
   %>ACCESS PARAMETERS (
      EXTERNAL VARIABLE DATA
      PREPROCESSOR HDFS_BIN_PATH:'hdfs_stream'
   )
   <% } %>
   <% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH") ) { 

   %>ACCESS PARAMETERS (
      RECORDS DELIMITED BY 0x'<%=odiRef.getSrcTablesList("[XFILE_SEP_ROW]","")%>'
      PREPROCESSOR HDFS_BIN_PATH:'hdfs_stream'
      CHARACTERSET UTF8
      SKIP <%=odiRef.getSrcTablesList("", "[FILE_FIRST_ROW]", "", "")%>
      <% if (odiRef.getSrcTablesList("", "[FILE_FORMAT]", "", "").equals("F")) {%>
	FIELDS
	(
		<%=removeDQ(odiRef.getSrcColList("", "<?=<dq><dq>+(char)34+r.getCxColName(<dq>[COL_NAME]<dq>)+(char)34?>\tPOSITION([FILE_POS]:[FILE_END_POS])\t"+
			"<?=extTabColFormat.getExtTabFormat(<dq>[COL_NAME]<dq>,<dq>[SOURCE_DT]<dq>, <dq>[DEST_WRI_DT]<dq>, <dq>[COL_FORMAT]<dq>, <dq>[BYTES]<dq>, <dq>[LONGC]<dq>, <dq>[SCALE]<dq>)?>",
			"<?=<dq><dq>+(char)34+r.getCxColName(<dq>[COL_NAME]<dq>)+(char)34?>\tPOSITION([FILE_POS]:[FILE_END_POS])\t"+
			"<?=extTabColFormat.getExtTabFormat(<dq>[COL_NAME]<dq>,<dq>[SOURCE_DT]<dq>, <dq>[DEST_WRI_DT]<dq>, <dq>[COL_FORMAT]<dq>, <dq>[BYTES]<dq>, <dq>[LONGC]<dq>, <dq>[SCALE]<dq>)?>",
			",\n\t\t",""))%>		
	)
      <%} else {%>
	FIELDS  TERMINATED BY  x'<%=odiRef.getSrcTablesList("", "[XFILE_SEP_FIELD]", "", "")%>'
	<% if(odiRef.getSrcTablesList("", "[FILE_ENC_FIELD]", "", "").equals("")){%>
	<%} else {%>OPTIONALLY ENCLOSED BY '<%=odiRef.getSrcTablesList("", "[FILE_ENC_FIELD]", "", "")%>' <%}%>
<% /*	FIELDS MISSING VALUES ARE NULL */ %>
	(
		<%=removeDQ(odiRef.getSrcColList("", "<?=<dq><dq>+(char)34+r.getCxColName(<dq>[COL_NAME]<dq>)+(char)34?>\t"+
			"<?=extTabColFormat.getExtTabFormat(r.getCxColName(<dq>[COL_NAME]<dq>),<dq>[SOURCE_DT]<dq>, <dq>[DEST_WRI_DT]<dq>, <dq>[COL_FORMAT]<dq>, <dq>[BYTES]<dq>, <dq>[LONGC]<dq>, <dq>[SCALE]<dq>)?>",
			"<?=<dq><dq>+(char)34+r.getCxColName(<dq>[COL_NAME]<dq>)+(char)34?>\u0022\t"+
			"<?=extTabColFormat.getExtTabFormat(r.getCxColName(<dq>[COL_NAME]<dq>),<dq>[SOURCE_DT]<dq>, <dq>[DEST_WRI_DT]<dq>, <dq>[COL_FORMAT]<dq>, <dq>[BYTES]<dq>, <dq>[LONGC]<dq>, <dq>[SCALE]<dq>)?>",
			",\n\t\t", ""))%>		
	)
      <%}%>
   )
   <% } %>
   LOCATION (''' + locations + ''')
  )
  REJECT LIMIT <%=odiRef.getOption("REJECT_LIMIT")%>
'''


con = odiRef.getJDBCConnectionFromLSchema( '''<%=odiRef.getInfo("DEST_LSCHEMA_NAME")%>''' )
stmt = con.createStatement();
 
//Execute the SQL statement
try {
    stmt.executeUpdate( sql )
} catch (SQLException re) {
    def msg = "Exception encountered while submitting: \n-------------------\n" + sql + "\n-------------------"
    def count = 1
    def e = re
    while (e != null) {
        msg += "\n" + e.getMessage()
        e = e.getNextException()
        count += 1
    }
    throw new SQLException( msg )
}

<% } else { %>

// Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH 

<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[568]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[87e575df-5299-45f8-8d47-ff97b12a5c4f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[308]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[260]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Report external table definition]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ac5a146d-d9b0-403f-9dc8-373e657d6cd4]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[568]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH") ) { %>

throw new RuntimeException( "\n\nThis is no error, just an informational message: Create external table command submitted: \n\n" + sql + "\n" );

<% } else { %>

// Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH

<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[569]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ab24c234-f9f8-4afe-8eb7-4b9b6785791f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[309]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[270]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Download data files]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[366c4c7c-d14c-4ac6-a51f-d8747c61ad1f]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[569]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ) { 

%>OdiOSCommand -OUT_FILE=<?=loaderStdOutFileName?> -ERR_FILE=<?=loaderErrFileName?>
$HADOOP_HOME/bin/hadoop fs -copyToLocal "<?=mapredOutputDir?>/*.dat" "<?=extTabDir?>"

<% } else { 

%>OdiSleep -DELAY=1

<% /* Skipped, as OLH_OUTPUT_MODE != DP_COPY */ 
} %>

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[570]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f9d52726-9908-4ad3-b50c-af2b44ffbe38]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[310]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[280]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Publish HDFS data paths]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a0552196-3020-4d68-8737-4cfb38b5073c]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[570]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( 	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")) { 
%>

import oracle.hadoop.hdfs.exttab.ExternalTable
import java.io.OutputStream
import java.io.ByteArrayOutputStream
import org.apache.hadoop.conf.Configuration

out = new ByteArrayOutputStream()
lSchemaName = '''<%=odiRef.getInfo("DEST_LSCHEMA_NAME")%>'''
con = odiRef.getJDBCConnectionFromLSchema( lSchemaName )

// define the command in the arg list
//String[] args = {'''-publish''' '''--noexecute'''}
String[] args = new String[1]
args[0] = '-publish'

Configuration conf = new Configuration()
// Load config files
//conf.addResource( new Path("<?=System.getenv("HADOOP_HOME")?>/conf/core-default.xml") );
//conf.addResource( new Path("<?=System.getenv("HADOOP_HOME")?>/conf/core-site.xml") );


// Pass target table name
targetTableName = '''<%=(odiRef.getOption("USE_ORACLE_STAGING_TABLE").equals("1"))?odiRef.getTable("L", "INT_NAME", "W"):odiRef.getTable("L", "TARG_NAME", "A")%>''' //.replaceAll("" + (char)34, "")
conf.set('''oracle.hadoop.hdfs.exttab.tableName''', targetTableName )

// Pass input file dir
dataSetPaths = '''<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH")) { 
%><?=mapredOutputDir?>/*.dat<%} 
%><% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")) { 
%><%=odiRef.getInfo("SRC_JAVA_URL")%><%=odiRef.getInfo("SRC_SCHEMA")%>/<%=odiRef.getSrcTablesList("", "[RES_NAME]", ", ", "")%><%} %>'''
conf.set('''oracle.hadoop.hdfs.exttab.datasetPaths''', dataSetPaths )

logHeader = 	"Invocation parameters: \n\t"+
	"JDBC Connection to ODI logical schema: " + lSchemaName + "\n\t"+
	"oracle.hadoop.hdfs.exttab.tableName: " + targetTableName +  "\n\t"+
	"oracle.hadoop.hdfs.exttab.datasetPaths: " + dataSetPaths +  "\n\n"

// Invoke OSCH Publishing tool
try {
    exTable = new ExternalTable()
    exTable.setConf( conf )
    rc = exTable.run( args, con, out )
} catch ( Exception e ) {
    out.flush()
    throw new RuntimeException( 
	"\n\nError: OCDH publishing tool has thrown Exception: \n"+
	e.getMessage()+"\n"+
	logHeader+
	"Execution log: \n\n" + out.toString() + "\n", e );
}
out.flush()

// Check return code
if (rc != 0) {
    throw new RuntimeException( 
	"\n\nError: OCDH publishing tool has returned RC<>0.\n"+
	logHeader+
	"Execution log: \n\n" + out.toString() + "\n" );
}

<% } else { %>/* -- Skipped, as OLH_OUTPUT_MODE != DP_OSCH|OSCH */
<% } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[571]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5d21df24-4ded-4e50-a85d-1528838a2c00]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[311]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[290]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Report of Publish HDFS data paths]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[17808759-c045-49a7-b837-f88bfe9b1abe]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[571]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( 	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")) { 
%>

throw new RuntimeException( 
	"\n\nThis is no error, just an informational message: \n"+
	logHeader+
	"Execution log of OSCH Publish Call: \n\n" + out.toString() + "\n" 
);


<% } else { %>/* -- Skipped, as OLH_OUTPUT_MODE != DP_OSCH|OSCH */
<% } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[572]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[42b175d8-3237-4188-b10a-f61629484e43]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[312]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert data]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[779a8447-9ae1-4c4e-9d48-4f4f6e78684a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[572]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("USE_ORACLE_STAGING_TABLE").equals("1") ) { %>

insert /*+ append */ into <%=odiRef.getTable("L", "TARG_NAME", "A")%>
(
	<%=odiRef.getColList("", "[COL_NAME]", ",\n\t", "", "((INS or UPD) and !TRG) and REW")%>
)
select 
	<%=odiRef.getColList("", "[COL_NAME]", ",\n\t", "", "((INS or UPD) and !TRG) and REW")%>
from	<%=odiRef.getTable("L", "INT_NAME", "W")%>

<% } else { %>-- Skipped, as USE_ORACLE_STAGING_TABLE = 0<% } %>

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[573]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[bd444360-eea0-47cb-aaf0-0ff33ff00846]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[313]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[310]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop Oracle staging table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5ea89b51-98f4-4b77-8390-34eb3e8ce970]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[573]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( 
	(odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("JDBC") ||
	 odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OCI")
	) && odiRef.getOption("USE_ORACLE_STAGING_TABLE").equals("1") 
) { %>

drop table <%=odiRef.getTable("L", "INT_NAME", "W")%> purge

<% } else { %>

-- Skipped, as OLH_OUTPUT_MODE != JDBC/OCI or USE_ORACLE_STAGING_TABLE=0

<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[574]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b955ee0d-55a5-4cf5-bbf3-2e3e10bce6db]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[314]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[320]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop Oracle Directory]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9cee6404-3d16-4393-b0d5-37254ac50d51]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[574]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( 
	(odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
	odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH"))
	&&
	odiRef.getOption("USE_ORACLE_STAGING_TABLE").equals("1")
) { %>

drop directory ODI_OLH_EXTTAB_DIR_<%=odiRef.getSession("SESS_NO")%>

<% } else { %>

-- Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH

<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[575]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c7b5902a-49ff-4131-bf47-730d2b2a79e6]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[315]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[330]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Clean ext tab dir]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a2231397-3244-42cd-a8b9-21419ad40b16]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[575]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH")) { 
%>OdiOSCommand -OUT_FILE=<?=loaderStdOutFileName?> -ERR_FILE=<?=loaderErrFileName?>
rm '<?=extTabDir?>'/*

<% } else { %>OdiSleep -DELAY=1 <@ /* -- Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH */ @>
<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[576]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a5c9a73a-c3cd-49b9-96e2-cd8a4a348851]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[316]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[340]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete ext tab dir]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3286fbfa-5f00-42f0-922f-3ce6df2ddf05]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[576]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH")) { 
%>OdiOSCommand -OUT_FILE=<?=loaderStdOutFileName?> -ERR_FILE=<?=loaderErrFileName?>
rmdir '<?=extTabDir?>'

<% } else { %>OdiSleep -DELAY=1 <@ /* -- Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH|OSCH */ @>
<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[577]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[95c39d15-e96b-4617-9c63-ee23d508ec6e]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[317]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[350]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete local data files]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4a8d2df1-f486-48e3-be88-ba08ae239b41]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[577]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ) { 
%>OdiFileDelete "-FILE=<?=tempSessionDir?>/*.dat"

<% } else { %>OdiSleep -DELAY=1 <@ /* -- Skipped, as OLH_OUTPUT_MODE != DP_COPY */ @>
<% } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[578]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c20ba548-d815-40e3-bbda-cebd1ab1a142]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[318]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[360]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete local temp dir]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[23f78820-8916-4f91-93f4-1a55d835a063]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[578]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[OdiFileDelete "-DIR=<?=tempSessionDir?>"]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[579]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b058efa3-b066-475d-9904-e2e25905c481]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[319]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[370]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete HDFS data files]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1e10d7ce-3899-447e-993a-b88bfddb2f88]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[579]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_COPY") ||
            odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("DP_OSCH")) { 
%>OdiOSCommand -OUT_FILE=<?=loaderStdOutFileName?> -ERR_FILE=<?=loaderErrFileName?>
$HADOOP_HOME/bin/hadoop fs -rm "<?=mapredOutputDir?>/*.dat"

<% } else { %>OdiSleep "-DELAY=1<@ /* -- Skipped, as OLH_OUTPUT_MODE != DP_COPY|DP_OSCH */ @>"
<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[580]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[70e4a7df-6249-441e-82a7-1993d7483be4]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[320]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[90]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Prepare Hive session]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d9e949a5-3022-4ac9-9d6a-177406abbb94]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[580]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% isODI12cOrLater = !odiRef.getInfo("ODI_MAJOR_VERSION").contains("ODI_MAJOR_VERSION"); %>

<% /* -------- Begin of block ----- Keep this block in sync across all Hive KMs ----------- */ %>
<%

/* Begin of BSh code gen extensions */

out2 = null;
buffer = null;

startCapture() {
    out2 = out;
    buffer = new ByteArrayOutputStream();
    out = new PrintWriter( buffer );
}

endCapture() {
    out.flush();
    out.close();
    captured = buffer.toString();
    out = out2;
    return captured;
}

getQuotedMLString( s ) {
// escape tripple single quotes
// escape backslashes
    return 
        "'''" + 
        s.replace(""+(char)92, ""+(char)92+(char)92)
        .replace( "'''", ""+(char)92+"'"+(char)92+"'"+(char)92+"'") +
        "'''";
}

/* End of BSh code gen extensions */

%>


<% /* Begin of Hive Runtime-API */ %>

import java.lang.System
import java.sql.Statement
import java.sql.Connection
import java.sql.SQLException


class flexUtilHive {
    Statement stmt;
    public Connection con;

    flexUtilHive( Connection pCon ) {
        con = pCon
        if (con == null) 
            throw new RuntimeException( "\nFailure to open JDBC connection. Please test DataServer connection." );


        // Set session parameters for dynamic partitions
        stmt = con.createStatement()
        stmt.execute( """set hive.exec.dynamic.partition=true""" )
        stmt.execute( """set hive.exec.dynamic.partition.mode=nonstrict""" )
        stmt.execute( """set hive.enforce.bucketing=true""" )
        stmt.execute( """set hive.optimize.bucketmapjoin=true""" )
        //stmt.executeQuery( """set mapred.job.reuse.jvm.num.tasks=-1""" )
        // Add custom jars to this Hive session
        String sExtraJars = """<?=(System.getenv("ODI_HIVE_SESSION_JARS")!=null)?System.getenv("ODI_HIVE_SESSION_JARS"):""?>"""
        if (sExtraJars != "") {
            def lstExtraJars = sExtraJars.split( ":" )
            for (j in lstExtraJars) {
                stmt.execute( """add jar """ + j )
            }
        }
    }

    // Function for executing Hive SQL statements
    def executeQuery( String sql ) {
        try {
            stmt.executeUpdate( sql )
        } catch (SQLException re) {
            def msg = "Exception encountered while submitting: \n-------------------\n" + sql + "\n-------------------"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

    // Check if a table already exists
    def tableExists( String schema, String table ) {
        try {
            def dbm = con.getMetaData()
            def rs = dbm.getTables(null, schema.toLowerCase(), table.toLowerCase(), null)
            return rs.next()
        } catch (SQLException re) {
            def msg = "Exception encountered while checking existence of table "+schema+"."+table+" !"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

}

<% /* End of hive Runtime-API */ %>


<%

// Is there already an API defined?
if (IkmHiveApi != void) {

    // Verify correct version and error out, if not
    if (IkmHiveApi.getVersion() != 1) 
        out.print( "<? throw new RuntimeException( \u0022\u0022+(char)10+(char)10+(char)10+\u0022You are using Hive KMs from different versions. Please make sure to use all Hive KMs from the same ODI version/patch.\u0022+(char)10+(char)10+(char)10 );?>");

} else {

/* Begin of IkmHiveApi.java */

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;

import com.sun.org.apache.xpath.internal.Expression;


public class IkmHiveApi {
	public static final String DELIMITER = ""+(char)1;
	public static final String RE_Q = ""+(char)92+"Q";
	public static final String RE_E = ""+(char)92+"E";

	       static final String MISSING_FLEXFIELD_GETCOLLIST = "Exception getColList(";
           static final String MISSING_FLEXFIELD_GETINFO = "Exception getInfo(";
           static final String EXPRESSION_NOT_SUPPORTED = "[EXPRESSION] not supported in getAllTargetColList";
	       static final String DELIMITER_REGEX = RE_Q+ DELIMITER +RE_E;
	public static final String SELECTOR_PARTITION =              "PARTITION";
	public static final String SELECTOR_NOT_PARTITION =          "NOT PARTITION";
    public static final String SELECTOR_PARTITION_COND1 =        "PARTITION AND (UNMAPPED OR TARGET)";
    public static final String SELECTOR_CLUSTER =                "CLUSTER";
	public static final String SELECTOR_PARTITION_OR_CLUSTER =   "PARTITION OR CLUSTER";
    public static final String SELECTOR_SORT =                   "SORT";
           static final String PATTERN_COL_NAME = "[COL_NAME]";
           static final String PATTERN_DEST_CRE_DT = "[DEST_CRE_DT]";
           static final String PATTERN_EXPRESSION = "[EXPRESSION]";
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED =      "[EXPRESSION__NULL_IF_UNMAPPED]";
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET = "[COL_NAME__EXPRESSION_IF_ON_TARGET]";
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET =       "[COL_NAME__NULL_IF_ON_TARGET]";
           static final String PATTERN_MAPPED_ON_TARGET =                  "[MAPPED_ON_TARGET]";
           static final String PATTERN_UNMAPPED =                          "[UNMAPPED]";
           /*static final String PATTERN_COL_NAME_REGEX = RE_Q+ PATTERN_COL_NAME +RE_E;
           static final String PATTERN_DEST_CRE_DT_REGEX = RE_Q+ PATTERN_DEST_CRE_DT +RE_E;
           static final String PATTERN_EXPRESSION_REGEX = RE_Q+ PATTERN_EXPRESSION +RE_E;
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED_REGEX = RE_Q+ PATTERN_EXPRESSION__NULL_IF_UNMAPPED +RE_E;
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET +RE_E;
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__NULL_IF_ON_TARGET +RE_E;
           static final String PATTERN_MAPPED_ON_TARGET_REGEX = RE_Q+ PATTERN_MAPPED_ON_TARGET +RE_E;
           */
	       
           static final String MARKER_SCRIPTNAME = "SNP$SCRIPTNAME";
           static final String MARKER_SCRIPTFULLNAME = "SNP$SCRIPTFULLNAME";
           static final String MARKER_SCRIPT = "SNP$SCRIPTTEXT";
           static final String MARKER_SCRIPTEND = "SNP$SCRIPTTEXTEND";
	
	LinkedHashMap 
	    cols,          // contains all columns (getColList)
	    allTargetCols; // contains all columns including the target columns (getAllTargetColList)
	String buckets;    // contains the number of buckets for this target

	private class ColInfo {
		static final String PROP_TRG = "TRG";
		static final String PROP_UD1 = "UD1";
		static final String PROP_UD2 = "UD2";
		static final String PROP_UD3 = "UD3";
		static final String PROP_FF_PART = "PART";
		static final String PROP_FF_CLUST = "CUST";
		static final String PROP_FF_SORT = "SORT";
		
		String colName, colDt, colExpr;
		boolean bTarget, bUd1, bUd2, bUd3, bFlexPartCol, bFlexClustCol, bFlexSortCol = false;
		
		public ColInfo( String pColName, String pColDt, String pColExpr, boolean pIsPartCol, boolean pIsClustCol, boolean pIsSortCol ) {
			colName = pColName;
			colDt   = pColDt;
			colExpr = pColExpr;
			bFlexPartCol = pIsPartCol;
            bFlexClustCol = pIsClustCol;
            bFlexSortCol = pIsSortCol;
		}
		public void set( String pProperty, boolean v )		{ 
			if      ( pProperty == PROP_TRG ) 	bTarget = v;
			else if ( pProperty == PROP_UD1 ) 	bUd1 = v;
			else if ( pProperty == PROP_UD2 ) 	bUd2 = v;
			else if ( pProperty == PROP_UD3 ) 	bUd3 = v;
			else if ( pProperty == PROP_FF_PART )	bFlexPartCol  = v;
			else if ( pProperty == PROP_FF_CLUST )  bFlexClustCol = v;
			else if ( pProperty == PROP_FF_SORT )	bFlexSortCol  = v;
		};
		public String getColName() { return colName; }
		public String getDataType() { return colDt; }
		public String getExpression() { return colExpr; }
		public boolean isTarget() { return bTarget; }
		public boolean isMapped() { return !colExpr.equals(EXPRESSION_NOT_SUPPORTED) && colExpr.trim().length()>0; };
		public boolean isUd1() { return bUd1; }
		public boolean isUd2() { return bUd2; }
		public boolean isUd3() { return bUd3; }
		public boolean isPartitionBy() { return bFlexPartCol; }
        public boolean isClusterBy() { return bFlexClustCol; }
        public boolean isSortBy() { return bFlexSortCol; }
	}

	// Return the version of the code gen API. 
	// Used for testing that all KMs in a session are using the same API version
	public static int getVersion() {
	    return 1;
	}
	
	public String initMetadata(
	        boolean dumpMetadata,
			String pAllCols,
			String pAllDts,
			String pAllExpr,
			String pTrgCols,
			String pUd1Cols,
			String pUd2Cols,
			String pUd3Cols,
			String pAllPartCols,
			String pAllClustCols,
			String pAllSortCols,
            String pAllTrgCols,
            String pAllTrgDts,
            String pAllTrgPartCols,
            String pAllTrgClustCols,
            String pAllTrgSortCols,
            String pKMOptionBuckets,
            String pFFBuckets
			) {	    
	    if (dumpMetadata) {
	        String pre = ""+(char)34;
	        String post = ""+(char)34+","+(char)10;
	        return 
            "/* inst.initMetadata("+(char)10+
            "false,"+(char)10+
            pre+pAllCols+post+
            pre+pAllDts+post+
            pre+pAllExpr+post+
            pre+pTrgCols+post+
            pre+pUd1Cols+post+
            pre+pUd2Cols+post+
            pre+pUd3Cols+post+
            pre+pAllPartCols+post+
            pre+pAllClustCols+post+
            pre+pAllSortCols+post+
            pre+pAllTrgCols+post+
            pre+pAllTrgDts+post+
            pre+pAllTrgPartCols+post+
            pre+pAllTrgClustCols+post+
            pre+pAllTrgSortCols+post+
            pre+pKMOptionBuckets+post+
            pre+pFFBuckets+(char)34+(char)10+
            "); */";
	    };
	    
        /* TODO: Sort cols still needs to be implemented */
		String[] allCols         = pAllCols.split(DELIMITER_REGEX,-1);
		String[] allDts          = pAllDts.split(DELIMITER_REGEX,-1);
		String[] allExpr         = pAllExpr.split(DELIMITER_REGEX,-1);
		String[] allPartCols     = pAllPartCols.split(DELIMITER_REGEX,-1);
		String[] allClustCols    = pAllClustCols.split(DELIMITER_REGEX,-1);
        String[] allSortCols     = pAllSortCols.split(DELIMITER_REGEX,-1);
        String[] allTrgCols      = pAllTrgCols.split(DELIMITER_REGEX,-1);
        String[] allTrgDts       = pAllTrgDts.split(DELIMITER_REGEX,-1);
        String[] allTrgPartCols  = pAllTrgPartCols.split(DELIMITER_REGEX,-1);
        String[] allTrgClustCols = pAllTrgClustCols.split(DELIMITER_REGEX,-1);
        String[] allTrgSortCols  = pAllTrgSortCols.split(DELIMITER_REGEX,-1);
		
		/* Create all column objects */
        cols = new LinkedHashMap();
	    for(int j=0; j<allCols.length; j++){
	        String  colName    = allCols[j];
	        String  colDt      = allDts[j];
	        String  colExpr    = allExpr[j];
        	boolean isPartCol  = false;
            boolean isClustCol = false; 
            boolean isSortCol  = false; 
	        /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
	           and must be ignored. */
	        if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isPartCol  = (allPartCols[j].equals("0"))? false : true;
	        }
	        if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isClustCol = (allClustCols[j].equals("0"))? false : true; 
	        }
            if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                isSortCol = (allSortCols[j].equals("0"))? false : true; 
            }
	        cols.put(colName, new ColInfo( colName, colDt, colExpr, isPartCol, isClustCol, isSortCol ) );
	    };
	    set( cols, ColInfo.PROP_TRG, pTrgCols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD1, pUd1Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD2, pUd2Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD3, pUd3Cols.split(DELIMITER_REGEX) );

	    /* Create allTargetCols list */
        allTargetCols = new LinkedHashMap();
        for(int j=0; j<allTrgCols.length; j++){
            String  colName    = allTrgCols[j];
            // Does this column already exist in cols ?
            ColInfo colObj = (ColInfo) cols.get( colName );
            if ( colObj != null )
                // then lets copy it
                allTargetCols.put( colName, colObj );
            else {
                // otherwise it's a column without any mapping and we need to create a new ColInfo Object for it
                String  colDt      = allTrgDts[j];
                boolean isPartCol  = false;
                boolean isClustCol = false; 
                boolean isSortCol = false; 
                /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
                   and must be ignored. */
                if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isPartCol  = (allTrgPartCols[j].equals("0"))? false : true;
                }
                if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isClustCol = (allTrgClustCols[j].equals("0"))? false : true; 
                }
                if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isSortCol = (allTrgSortCols[j].equals("0"))? false : true; 
                }
                allTargetCols.put(colName, new ColInfo( colName, colDt, EXPRESSION_NOT_SUPPORTED, isPartCol, isClustCol, isSortCol ) );
            };

        };
        
        /* Process buckets information */
        buckets = "";
        if ( pFFBuckets.length() > 0 && !pFFBuckets.startsWith(MISSING_FLEXFIELD_GETINFO) )
            buckets = pFFBuckets;
        if ( pKMOptionBuckets.length() > 0 )
            buckets = pKMOptionBuckets;
        
        return "";
	}
	
	/**
	 * Set property pField (UD1, UD2 etc) for all columns listed in pCols
	 * @param pAllCols
	 * @param pField
	 * @param pCols
	 */
	static void set( HashMap pAllCols, String pProperty, String[] pCols ){
		/* Check, if pCols just contains a single empty string */
		if ( pCols.length == 1 && pCols[0].length() == 0 ) return;
		/* Loop over all columns and set the respective property */
	    for(int j=0; j<pCols.length; j++){
	        String colName = pCols[j];
	    	ColInfo col = (ColInfo) pAllCols.get( colName );
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) throw new RuntimeException( "IKM Hive Control Append: set(): Internal Error: Cannot find column: " + colName );
	    	col.set( pProperty, true );
	    };			
	}
	
    public String getColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( cols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    public String getAllTargetColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( allTargetCols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    static private String getColList(
            LinkedHashMap cols,
			String pStart,
			String pPattern,
			String pSeparator,
			String pEnd,
			String pSelector) {
		StringBuffer rv = new StringBuffer();
		if ( ! (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) ||
						pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) ||
                        pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_SORT ) )) {
		    String msg = "IKM Hive Control Append: getColList(): invalid selector received: " + pSelector;
			/* Not yet supported in ODI 11.1.1.6.0:
			 * throw new RuntimeException( msg ); 
			 */
			return msg;
    }
        Iterator iter = cols.keySet().iterator();       
        while(iter. hasNext()){
        	String colName = (String) iter.next();
        	ColInfo col = (ColInfo) cols.get( colName );
        	
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) {
	    	    String msg = "IKM Hive Control Append: getColList(): Internal Error: Cannot find column: " + colName;
	    	    /* Not yet supported in ODI 11.1.1.6.0:
	    	     * throw new RuntimeException( msg );
	    	     */
	    	    return msg;
	    	}
	    	    
            /* Does the column match the selector? */
            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) &&          (col.isPartitionBy() && (!col.isMapped() || col.isTarget())) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isPartitionBy() || col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isSortBy()) ) || 
                    (pSelector.toUpperCase().equals( "" )) 
//            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isUd2() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isUd1() || col.isUd2() || col.isPartitionBy() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isUd3() || col.isSortBy()) ) || 
//                    (pSelector.toUpperCase().equals( "" )) 
        	) {
        		String s = pPattern;
        		/* Replace all patterns with their respective values */
        		s = s.replace( PATTERN_COL_NAME, col.getColName() );
        		s = s.replace( PATTERN_DEST_CRE_DT, col.getDataType() );
                s = s.replace( PATTERN_EXPRESSION, col.getExpression() );
                /* Handle EXPRESSION__NULL_IF_UNMAPPED_REGEX */
        		if (col.getExpression().equals(EXPRESSION_NOT_SUPPORTED)) {
        		    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, "cast(null as "+col.getDataType()+")" );
        		    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
        		} else {
                    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, col.getExpression() );        		    
        		}
                /* Handle MAPPED_ON_TARGET */
                s = s.replace( PATTERN_MAPPED_ON_TARGET, (col.isTarget())?"1":"0" );
                
                /* Handle UNMAPPED */
                s = s.replace( PATTERN_UNMAPPED, (!col.isMapped())?"1":"0" );
                
                /* Handle COL_NAME__EXPRESSION_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET, 
                        (col.isTarget())?col.getExpression():
                            ((!col.isMapped())?
                                    "cast(null as "+col.getDataType()+")":
                                    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                                    col.getColName())
                );
        		
                /* Handle COL_NAME__NULL_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__NULL_IF_ON_TARGET, 
                        (col.isTarget() || !col.isMapped())?
                            "cast(null as "+col.getDataType()+")" :
                            /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                            col.getColName()
                );
                
                /* Add separator for second and later columns */
        		if ( rv.length() > 0 )
        		  rv.append(pSeparator);
        		rv.append( s );

        	}
        }
		/* if any columns selected, insert/append pStart/pEnd */ 
		if (rv.length() > 0) {
			rv.insert(0, pStart);
			rv.append( pEnd );
		};
		/* return buffer after unescaping control characters */
		return rv.toString()
			.replaceAll( ""+(char)92+"Q"+(char)92+"n"+(char)92+"E", ""+(char)10 )
			.replaceAll( ""+(char)92+"Q"+(char)92+"t"+(char)92+"E", ""+(char)9 );
	}
    
    public String getBuckets(
            String pBefore,
            String pAfter) {
        /* Does this target have any cluster by columns ? */
        boolean isTargetClustered = (getAllTargetColList("","X","","",SELECTOR_CLUSTER).length()>0);
        return isTargetClustered ? (pBefore + buckets + pAfter) : "";
    }
    
    public static List getScriptInfo( String getFrom ) {
        String s = getFrom;
        List lst = new ArrayList();
        while ( s.indexOf( MARKER_SCRIPTNAME ) > -1 ) {
            int beginName     = s.indexOf( MARKER_SCRIPTNAME );
            int endName       = s.indexOf( MARKER_SCRIPTFULLNAME);
            int beginFullName = endName + MARKER_SCRIPTFULLNAME.length();
            int endFullName   = s.indexOf( MARKER_SCRIPT );
            int beginScript   = endFullName + MARKER_SCRIPT.length();
            int endScript     = s.indexOf( MARKER_SCRIPTEND );
            lst.add( new String[] {s.substring(beginName + MARKER_SCRIPTNAME.length(), endName), 
                                   s.substring(beginFullName, endFullName), 
                                   s.substring(beginScript, endScript)} );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return lst;
    }
    
    public static String removeScriptInfo( String getFrom ) {
        String s = getFrom;
        while ( s.indexOf( MARKER_SCRIPT ) > -1 ) {
            int beginName = s.indexOf( MARKER_SCRIPTNAME );
            int endScript = s.indexOf( MARKER_SCRIPTEND );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return s;
    }
        
	/**
	 * Some test stub
	 */
	public static void main(String[] args) {
	    
		/* getColList: Test for a permanent interface */
		IkmHiveApi inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"", 
				"", 
				"", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "",
                "4"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
		System.out.println();
		System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println("------------------------------"); 

		/* getColList: Test for a temporary interface */
		inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"sales_pers_id", 
				"sales_pers_id", 
				"sales_last_name", 
				"Exception getColList(...)", 
				"Exception getColList(...)", 
				"Exception getColList(...)",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "Exception getColList(...)", 
                "Exception getColList(...)", 
                "Exception getColList(...)",
                "4",
                "Exception getInfo(...)"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println("------------------------------"); 
        
        /* my test case */
        inst = new IkmHiveApi();
        inst.initMetadata(
                false,
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CUSTID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.LAST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.FIRST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.AGE$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CITY_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.SALES_PERS_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.DEAR$$SUNOPSIS$$1$$SUNOPSIS$$CUS.ADDRESS$$SUNOPSIS$$1$$SUNOPSIS$$CUS.PHONE",
                "",
                "",
                "dear",
                "",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "",
                "4"
                );
        System.out.println( inst.getColList("partition by (", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", ")", "PARTITION") );
        System.out.println( inst.getAllTargetColList("partition or cluster by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "PARTITION OR CLUSTER") );
        System.out.println( inst.getAllTargetColList("not partition by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "NOT PARTITION") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println( inst.getAllTargetColList("sort by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "SORT") );
        System.out.println("------------------------------"); 

        String getFrom = "select c1, c2, c3 from ( select c4, c5, c6 from (T1" + MARKER_SCRIPTNAME + "trafo1.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo1.pl" + MARKER_SCRIPT + "my script 1" + MARKER_SCRIPTEND + ") ODI_FROM, T2" +
                         MARKER_SCRIPTNAME + "trafo2.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo2.pl" + MARKER_SCRIPT + "my script 2" + MARKER_SCRIPTEND + ")";
        Iterator iter = getScriptInfo(getFrom).iterator();
        /* List scripts */
        while (iter.hasNext()) {
            String[] script = (String[])iter.next();
            System.out.println( script[0] + " : " + script[1] + " : " + script[2] ); 
        }
        System.out.println("------------------------------"); 
        System.out.println( removeScriptInfo(getFrom) ); 
        System.out.println("------------------------------"); 

	}

}

/* End of IkmHiveApi.java */

};

%>
<% /* -------- End of block ----- Keep this block in sync across all Hive KMs ----------- */ %>


<% if (odiRef.getInfo("SRC_TECHNO_NAME").toUpperCase().equals("HIVE")) { %>

hive = new flexUtilHive( odiRef.getJDBCConnection("SRC") )

<%} else {%>
dummy=1;  // Dummy to avoid class instantiation for non-Hive sources (FILE sources)
<%};%>











<?
// Code for handling data type formats

package com.oracle.odi.km.ext;

public class FormatTranslator {
	// Java Date Formatting information available at http://java.sun.com/j2se/1.4.2/docs/api/java/text/SimpleDateFormat.html
	// Oracle Date Formatting information available in Oracle SQL Language Reference: Chapter "Basic Elements fo Oracle SQL": DateTime Format Elements
	
	static String[][] transTableDate = {
	    {"y",		"Y"},	// Year, supported:  yyyy;yy => 1996;96
	    {"MMMM(M)*",	"month"},	// Month, supported: MMMM => July
	    {"MMM",		"mon"},	// Month, supported: MMM => JUL
	    {"M",		"M"},	// Month, supported: MM;M => 07;7
	    {"month",		"MONTH"},	// (auxiliary)
	    {"mon",		"MON"},	// (auxiliary)
	    {"W",		"W"},	// Week in month
	    {"w",		"WW"},	// Week in year 
	    {"DDD",		"DDD"},	// Day in year 
	    {"dd",		"DD"},	// Day in month
	    {"a",		"AM"},	// Am/pm marker 
	    {"HH",		"HH24"},	// Hour in day (0-23)
	    {"KK",		"HH12"},	// Hour in day (0-11)
	    {"mm",		"MI"},	// Minute in hour 
	    {"SSSSSS",	"FF6"},	// Millisecond in second 
	    {"SSSSS",		"FF5"},	// Millisecond in second 
	    {"SSSS",		"FF4"},	// Millisecond in second 
	    {"SSS",		"FF3"},	// Millisecond in second 
	    {"SS",		"FF2"},	// Millisecond in second 
	    {"S",		"FF1"},	// Millisecond in second 
	    {"ss",		"SS"},	// Second in minute 
	    {"Z",		"TZH:TZM"}	// Timezone, supported: Z => +02:00
	};
	
	public static String translate(String srcDT, String colFormat) throws Exception {
		String format = "";
		
		if (colFormat.trim().length()==0) 
			/* we use Oracle's default format */
			format = "";
		else {
			// Is source column a date?
			if ( srcDT.toUpperCase().equals( "DATE") ) {
				format = colFormat;
				for (int i = 0; i < transTableDate.length; i++)
					format = format.replaceAll( transTableDate[i][0], transTableDate[i][1] );
			} else 
			// Is source column a numeric? For now, no translation for Numerics
			if ( srcDT.toUpperCase().equals( "NUMERIC")) {
				format = "";
			} else 
			// Is source column anything else than a string?
			if ( !srcDT.toUpperCase().equals( "STRING" )) 
				throw new Exception("No format translation defined for data type "+srcDT+"!"); 
		};
		if ( format.length() > 0 )
			format = format;
		return format;
	}

}

public class extTabColFormat {
	public static boolean	useView = false;
	public static String	nlsDateLanguage = ""; 
	public static boolean	enforceNlsNumChars = false; 
	public static String	nlsNumChars = "";

	public static setUseView( boolean b ) { useView = b; }
	public static boolean getUseView() { return useView; }

	// Does the java format expression contain any language specific elements?
	public static boolean requiresView( String dataType, String colFormat ) {
		if (dataType.equals("DATE")) {
			// Does the date contain a lanaguage specific element?
			return (colFormat.indexOf("MMM")>-1 || colFormat.indexOf("a")>-1 );
		} else if (dataType.equals("NUMERIC")) {
			// Do we need to enforce numeric characters or does the pattern contain a grouping character?
			return enforceNlsNumChars;
		} else
			return false;
	}

	public static String getExtTabFormat( String colName, srcDataType, destWriDataType, colFormat, colBytes, colLongC, colScale ) { return calcFormat( colName, srcDataType, destWriDataType, colFormat, colBytes, colLongC, colScale )[0]; }
	public static String getExtTabDataType( String colName, srcDataType, destWriDataType, colFormat, colBytes, colLongC, colScale ) { return calcFormat( colName, srcDataType, destWriDataType, colFormat, colBytes, colLongC, colScale )[1]; }
	public static String getViewExpression( String colName, srcDataType, destWriDataType, colFormat, colBytes, colLongC, colScale ) { return calcFormat( colName, srcDataType, destWriDataType, colFormat, colBytes, colLongC, colScale )[2]; }

	private static String[] calcFormat( String colName, srcDataType, destWriDataType, colFormat, colBytes, colLongC, colScale ) { 
		String oracleDataFormat = FormatTranslator.translate( srcDataType, colFormat );
		String extTabFormat = "";
		String extTabDataType = "";
		String viewExpr = "";
		int len;
		if (colBytes.equals("")) 
			{ len = 0;}
		else
			{ len = Integer.parseInt( colBytes );}

		// Is the source column a DATE?
		if ("DATE".equals(srcDataType)) { 
			// How many digits are there for milliseconds?
			int precision = colFormat.replaceAll("[^S]","").length();
			// Does the source column contain a timezone?
			if (colFormat.indexOf("Z")>-1) {
				dataType = "TIMESTAMP WITH TIMEZONE";
				dataConvFunc = "TO_TIMESTAMP_TZ";
			// Does the source column contain milliseconds?
			} else {
				dataType = "TIMESTAMP";
				dataConvFunc = "TO_TIMESTAMP"; 
			};
			// Does the source column contain a language specifc element?
			if (requiresView( srcDataType, colFormat )) {
				// Explicit conversion function required
				extTabFormat = "CHAR("+len.toString()+")";
				extTabDataType = extTabFormat;
				viewExpr = dataConvFunc+"("+colName+", '"+oracleDataFormat+"'";
				if (nlsDateLanguage.length()>0)
					viewExpr += ", '"+nlsDateLanguage+"'";
				viewExpr += ")";
			} else {
				// Is there an COL_FORMAT defined for this column?
				if (colFormat.length()>0) {
					// Implicit conversion by date_format clause
					extTabFormat = "CHAR("+len.toString()+") DATE_FORMAT "+dataType+" MASK "+(char)34+oracleDataFormat+(char)34;
					extTabDataType = destWriDataType;
					viewExpr = colName;
				} else {
					// No conversion specified. Use default format defined by database nls settings
					extTabFormat = "";
					extTabDataType = destWriDataType;
					viewExpr = colName;
				};
			};
		} else

		// Is the source column a NUMERIC?
		if ("NUMERIC".equals(srcDataType)) {
			// Do we need to enforce NLS settings for numbers?
			if (requiresView(srcDataType, colFormat)) {
				extTabFormat = "CHAR("+len.toString()+")";
				extTabDataType = "VARCHAR("+len.toString()+")";

				int longc = new Integer( colLongC ).intValue();
				int scale = new Integer( colScale ).intValue();
				// Build a number format according to precision and scale
				digitsInFront = longc - ((scale==0)?0:(scale+1));
				digitsBehind = scale;
				if (digitsInFront < 0)
					throw new Exception("Column " + colName +": Scale > Precision is not supported! Please correct precision/scale!"); 
				viewExpr = "TO_NUMBER("+colName+", '";
				viewExpr += "99999999999999999999999999999999999999".substring(0,digitsInFront);
				if (digitsBehind>0) {
					viewExpr += "D";
					viewExpr += "99999999999999999999999999999999999999".substring(0,digitsBehind);
				};
				viewExpr += "', '"+nlsNumChars+"')";
			} else {
				extTabFormat = "";
				extTabDataType = destWriDataType;
				viewExpr = colName;
			};
		} else {

		// The source column is a STRING => no options to add
			extTabFormat = "";
			extTabDataType = destWriDataType;
			viewExpr = colName;
		};

		return new String[] {extTabFormat, extTabDataType, viewExpr};
 	}

}
?>


<%
removeDQ( String s ) {
	return s.replaceAll( ""+(char)34, "").replaceAll( "<dq>", ""+(char)92+(char)92+"u0022");
}
%>
<?
removeDQ( String s ) {
	return s.replaceAll( ""+(char)34, "").replaceAll( "<dq>", ""+(char)92+(char)92+"u0022");
}
?>
<%
escapeDQ( String s ) {
	return s.replaceAll( ""+(char)34, ""+(char)92+(char)92+"u0022+(char)92+(char)34+"+(char)92+(char)92+"u0022" ).replaceAll( "<dq>", ""+(char)92+(char)92+"u0022");
}
%>



<?
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

public class CxColNameFinder {
	HashMap expressions = new HashMap();
	
	public void addExpression( String cxColName, String expression) {
		expressions.put(cxColName, expression);
	}
	public String getCxColName( String srcColName ) {
		Iterator it = expressions.entrySet().iterator();
		while (it.hasNext()) {
			Map.Entry expression = (Map.Entry)it.next();
			if (((String) expression.getValue()).contains(srcColName)) 
				return (String) expression.getKey();
		}
		return "<No expression found for srcColName="+srcColName+">";
	}
	
	public static void main( String[] args ) {
		System.out.println( "Hello!");
		CxColNameFinder r = new CxColNameFinder();
		r.addExpression("TRG3", "SRC.COL1");
		r.addExpression("TRG2", "SRC.COL2");
		r.addExpression("TRG1", "SRC.COL3");
		System.out.println( "Target for COL1 is: " + r.getCxColName("COL2"));
		
	}
}
?>

<%=removeDQ(odiRef.getColList(  /* Initialize Replacer */
	"<? r = new CxColNameFinder(); ?>",
	"<? r.addExpression(<dq>[COL_NAME]<dq>, <dq>[EXPRESSION]<dq>); ?>",
	"\n","", "INS OR UPD" ) ) 
%>



<?
// Validate KM option value for OLH_OUTPUT_MODE
if ( !("<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("JDBC") ||
        "<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("OCI") ||
        "<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("DP_COPY") ||
        "<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("DP_OSCH") ||
        "<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("OSCH") )
    ) {
    throw new RuntimeException( ""+(char)10+(char)10+"Invalid KM option value for OLH_OUTPUT_MODE: '<%=odiRef.getOption("OLH_OUTPUT_MODE")%>'. See KM option description for permitted values."+(char)10+(char)10 );
};
?>

<?
// Validate KM option value for OLH_OUTPUT_MODE
if (  ("<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("DP_COPY") ||
        "<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("DP_OSCH") ||
        "<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("OSCH" ))
        && ("<%=odiRef.getOption("EXT_TAB_DIR_LOCATION")%>".equals("<Please specify external table file location>"))
    ) {
    throw new RuntimeException( ""+(char)10+(char)10+"Required KM option EXT_TAB_DIR_LOCATION has not been set. See KM option description for more details."+(char)10+(char)10 );
};
?>

<?
// Validate some settings for OLH_OUTPUT_MODE = OSCH
if ("<%=odiRef.getOption("OLH_OUTPUT_MODE")%>".equals("OSCH") ) {
    if ( !("<%=odiRef.getInfo("SRC_TECHNO_NAME")%>".toUpperCase().equals("FILE")) ) {
        throw new RuntimeException( ""+(char)10+(char)10+"OLH_OUTPUT_MODE = OSCH only supports FILE data sources."+(char)10+(char)10 ); 
    };
    if ( <%=odiRef.getOption("EXTRA_OLH_CONF_PROPERTIES").length()%> > 0 ) {
        throw new RuntimeException( ""+(char)10+(char)10+"OLH_OUTPUT_MODE = OSCH does not support any EXTRA_OLH_CONF_PROPERTIES."+(char)10+(char)10 ); 
    };
    if ( <%=odiRef.getOption("OVERRIDE_INPUTFORMAT").length()%> >0 ) {
        throw new RuntimeException( ""+(char)10+(char)10+"OLH_OUTPUT_MODE = OSCH does not support any OVERRIDE_INPUTFORMAT."+(char)10+(char)10 );
    };
};
?>

<% /* Make sure we do not get any dollar signs into our Oracle staging table, as this causes file name issues in case the staging table is an external table */
odiRef.setTableName("INT_SHORT_NAME", "I_" + odiRef.getTableName("INT_SHORT_NAME").replace("%INT_PRF","")); %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[581]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[33137e28-c63d-4a01-b591-7c10ebba5f35]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[321]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[100]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create target table ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7c1f5925-2a48-4345-8a22-5a5a73481fdf]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[581]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[create table <%=odiRef.getTable("L", "TARG_NAME", "A")%>
(
	<%=odiRef.getTargetColList("", "[COL_NAME]\t[DEST_CRE_DT] NULL", ",\n\t", "")%>
)]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[582]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[20aefed3-2a2b-4bff-adf1-e7d9ced846ec]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[322]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[120]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete target table ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1e9cc554-f138-4d69-8cb7-d123a50a5360]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[582]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[delete <%=odiRef.getTable("L", "TARG_NAME", "A")%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[583]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[83ad68a8-9b22-426e-a72d-5ede3e429cc8]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[323]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[130]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Write Loader Config File ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2a545cd5-2b42-4d9e-8c69-041d68d578ab]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[583]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% isODI12cOrLater = true; 
%><? 
	import java.io.File;
	import java.lang.System;
	tempPath = <%=odiRef.getQuotedString( odiRef.getOption("TEMP_DIR") )%>;
	tempPath = (tempPath.length()==0) ? System.getProperty("java.io.tmpdir") : tempPath;
        <% if (isODI12cOrLater) { %>
	tempSessionDir = (new File( tempPath, "odi_"+odiRef.getSession("SESS_GUID")+"_"+odiRef.getStep( "NNO" )+"_"+ odiRef.getSession("CONTEXT_CODE") ) ).toString();
	<% } else { %>
	tempSessionDir = (new File( tempPath, "odi_"+odiRef.getSession("SESS_NO")+"_"+odiRef.getStep( "NNO" )+"_"+ odiRef.getSession("CONTEXT_CODE") ) ).toString();
	<% } %>
	tempPath = tempSessionDir;
	loaderStdOutFileName =  (new File( tempPath, "odi.out")).toString();
	loaderErrFileName =  (new File( tempPath, "odi.err")).toString();
	confFileNameLocal = (new File( tempPath, "odi.conf.xml")).toString();
	mapFileNameLocal = (new File( tempPath, "odi.map.xml")).toString();

	// Validate KM option value for EXT_TAB_DIR_LOCATION
	if ( <%=odiRef.getQuotedString(odiRef.getOption("OLH_OUTPUT_MODE"))%>.equals("DP_COPY") &&
	      <%=odiRef.getQuotedString(odiRef.getOption("EXT_TAB_DIR_LOCATION"))%>.equals("<Please specify external table file location>")
	    ) {
	    throw new RuntimeException( ""+(char)10+(char)10+"Required KM option value for EXT_TAB_DIR_LOCATION is missing. See KM option description for details."+(char)10+(char)10 );
	};
	extTabDir = <%=odiRef.getQuotedString( odiRef.getOption("EXT_TAB_DIR_LOCATION") )%>;

	<% if (isODI12cOrLater) { %>
	mapredOutputDir = (new File( "<%=odiRef.getOption("MAPRED_OUTPUT_BASE_DIR")%>", "odi_"+odiRef.getSession("SESS_GUID")+"_"+odiRef.getStep( "NNO" )+"_"+ odiRef.getSession("CONTEXT_CODE"))).toString();
	<% } else { %>
	mapredOutputDir = (new File( "<%=odiRef.getOption("MAPRED_OUTPUT_BASE_DIR")%>", "odi_"+odiRef.getSession("SESS_NO")+"_"+odiRef.getStep( "NNO" )+"_"+ odiRef.getSession("CONTEXT_CODE"))).toString();
	<% } %>
        
        odiOlhFiles = System.getenv("ODI_OLH_FILES");
	if (odiOlhFiles == null) { odiOlhFiles = ""; } else {
        odiOlhFiles = "-files " + odiOlhFiles; };
	
	odiOlhJars = System.getenv("ODI_OLH_JARS");
	if (odiOlhJars == null) { odiOlhJars = ""; /* throw new RuntimeException( ""+(char)10+(char)10+(char)10+"Required unix environment variable ODI_OLH_JARS is undefined!"+(char)10+(char)10+(char)10); */ } else {
	odiOlhJars = "-libjars " + odiOlhJars; };
        
        // Deprecated OLH option, only kept for backwards compatibility for now
	odiOlhSharedLibs = System.getenv("ODI_OLH_SHAREDLIBS");
	if (odiOlhSharedLibs == null) { odiOlhSharedLibs=""; /* throw new RuntimeException( ""+(char)10+(char)10+(char)10+"Required unix environment variable ODI_OLH_SHAREDLIBS is undefined!"+(char)10+(char)10+(char)10); */ } else {
	odiOlhSharedLibs = "-D oracle.hadoop.loader.sharedLibs=" + odiOlhSharedLibs; };


?><% if ( !odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH") ) { 

%>OdiOutFile "-FILE=<?=confFileNameLocal?>"
<<$$>?xml version="1.0" encoding="UTF-8"?<$$>>
<configuration>
	<property>
		<name>oracle.hadoop.loader.jobName</name>
		<% if (isODI12cOrLater) { %>
		<value>OLH job for ODI Session <%=odiRef.getStep("SESS_GUID")%> Step <%=odiRef.getStep("NNO")%></value>
		<% } else { %>
		<value>OLH job for ODI Session <%=odiRef.getStep("SESS_NO")%> Step <%=odiRef.getStep("NNO")%></value>
		<% } %>
                <description> A Hadoop job name for this Oracle loader job. Used as input for the Job.setJobName() method. </description>
	</property>

<!-- =================== -->
<!-- InputFormat Section -->
<!-- =================== -->
<% if (odiRef.getOption("OVERRIDE_INPUTFORMAT").length()>0) { %>
	<property>
		<name>mapreduce.inputformat.class</name>
		<value><%=odiRef.getOption("OVERRIDE_INPUTFORMAT")%></value>
		<description> Name of the class implementing InputFormat </description>
	</property>
	<property>
		<name>mapred.input.dir</name>
		<value><%=odiRef.getInfo("SRC_SCHEMA")%>/<%=odiRef.getSrcTablesList("", "[RES_NAME]", ", ", "")%></value>
	</property>
	<property>
		<name>oracle.hadoop.loader.input.fieldNames</name>
		<value><%=odiRef.getSrcColList("", "[COL_NAME]", "[COL_NAME]", ",", "").toUpperCase()%></value>
		<description> optional list of column names </description>
	</property>

<% } else if (odiRef.getInfo("SRC_TECHNO_NAME").toUpperCase().equals("HIVE")) { %>
	<property>
		<name>mapreduce.inputformat.class</name>
		<value>oracle.hadoop.loader.lib.input.HiveToAvroInputFormat</value>
		<description> Name of the class implementing InputFormat </description>
	</property>
	<property>
		<name>oracle.hadoop.loader.input.hive.databaseName</name>
		<value><%=odiRef.getInfo("SRC_WORK_SCHEMA")%></value>
		<description> Hive database name </description>
	</property>
	<property>
		<name>oracle.hadoop.loader.input.hive.tableName</name>
		<value><% if (odiRef.getOption("USE_HIVE_STAGING_TABLE").equals("1")) { 
		%><?=odiRef.getObjectName("L", "<%=odiRef.getTableName("INT_SHORT_NAME")%>", "W").replace(odiRef.getInfo("SRC_WORK_SCHEMA")+".", "")?><%}
		else {
		%><%=odiRef.getSrcTablesList("", "[RES_NAME]", ", ", "")%><%
		}%></value>
		<description> Name of the Hive source table </description>
	</property>
	<property>
		<name>hive.metastore.uris</name>
		<value><% if (isODI12cOrLater) {
		%><?=odiRef.getFlexFieldValue( odiRef.getInfo("SRC_CONNECT_GUID"), "1400", "HIVE_METASTORE_URIS" )?><%}
		else {
		%><?=odiRef.getFlexFieldValue( odiRef.getInfo("SRC_I_CONNECT"), "1400", "HIVE_METASTORE_URIS" )?><%}
		%></value>
		<description> List of all URIs for the Hive metastore </description>
	</property>
	<property>
		<name>hive.metastore.local</name>
		<value>false</value>
		<description> Using an embedded metastore? </description>
	</property>

<% } else if (odiRef.getInfo("SRC_TECHNO_NAME").toUpperCase().equals("FILE")) { %>

<% 
/* Stop, if the source file is not of type delimited */
/* if (!odiRef.getSrcTablesList("", "[FILE_FORMAT]", "", "").equals("D")) { %><? throw new RuntimeException(""+(char)10+(char)10+(char)10+"Only delimited source files supported."+(char)10+(char)10+(char)10); ?>
<% }; */ %>
<% 
/* Stop, if we have more than one source datastore */
if (odiRef.getSrcTablesList("", "X", "", "").length() > 1) { %><? throw new RuntimeException(""+(char)10+(char)10+(char)10+"Only a single file supported as source."+(char)10+(char)10+(char)10); ?>
<% }; %>

	<property>
		<name>mapred.input.dir</name>
		<value><%=odiRef.getInfo("SRC_SCHEMA")%>/<%=odiRef.getSrcTablesList("", "[RES_NAME]", ", ", "")%></value>
	</property>
	<property>
		<name>mapreduce.inputformat.class</name>
		<value><% if (odiRef.getSrcTablesList("", "[FILE_FORMAT]", "", "").equals("D")) { 
		/* InputFormat for delimited files: */ %>oracle.hadoop.loader.lib.input.DelimitedTextInputFormat<% } else {
		/* InputFormat for fixed len files: */ %>oracle.hadoop.loader.lib.input.RegexInputFormat<%}%></value>
		<description> Name of the class implementing InputFormat </description>
	</property>
	<property>
		<name>oracle.hadoop.loader.input.fieldNames</name>
		<value><%=odiRef.getSrcColList("", "[COL_NAME]", "[COL_NAME]", ",", "").toUpperCase()%></value>
		<description> optional list of column names </description>
	</property>
<% /* Properties for delimited files: */ if (odiRef.getSrcTablesList("", "[FILE_FORMAT]", "", "").equals("D")) { %>
	<property>
		<name>oracle.hadoop.loader.input.fieldTerminator</name>
		<value><%=odiRef.getSrcTablesList("", "[FILE_SEP_FIELD]", "", "")%></value>
		<description> column separator </description>
	</property>
	<property>
		<name>oracle.hadoop.loader.input.initialFieldEncloser</name>
		<value><%=odiRef.getSrcTablesList("", "[FILE_ENC_FIELD]", "", "")%></value>
		<description> start string delimiter </description>
	</property>
	<property>
		<name>oracle.hadoop.loader.input.trailingFieldEncloser</name>
		<value><%=odiRef.getSrcTablesList("", "[FILE_ENC_FIELD]", "", "")%></value>
		<description> end string delimiter </description>
	</property>

<% } else { /* Properties for fixed len files: */%>
	<property>
		<name>oracle.hadoop.loader.input.regexPattern</name>
		<value><%=odiRef.getSrcColList("", "(.{[BYTES]})", "(.{[BYTES]})", "", "")%></value>
		<description> column separator </description>
	</property>
 	<property>
		<name>oracle.hadoop.loader.input.regexCaseInsensitive</name>
		<value>false</value>
		<description>
			Directs the pattern matching to be case insensitive.
			Same as org.apache.hadoop.hive.contrib.serde2.RegexSerDe's
			"input.regex.case.insensitive" property.
		</description>
	</property>
<%}%>

<% } else  

/* Unsupported source technology */
{ %><? throw new RuntimeException(""+(char)10+(char)10+(char)10+"Unsupported source technology used! Only Hive and File are supported."+(char)10+(char)10+(char)10); ?>
<% }; %>

 	<property>
		<name>oracle.hadoop.loader.rejectLimit</name>
		<value><%=(odiRef.getOption("REJECT_LIMIT").equals("UNLIMITED"))?"-1":odiRef.getOption("REJECT_LIMIT")%></value>
	</property>

<!-- =================== -->
<!-- OutputFormat Section -->
<!-- =================== -->
<% if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("JDBC") ) { %>
	<property>
		<name>mapreduce.outputformat.class</name>
		<value>oracle.hadoop.loader.lib.output.JDBCOutputFormat</value>
		<description> Output mode after the loader job executes on Hadoop </description>
	</property>

<% } else 
 if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OCI") ) { %>
	<property>
		<name>mapreduce.outputformat.class</name>
		<value>oracle.hadoop.loader.lib.output.OCIOutputFormat</value>
		<description> Output mode after the loader job executes on Hadoop </description>
	</property>
<% } else 

/* Invalid output mode */
 if ( odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().startsWith("DP") ) { %>
	<property>
		<name>mapreduce.outputformat.class</name>
		<value>oracle.hadoop.loader.lib.output.DataPumpOutputFormat</value>
		<description> Output mode after the loader job executes on Hadoop </description>
	</property>
<% } 

 else { %><? throw new RuntimeException(""+(char)10+(char)10+(char)10+"Invalid value for KM option OLH_OUTPUT_MODE received: >>><%=odiRef.getOption("OLH_OUTPUT_MODE")%><<<. Please see KM option definition for permitted values."+(char)10+(char)10+(char)10); ?>

<% }; 


/* Common section continued */ %>
	<property>
		<name>mapred.output.dir</name>
		<value><?=mapredOutputDir?></value>
	</property>
	<property>
		<name>oracle.hadoop.loader.loaderMapFile</name>
		<value>file://<?=mapFileNameLocal?></value>
		<description> The loaderMap file specifying the mapping of input data fields to the table columns </description>
	</property>
	<property>
		<name>oracle.hadoop.loader.connection.user</name>
		<value><%=odiRef.getInfo("DEST_USER_NAME")%></value>
		<description> Name of the user connecting to the database</description>
	</property>
	<property>
		<name>oracle.hadoop.loader.connection.password</name>
		<value><%=odiRef.getInfo("DEST_PASS")%></value>
		<description> Password of the user connecting to the database</description>
	</property>
	<property>
		<name>oracle.hadoop.loader.connection.url</name>
		<value><%=odiRef.getInfo("DEST_JAVA_URL")%></value>
		<description> Database connection string </description>
	</property>

<% if (odiRef.getOption( "EXTRA_OLH_CONF_PROPERTIES" ).length() > 0) {%>
<!-- =================== -->
<!-- Custom Properties                         -->
<!-- =================== -->
<%=odiRef.getOption( "EXTRA_OLH_CONF_PROPERTIES" )%>
<%}%>
</configuration>

<% } else { 

%>OdiMkDir -DIR=<?=tempPath?>

<% /* Skipped, as OLH_OUTPUT_MODE == OSCH, we just need to make sure that the temp dir is created */ 
} %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[584]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ba2d89d8-895c-4e46-b521-f2d98b5e203b]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[324]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[140]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Write Loader Map File]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1aecfde1-d3f3-467a-b21c-d63a30276e73]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[584]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( !odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OSCH") ) { 

%>OdiOutFile "-FILE=<?=mapFileNameLocal?>" <?

String olhOutputMode = "<%=odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase()%>";
boolean useOracleStagingTable = (<%=odiRef.getOption("USE_ORACLE_STAGING_TABLE")%>==1);
String olhTargetSchema;
String olhTargetTable;

/* Determine OLH target table/schema names */
if ( olhOutputMode.equals("JDBC") || olhOutputMode.equals("OCI")) {
    if (useOracleStagingTable) {
        olhTargetSchema = odiRef.getInfo("DEST_WORK_SCHEMA");
        olhTargetTable = odiRef.getObjectName("L", "<%=odiRef.getTableName("INT_SHORT_NAME")%>", "W").replace(odiRef.getInfo("DEST_WORK_SCHEMA")+".", "");
    } else {
        olhTargetSchema = odiRef.getInfo("DEST_SCHEMA");
        // Please note that odiRef.getTargetTable("RES_NAME") cannot be used, as it does not handle double-quoting
        olhTargetTable = odiRef.getObjectName("L", "<%=odiRef.getTargetTable("RES_NAME")%>", "D").replace(odiRef.getInfo("DEST_SCHEMA")+".", "");
    };
} else { /* for DP_COPY, DP_OSCH */
    if (useOracleStagingTable) {
        // Even though the data will be physically loaded into the I$ table, 
        // OLH needs to get the table metadata from the target table, as 
        // the I$ table will be created later as an external table.
        olhTargetSchema = odiRef.getInfo("DEST_SCHEMA");
        olhTargetTable = odiRef.getObjectName("L", "<%=odiRef.getTargetTable("RES_NAME")%>", "D").replace(odiRef.getInfo("DEST_SCHEMA")+".", "");
    } else {
        throw new RuntimeException(""+(char)10+(char)10+(char)10+"Output modes DP_COPY and DP_OSCH cannot be used with USE_ORACLE_STAGING=0."+(char)10+(char)10+(char)10);
    };
};


// Build list of expressions

findCxColName( String srcColName) {
    String popTabAlias = <%=odiRef.getQuotedString(odiRef.getSrcTablesList("", "[POP_TAB_ALIAS]", "", "")).toUpperCase()%>;
    if (1==0) { dummy=0;
    } <%=odiRef.getColList("", 
		"else if ( \u0022[EXPRESSION]\u0022.contains( popTabAlias + \u0022.\u0022 + srcColName )) {\n         return \u0022[CX_COL_NAME]\u0022; }",
		"\n    ", "" )%>
    else {
        return "Unmapped column found: " + srcColName;
    };
}

getSrcColFormat( String expr ) {
    if (1==0) { dummy=0;
    } <%=odiRef.getSrcColList("", 
		"else if ( expr.trim().equals( \u0022[POP_ALIAS].[COL_NAME]\u0022) ) {\n         return (\u0022[COL_FORMAT]\u0022.trim().length()>0)?\u0022 format=\u0022+(char)34+\u0022[COL_FORMAT]\u0022+(char)34:\u0022\u0022; }",
		"else if ( expr.trim().equals( \u0022[POP_ALIAS].[COL_NAME]\u0022) ) {\n         return (\u0022[COL_FORMAT]\u0022.trim().length()>0)?\u0022 format=\u0022+(char)34+\u0022[COL_FORMAT]\u0022+(char)34:\u0022\u0022; }",
		"\n    " )%>
    else {
        return "";
    };
}

?>
<<$$>?xml version="1.0" encoding="UTF-8"?<$$>>
<LOADER_MAP>
	<SCHEMA><?=olhTargetSchema?></SCHEMA>
	<TABLE><?=olhTargetTable?></TABLE>
<% 

/* List all column mappings, when source technology is File */
if (odiRef.getInfo("SRC_TECHNO_NAME").toUpperCase().equals("FILE")) { %>

	<%=odiRef.getColList("", 
		"<COLUMN field=\u0022<?=\u0022[EXPRESSION]\u0022.replace(\u0022"+odiRef.getSrcTablesList("", "[POP_TAB_ALIAS]", "", "").toUpperCase() +
		 ".\u0022,\u0022\u0022).toUpperCase()?>\u0022<?=getSrcColFormat(\u0022[EXPRESSION]\u0022)?>>[COL_NAME]</COLUMN>",
	"\n\t", "" )%>

<% } 

/* List all column mappings, when source technology is Hive */
else if (odiRef.getInfo("SRC_TECHNO_NAME").toUpperCase().equals("HIVE") || true) { %>

    <% /* ...for USE_HIVE_STAGING_TABLE=1 */
    if (odiRef.getOption("USE_HIVE_STAGING_TABLE").equals("1")) { %>
	<%=odiRef.getColList("", 
		"<COLUMN field=\u0022<?=\u0022[CX_COL_NAME]\u0022.toUpperCase()?>\u0022 <?=getSrcColFormat(\u0022[EXPRESSION]\u0022)?>>[COL_NAME]</COLUMN>",
	"\n\t", "", "" ) %>
    <% } else { 
    /* ...for USE_HIVE_STAGING_TABLE=0 */ %>
	<%=odiRef.getColList("", 
		"<COLUMN field=\u0022<?=\u0022[EXPRESSION]\u0022.replace(\u0022"+odiRef.getSrcTablesList("", "[POP_TAB_ALIAS]", "", "").toUpperCase() + ".\u0022,\u0022\u0022).toUpperCase()?>\u0022>[COL_NAME]</COLUMN>",
	"\n\t", "" ) %>
    <%};%>

<% } 

/* Unsupported source technology */
else { %>
	Unsupported technology: <%=odiRef.getInfo("SRC_TECHNO_NAME")%>
<% }; %>
</LOADER_MAP>

<% } else { 

%>OdiSleep -DELAY=1

<% /* Skipped, as OLH_OUTPUT_MODE == OSCH */ 
} %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[585]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1b92799c-45ce-43cd-8944-a8e929699d43]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[325]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create Hive staging table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3946632a-f59e-46fa-b46b-2eab7bf76f46]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[585]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (
	odiRef.getInfo("SRC_TECHNO_NAME").toUpperCase().equals("HIVE") &&
	odiRef.getOption("USE_HIVE_STAGING_TABLE").equals("1")
) { 
        singleDataSet	= (odiRef.getDataSetMin() == odiRef.getDataSetMax());

%>

// Drop Hive I$ table, if exists
hive.executeQuery( '''drop table if exists <%=odiRef.getTable("L", "INT_NAME", "W")%>''' )


// Create and populate I$ table
sql = <% startCapture(); %>

create table <%=odiRef.getTable("L", "INT_NAME", "W")%>
as 

<% if ( singleDataSet ) { %>
select 	<%=odiRef.getPop("DISTINCT_ROWS")%>
	<%=odiRef.getColList( "", "[EXPRESSION] \tas [CX_COL_NAME]", ",\n\t", "", "")%>
from	<%=IkmHiveApi.removeScriptInfo( odiRef.getFrom() )%>
where	<% if (odiRef.getPop("HAS_JRN").equals("1")) { %>
	JRN_FLAG <> 'D'	<%} else {%>	(1=1)	<% } %>
<%=odiRef.getJoin()%>
<%=odiRef.getFilter()%>
<%=odiRef.getJrnFilter()%>
<%=odiRef.getGrpBy()%>
<%=odiRef.getHaving()%>

<% } else { /* Begin of: Multiple DataSets */ %>
	
select	<%=odiRef.getColList( "", "[COL_NAME] \tas [COL_NAME]", ",\n\t", "", "((INS and !TRG) and REW)")%>
from 	-- Merge data from DataSet Operations
	(
<%for (int i=odiRef.getDataSetMin(); i <= odiRef.getDataSetMax(); i++){%>
<%=odiRef.getDataSet(i, "Operator")%>
	select 	<%=odiRef.getPop("DISTINCT_ROWS")%>
		<%=odiRef.getColList(i,"", "[EXPRESSION] \tas [COL_NAME]", ",\n\t\t", "", "((INS and !TRG) and REW)")%> 
	from	<%=odiRef.getFrom(i)%>
	where	<% if (odiRef.getDataSet(i, "HAS_JRN").equals("1")) { %>
		JRN_FLAG <> 'D'	<%} else {%>	(1=1)	<% } %>
	<%=odiRef.getJoin(i)%>
	<%=odiRef.getFilter(i)%>
	<%=odiRef.getJrnFilter(i)%>
	<%=odiRef.getGrpBy(i)%>
	<%=odiRef.getHaving(i)%>
<%}%>

) <%=odiRef.getInfo("DEST_TAB_ALIAS_WORD")%> ODI_GET_FROM

<% } /* End of: Multiple DataSets */ %>

<%=getQuotedMLString(endCapture())%>



// Execute SQL
hive.executeQuery( sql )


<%} else { %>
// Step skipped due to SOURCE_TECHNO != HIVE or USE_HIVE_STAGING_TABLE = 0
<%}%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[586]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[21163222-819d-488f-93ae-e6c11e66a110]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[326]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop Oracle staging table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[15891297-89cc-4a05-bed3-63df8948abe3]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[586]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[drop table <%=odiRef.getTable("L", "INT_NAME", "W")%> purge]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[587]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2bb7e16f-3d11-4ca0-aa16-2a4c211d3099]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[327]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[72]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:26.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create Oracle non-external staging table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[69f098a8-cb4f-4370-89b5-461cca5b0a93]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[587]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ( 
	(odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("JDBC") ||
	 odiRef.getOption("OLH_OUTPUT_MODE").toUpperCase().equals("OCI")
	) && odiRef.getOption("USE_ORACLE_STAGING_TABLE").equals("1") 
) { %>

create table <%=odiRef.getTable("L", "INT_NAME", "W")%>
(
	<%=odiRef.getColList("", "[COL_NAME]\t\t[DEST_WRI_DT] NULL", ",\n\t", "", "")%>,
	IND_UPDATE		CHAR(1)
)
<%=odiRef.getUserExit("FLOW_TABLE_OPTIONS")%>

<% } else { %>

-- Skipped, as OLH_OUTPUT_MODE != JDBC/OCI or USE_ORACLE_STAGING_TABLE=0

<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3e3932d4-cb0d-4669-af1a-9b96f3c40177]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[e609be6f-8499-487f-ad65-c3eacc45c669]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[532a73dc-0db9-494b-ab97-e45fff43c3b0]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3c0e386e-b6b6-47c1-ad71-1186ec66dc9a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[57710f92-a5ae-4e06-bd0c-14c4e4e3ab43]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[2390ae42-d928-4604-83c6-3b251ec99e3f]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[300]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[50b45def-0edf-4277-a4df-b70c1aa14df0]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[591d5e5d-235a-4f7e-a2c5-9d3a72141f06]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[90a13446-ec53-47bc-978a-7416307c510f]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[88aa9e5d-526b-43a1-8dc3-9f586f0894f7]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a54d88cb-5e56-48e6-93f0-7f8bd5796c50]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[56db73e6-c8a0-46db-abc2-d11cc3ad547f]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[301]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[6696148a-21db-49af-8b41-ff9d2cb51bb7]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[302]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3e18bf5b-bddf-4a4c-9fac-5f2090fafe1e]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[303]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[9918a4fd-c064-4cd0-b654-8cde4e1f2213]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[303]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[edae6cf8-7648-4e25-bbfc-417528886edd]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[303]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[86bf5d6c-b38e-4355-ae89-7e82ab15cfea]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[303]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a9c97607-9b56-4cb1-a2eb-bf439f282de2]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[303]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[91a17fe5-eb7d-4989-adc3-6b207797d0ec]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[303]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4d4b673c-46b2-471f-92dc-24d1ed90cf50]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[304]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4a19e56d-8c55-4c37-a2df-4773dcf5d8d5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[304]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[0671701f-c75f-4eaf-b6a1-36a4281b41f8]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[304]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[e3b95b39-4573-4895-a7c2-9dd2d85fc673]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[304]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[1de1a5dd-1e39-4b98-9440-edb11a6165c1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[304]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3b84e8fa-9e3a-4c7c-8d51-e447883b7060]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[304]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[f9643e8a-face-414a-82a6-91dced97ac30]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[305]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[926e5041-0e05-42fe-b16e-126f827fdc8a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[305]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[5f57dc6e-9fc0-4783-9dbe-907ea941af1d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[305]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ab2dcdb1-f552-4b0c-a72f-4eae89963890]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[305]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[841eb0e9-7b5e-4872-9e3c-5c7914ce3890]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[305]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a5611815-e8c1-4ac3-b1ca-9a11f0cf29b6]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[305]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[78a94732-f610-463a-b0f5-b1ab64f094c8]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[306]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[81b9636c-6425-472b-a0ab-b5fc946cd726]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[306]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a9e51be9-4363-42d2-83a3-a99cd290dae4]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[306]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[5fe02991-4292-4da8-b137-9a58b24dcb24]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[306]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ef8536cb-e9fa-441f-b3c9-ae67c5377d4b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[306]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[dd8bdda7-57f7-447c-9db3-46c6fa14824b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[306]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c9cccfd4-ab6d-40b6-bacc-e181dd1c9cb5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[307]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[115d617d-34ee-42da-8d0d-e45411afcab2]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[307]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b4a47211-be3c-481e-b549-fb5f4133cd76]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[307]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[5b6bf919-523a-4282-8c4b-ff6edb39e6c8]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[307]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[8f17bf0c-5994-47bb-bcd8-35ec5f7916c1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[307]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[1cb16ce3-2c16-4222-bd22-cb5c81f52621]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[307]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4e43339d-0602-4548-9fb1-3d35f5f98764]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[308]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[6e1a7fa4-37ce-4e38-8731-58d49feb6878]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[308]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[1c7b0b12-d277-4d4d-930c-5dc600328ff3]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[308]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[208a05e1-4a6d-466d-8f2c-31dfc2a9bcd8]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[308]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4044cc9f-8807-4e68-a1a6-196d21b8c3cc]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[308]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[9b5e00d7-f806-4822-9363-68496e3d0222]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[308]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[cda795d3-190b-4f39-ba42-53762e29e121]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[309]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b6492694-da06-4df6-9229-ea75ba02466a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[309]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[0dfe6aab-f94c-4316-8822-2e60497b9e5f]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[309]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[1075b8a4-3357-4a53-a045-64a95821de59]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[309]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ef5eb2be-b217-473d-919c-a28b60a0c39b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[309]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c411aba6-66c5-4621-b2ab-c41ef3d75f03]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[309]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[2b150aed-e6b9-4125-8cf9-2b7b108dc353]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[310]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ecfff918-e8c5-460e-8d57-61adce21339e]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[310]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[6a52cc8f-f517-49f1-8e12-962a1b2288d6]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[310]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[9264c41b-c769-4e3c-a3f2-bf00847f679f]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[310]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[7c5385c3-cb56-436f-ac5e-dc75cef133eb]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[310]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[f5cfeb7b-cf91-47fa-8497-206957c8cfe1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[310]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[093c7683-344b-4252-bac0-52fbc758de75]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[311]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[7b1e3ec2-e1b0-4101-93b2-64a9aaa06e51]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[311]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[49a1ecf0-5332-43b4-b2d9-065ed1e8bde0]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[311]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[d08383e1-6a00-44cc-abeb-adf942f80c13]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[311]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[25de2087-c0c9-4e84-a6b3-3fb7779b22d2]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[311]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[28f317bf-6044-4369-b086-3e0f8c44fd7a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[311]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[7ca83a34-8fd0-4b63-b716-307b497896d0]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[312]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ee34ee89-ee0c-43be-affa-f5d7936bad30]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[312]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ed2bbe4d-5f0e-4908-bcc4-92c0af03b137]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[312]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b9a23f8f-b13b-451d-a441-25b49c5abc7c]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[312]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[1152e9f1-0583-4efd-acc2-13cfda8bc22a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[312]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a90a6e31-e41d-4243-a196-29ef4237cbad]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[312]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[1bbfe52a-9e34-4667-abd6-9fe101b4ff6c]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[320]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[e186f57e-e545-4ada-9a4f-3e23ba2e2588]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[320]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[44edbc5a-92d4-4cc0-ad22-20d893bd9ce0]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[320]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[22bf3b55-37b1-46f4-abd7-cf36d3c560bf]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[320]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a32c3f6f-8555-468d-8f5f-4d5b3ca2784a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[320]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3807df87-acb5-44d1-9527-21ad27ad6e78]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[320]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[12a84d66-460f-471a-afa5-f8b8047f8a0d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[321]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[0a6393a8-c04a-4343-a9e4-9726e882d9e0]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[322]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[1942ed4a-d46e-4c48-92cf-0aa1cd8c4f41]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[323]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a1051fd1-fc78-43f1-97c1-13dcdd6e50d5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[323]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[18303d55-920f-4ad7-9c0e-9c7b3cfa00f6]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[323]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4cdf9d61-0001-42f2-85a1-95e51936e262]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[323]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[13dac185-bc4d-4752-a056-84ba5a373a27]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[323]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[d933ea77-66ba-44d9-9847-51ced8f52cbd]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[323]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[7bd00a13-4aca-48e0-9cba-e9a5c1c35032]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[324]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[48c6a3d3-92d5-4bf1-ae3c-89f8cfe76d0b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[324]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ab6743ce-bfd1-4907-a21e-dcde86f73593]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[324]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3a8dc340-8a21-412e-9acc-558a18664603]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[324]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[21fbb9cb-a21f-4a38-a1ac-14a9e5980489]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[324]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[8b3b3115-eec8-4415-b2a7-468b0ab86841]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[324]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[258223e3-ef23-4820-8e5d-0fae39bc9fd4]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[325]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[a593e2cd-9c1d-4dbd-80db-6014be2ec5d7]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[325]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[48a2d9f0-2a34-4ee3-93c6-1b0b604a6b05]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[325]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[f63999db-ae1e-421d-9e4f-81bfe3819d30]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[325]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[eed4c71c-6603-4981-96b6-d896d765be7b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[325]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3c527b86-9b17-41fc-a6fb-3e5489dd6366]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[325]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[6ce081db-2a52-4803-a387-df59fdce5ae4]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[326]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[e31f1384-7769-4147-a87f-830acb90bcf8]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[326]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[0dc934e0-89c6-4898-aded-7a456f53f33e]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[326]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[5fbaf042-1d80-4e5f-8da2-802bde9663f7]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[326]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[bdd8997f-193f-41d3-b543-ba9ceaffc7f5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[326]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[dca568c2-ac22-4e98-bb69-3fb73853ca1e]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[326]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[82e65334-bb3a-414c-bfa1-5dad0aa6231e]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[327]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[162]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[665cc91f-d6a1-421a-969a-c0b228859667]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[327]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b0da9e00-7459-4bff-b2f9-ea0b61a97518]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[327]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[161]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[6a320be3-c441-4cec-9dc5-5d21edd26d2c]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[327]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[164]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[5fa1222f-d195-4224-9ccc-6bbf77c314ce]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[327]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[169]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[efbe71cd-27d3-45c2-88bd-d5d61ac8983d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[327]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[163]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="BaseKmType" type="java.lang.String">null</Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GenType" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[63ca866c-51e6-47e2-9558-f3232e2a4c37]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String"><![CDATA[CONTROL_APPEND]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="IsConcurrent" type="java.lang.String">null</Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[588]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmDefault" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="KmVersion" type="java.lang.String"><![CDATA[11]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:32.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[-922043000]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[IKM Hive Control Append]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[KI]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp"><![CDATA[2009-04-17 16:17:44.0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3cf78c63-2ce6-425a-bc4f-7493ace72559]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[588]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[COMPONENT NAME: IKM Hive Control Append
AUTHOR: Oracle

DESCRIPTION
	This KM integrates data into a Hive target table in truncate / insert (append) mode.
	Data can be controlled. Invalid data is isolated in the Error Table and can be recycled.
	It supports inline-view interfaces using either "IKM Hive Control Append" or 
	"IKM Hive Transform".

REQUIREMENTS
	- CDH3: The hadoop-core.jar must be on ODI class path.
	- CDH4: $HADOOP_HOME/client/* must be on ODI class path and use same version as Hadoop cluster
	- hadoop configuration directory must be on ODI class path (containing e.g. core-default.xml, core-site.xml, hdfs-site.xml)
	- UNIX environment variable ODI_HIVE_SESSION_JARS must contain hive-contrib.jar, if RegExSerDe used anywhere; 

OPTIONS (Refer to Option descriptions for more information on each option)
	- FLOW_CONTROL: Validate incoming data?
	- RECYCLE_ERRORS: Reintegrate data from error table?
	- STATIC_CONTROL: Validate data after load?
	- CREATE_TARG_TABLE: Create target table?
	- DELETE_TEMPORARY_OBJECTS: Remove temporary objects after execution?
	- TRUNCATE: Truncate data in target table?

LIMITATIONS
	- Row counter/ insert/ error counter does not reflect number of rows loaded
	- All table aliases used in an interface and any of its inlive-view interfaces must be unique
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c78c09e2-530d-4b74-883c-9baa82da476a]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[589]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[120]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[FLOW_CONTROL]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Activate Flow control]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[131241b0-b4a4-49aa-9ecb-728798bd8933]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[589]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Check this option if you wish to perform flow control.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8371f980-0295-4d4e-9fde-a83bf32a55d6]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[590]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[173]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[130]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[RECYCLE_ERRORS]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Recycle previous errors ]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c5e149d1-df89-4f5d-9e6e-ed45239eab45]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[590]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Check this option to recycle data rejected from a previous control. ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[23c74eda-9976-4526-a3b9-b782d05c09fc]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[591]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[174]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[140]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[STATIC_CONTROL]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Post Integration Control]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[51ad897b-ca56-4d21-9311-3bc6e7a90376]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[591]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Check this option to control the target table after having inserted or updated target data. ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[70fcd5e5-cb14-40c7-90f7-459289338e13]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[592]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[175]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[CREATE_TARG_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Create the target table.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c3beafbc-d26b-45b5-ab94-02018de0a8fd]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[592]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Check this option if you wish to create the target table ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[772d5f7a-33c6-4eae-861b-b23cb64429e4]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[593]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[176]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[TRUNCATE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Replace existing target data?]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[18eb20ae-0e13-4c1e-bce5-dd42d782b84d]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[593]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Set this option to true, if you wish to replace the target table content with the new data.

Setting this option to true provides better performance.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8b60f15d-010e-4319-996f-eafa8fc3b0b8]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[594]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[177]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[290]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DELETE_TEMPORARY_OBJECTS]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Delete temp objects post int]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e64f5c99-fde2-4074-8e8e-0b584eafd2aa]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[594]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Set this option to NO if you wish to retain temporary objects (tables, files and scripts) after integration.
Useful for debugging.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[389ac699-571f-4595-9170-64ae2dcc6e21]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[595]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[178]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[291]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0.8]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[HIVE_COMPATIBLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Hive version compatibility]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[47e11236-7943-4145-b7dd-29ad42a3c7ac]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[595]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Hive version compatibility.

Permitted values: 0.7 or 0.8
Default: 0.8]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[596]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8573857a-3125-4867-9bfb-ec8299ad181c]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[328]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create temp. indexes on source]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a3c73b2f-1792-4e51-b1f1-fd772421c5ad]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[596]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[103]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[hive.executeQuery( '''

create index <%=odiRef.getObjectShortName("L",odiRef.getTemporaryIndex ("IDX_NAME"),"W") %> 
on table <%=odiRef.getTemporaryIndex ("TABLE_NAME")%> <%=odiRef.getTemporaryIndexColList( "(", " [COL_NAME] ", ", ", ")" )%> 
as '<%=odiRef.getTemporaryIndex ("INDEX_TYPE_CLAUSE") %>'
with deferred rebuild

''')

<% /* Until HIVE-1496 is implemented, we must explicitly trigger index rebuild. */ %>

hive.executeQuery( '''

alter index <%=odiRef.getObjectShortName("L",odiRef.getTemporaryIndex ("IDX_NAME"),"W") %> 
on <%=odiRef.getTemporaryIndex ("TABLE_NAME")%> 
rebuild

''')]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[597]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4ba10f6c-ab25-4764-a767-8f21829f0934]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[329]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Preview SQL: Insert into flow into I$]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[dc38aa38-0fd1-40eb-bec3-60d722a88322]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[597]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<%
        singleDataSet	= (odiRef.getDataSetMin() == odiRef.getDataSetMax());
        errorRecycling	= odiRef.getOption( "RECYCLE_ERRORS" ).equals( "1" ) && odiRef.getOption( "FLOW_CONTROL" ).equals( "1" );
%>
sql = <%startCapture();%>

insert overwrite table	 <%=odiRef.getTable("L", "INT_NAME", "A")%> <%=myRef.getColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>

<% if ( singleDataSet && !errorRecycling ) { %>
select 	<%=odiRef.getPop("DISTINCT_ROWS")%>
	<%= /* first all non-partition columns */ myRef.getColList( "", "[EXPRESSION__NULL_IF_UNMAPPED] \tas [COL_NAME]", 
	",\n\t", "", "NOT PARTITION")%>
	<%= /* then all partition columns */ myRef.getColList( ",", "[EXPRESSION__NULL_IF_UNMAPPED] \tas [COL_NAME]", 
	",\n\t", "", "PARTITION")%>
from	<%=myRef.removeScriptInfo( odiRef.getFrom() )%>
where	<% if (odiRef.getPop("HAS_JRN").equals("1")) { %>
	JRN_FLAG <> 'D'	<%} else {%>	(1=1)	<% } %>
<%=odiRef.getJoin()%>
<%=odiRef.getFilter()%>
<%=odiRef.getJrnFilter()%>
<%=odiRef.getGrpBy()%>
<%=odiRef.getHaving()%>

<% } else { /* Begin of: Multiple DataSets */ %>

<% if ( errorRecycling ) { %>
select	<%= /* first all non-partition columns */ myRef.getColList( "", "[COL_NAME] \tas [COL_NAME]", 
	",\n\t", "", "NOT PARTITION")%>
	<%= /* then all partition columns */ myRef.getColList( ",", "[COL_NAME] \tas [COL_NAME]", 
	",\n\t", "", "PARTITION")%>
from 	-- Merge previous errors (which are not in target) with new data
	(<%=getQuotedMLString(endCapture())%> +

/* Execute this select only, if the error table already exists */
((!hive.tableExists("<%=odiRef.getInfo("DEST_WORK_SCHEMA")%>","<%=odiRef.getInfo("ERR_NAME")%>"))?'':'''
	-- Previous errors
	select	<%= /* first all non-partition columns */ myRef.getColList( "", "E.[COL_NAME] \tas [COL_NAME]", 
	",\n\t\t", "", "NOT PARTITION")%>
		<%= /* then all partition columns */ myRef.getColList( ",", "cast (E.[COL_NAME] as [DEST_CRE_DT]) \tas [COL_NAME]", 
	",\n\t\t", "", "PARTITION")
		/* cast required to work-around HIVE-2421 */ %>
	from	<%=odiRef.getTable("L","ERR_NAME", "W")%> <%=odiRef.getInfo("DEST_TAB_ALIAS_WORD")%> E
		left outer join <% /* Using left outer join, as Hive does not support NOT EXISTS clause */ %>
		<%=odiRef.getTable("L","INT_NAME","W")%> <%=odiRef.getInfo("DEST_TAB_ALIAS_WORD")%> T
		on (	<%=odiRef.getColList("", "T.[COL_NAME]\t= E.[COL_NAME]", "\n\t\tand\t", "", "UK")%>)
	where	(-- error row does not exist in target?
		<%=odiRef.getColList("", "T.[COL_NAME]\t IS NULL", "\n\t\tand\t", "", "UK")%>)
	and 	E.ODI_ORIGIN	= '<%=odiRef.getInfo("CT_ORIGIN")%>'
	and 	E.ODI_ERR_TYPE	= '<%=odiRef.getInfo("CT_ERR_TYPE")%>'

	union all ''') /* End of !tableExists */ +

<%startCapture();%>
<% } %>
	
-- New data
select	<%= /* first all non-partition columns */ myRef.getColList( "", "[COL_NAME__EXPRESSION_IF_ON_TARGET] \tas [COL_NAME]", 
	",\n\t", "", "NOT PARTITION")%>
	<%= /* then all partition columns */ myRef.getColList( ",", "[COL_NAME__EXPRESSION_IF_ON_TARGET] \tas [COL_NAME]", 
	",\n\t", "", "PARTITION")%>
from 	-- Merge data from DataSet Operations
	(
<%for (int i=odiRef.getDataSetMin(); i <= odiRef.getDataSetMax(); i++){%>
<%=odiRef.getDataSet(i, "Operator")%>
	select 	<%=odiRef.getPop("DISTINCT_ROWS")%>
		<%=odiRef.getColList(i,"", "[EXPRESSION] [COL_NAME]", ",\n\t\t", "", "((INS and !TRG) and REW)")%> 
	from	<%=odiRef.getFrom(i)%>
	where	<% if (odiRef.getDataSet(i, "HAS_JRN").equals("1")) { %>
		JRN_FLAG <> 'D'	<%} else {%>	(1=1)	<% } %>
	<%=odiRef.getJoin(i)%>
	<%=odiRef.getFilter(i)%>
	<%=odiRef.getJrnFilter(i)%>
	<%=odiRef.getGrpBy(i)%>
	<%=odiRef.getHaving(i)%>
<%}%>

) <%=odiRef.getInfo("DEST_TAB_ALIAS_WORD")%> ODI_GET_FROM

<% } /* End of: Multiple DataSets */ %>

<% if ( errorRecycling ) { %>
) <%=odiRef.getInfo("DEST_TAB_ALIAS_WORD")%> ODI_GET_FROM_OUTER
<% } %>

<%= /* add distribute expression to avoid unbalanced dynamic partition creation and resulting failures */ 
	myRef.getColList( "distribute by\t", "[COL_NAME]", ",", "", "PARTITION")%>

<%=getQuotedMLString(endCapture())%>

throw new RuntimeException( "\n\nThis is no error, just an informational message: Insert command submitted: \n\n" + sql + "\n" );]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[598]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[962381e6-dc45-4a78-a609-9238055703e3]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[330]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Prepare Hive Session]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[066704dc-c6ee-49fa-8449-16e9b416aef0]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[598]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% isODI12cOrLater = !odiRef.getInfo("ODI_MAJOR_VERSION").contains("ODI_MAJOR_VERSION"); %>

<% /* -------- Begin of block ----- Keep this block in sync across all Hive KMs ----------- */ %>
<%

/* Begin of BSh code gen extensions */

out2 = null;
buffer = null;

startCapture() {
    out2 = out;
    buffer = new ByteArrayOutputStream();
    out = new PrintWriter( buffer );
}

endCapture() {
    out.flush();
    out.close();
    captured = buffer.toString();
    out = out2;
    return captured;
}

getQuotedMLString( s ) {
// escape tripple single quotes
// escape backslashes
    return 
        "'''" + 
        s.replace(""+(char)92, ""+(char)92+(char)92)
        .replace( "'''", ""+(char)92+"'"+(char)92+"'"+(char)92+"'") +
        "'''";
}

/* End of BSh code gen extensions */

%>


<% /* Begin of Hive Runtime-API */ %>

import java.lang.System
import java.sql.Statement
import java.sql.Connection
import java.sql.SQLException


class flexUtilHive {
    Statement stmt;
    public Connection con;

    flexUtilHive( Connection pCon ) {
        con = pCon
        if (con == null) 
            throw new RuntimeException( "\nFailure to open JDBC connection. Please test DataServer connection." );


        // Set session parameters for dynamic partitions
        stmt = con.createStatement()
        stmt.execute( """set hive.exec.dynamic.partition=true""" )
        stmt.execute( """set hive.exec.dynamic.partition.mode=nonstrict""" )
        stmt.execute( """set hive.enforce.bucketing=true""" )
        stmt.execute( """set hive.optimize.bucketmapjoin=true""" )
        //stmt.execute( """set mapred.job.reuse.jvm.num.tasks=-1""" )
        // Add custom jars to this Hive session
        String sExtraJars = """<?=(System.getenv("ODI_HIVE_SESSION_JARS")!=null)?System.getenv("ODI_HIVE_SESSION_JARS"):""?>"""
        if (sExtraJars != "") {
            def lstExtraJars = sExtraJars.split( ":" )
            for (j in lstExtraJars) {
                stmt.execute( """add jar """ + j )
            }
        }
    }

    // Function for executing Hive SQL statements
    def executeQuery( String sql ) {
        try {
            stmt.executeUpdate( sql )
        } catch (SQLException re) {
            def msg = "Exception encountered while submitting: \n-------------------\n" + sql + "\n-------------------"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

    // Check if a table already exists
    def tableExists( String schema, String table ) {
        try {
            def dbm = con.getMetaData()
            def rs = dbm.getTables(null, schema.toLowerCase(), table.toLowerCase(), null)
            return rs.next()
        } catch (SQLException re) {
            def msg = "Exception encountered while checking existence of table "+schema+"."+table+" !"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

}

<% /* End of hive Runtime-API */ %>


<%

// Is there already an API defined?
if (IkmHiveApi != void) {

    // Verify correct version and error out, if not
    if (IkmHiveApi.getVersion() != 1) 
        out.print( "<? throw new RuntimeException( \u0022\u0022+(char)10+(char)10+(char)10+\u0022You are using Hive KMs from different versions. Please make sure to use all Hive KMs from the same ODI version/patch.\u0022+(char)10+(char)10+(char)10 );?>");

} else {

/* Begin of IkmHiveApi.java */

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;

import com.sun.org.apache.xpath.internal.Expression;


public class IkmHiveApi {
	public static final String DELIMITER = ""+(char)1;
	public static final String RE_Q = ""+(char)92+"Q";
	public static final String RE_E = ""+(char)92+"E";

	       static final String MISSING_FLEXFIELD_GETCOLLIST = "Exception getColList(";
           static final String MISSING_FLEXFIELD_GETINFO = "Exception getInfo(";
           static final String EXPRESSION_NOT_SUPPORTED = "[EXPRESSION] not supported in getAllTargetColList";
	       static final String DELIMITER_REGEX = RE_Q+ DELIMITER +RE_E;
	public static final String SELECTOR_PARTITION =              "PARTITION";
	public static final String SELECTOR_NOT_PARTITION =          "NOT PARTITION";
    public static final String SELECTOR_PARTITION_COND1 =        "PARTITION AND (UNMAPPED OR TARGET)";
    public static final String SELECTOR_CLUSTER =                "CLUSTER";
	public static final String SELECTOR_PARTITION_OR_CLUSTER =   "PARTITION OR CLUSTER";
    public static final String SELECTOR_SORT =                   "SORT";
           static final String PATTERN_COL_NAME = "[COL_NAME]";
           static final String PATTERN_DEST_CRE_DT = "[DEST_CRE_DT]";
           static final String PATTERN_EXPRESSION = "[EXPRESSION]";
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED =      "[EXPRESSION__NULL_IF_UNMAPPED]";
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET = "[COL_NAME__EXPRESSION_IF_ON_TARGET]";
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET =       "[COL_NAME__NULL_IF_ON_TARGET]";
           static final String PATTERN_MAPPED_ON_TARGET =                  "[MAPPED_ON_TARGET]";
           static final String PATTERN_UNMAPPED =                          "[UNMAPPED]";
           /*static final String PATTERN_COL_NAME_REGEX = RE_Q+ PATTERN_COL_NAME +RE_E;
           static final String PATTERN_DEST_CRE_DT_REGEX = RE_Q+ PATTERN_DEST_CRE_DT +RE_E;
           static final String PATTERN_EXPRESSION_REGEX = RE_Q+ PATTERN_EXPRESSION +RE_E;
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED_REGEX = RE_Q+ PATTERN_EXPRESSION__NULL_IF_UNMAPPED +RE_E;
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET +RE_E;
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__NULL_IF_ON_TARGET +RE_E;
           static final String PATTERN_MAPPED_ON_TARGET_REGEX = RE_Q+ PATTERN_MAPPED_ON_TARGET +RE_E;
           */
	       
           static final String MARKER_SCRIPTNAME = "SNP$SCRIPTNAME";
           static final String MARKER_SCRIPTFULLNAME = "SNP$SCRIPTFULLNAME";
           static final String MARKER_SCRIPT = "SNP$SCRIPTTEXT";
           static final String MARKER_SCRIPTEND = "SNP$SCRIPTTEXTEND";
	
	LinkedHashMap 
	    cols,          // contains all columns (getColList)
	    allTargetCols; // contains all columns including the target columns (getAllTargetColList)
	String buckets;    // contains the number of buckets for this target

	private class ColInfo {
		static final String PROP_TRG = "TRG";
		static final String PROP_UD1 = "UD1";
		static final String PROP_UD2 = "UD2";
		static final String PROP_UD3 = "UD3";
		static final String PROP_FF_PART = "PART";
		static final String PROP_FF_CLUST = "CUST";
		static final String PROP_FF_SORT = "SORT";
		
		String colName, colDt, colExpr;
		boolean bTarget, bUd1, bUd2, bUd3, bFlexPartCol, bFlexClustCol, bFlexSortCol = false;
		
		public ColInfo( String pColName, String pColDt, String pColExpr, boolean pIsPartCol, boolean pIsClustCol, boolean pIsSortCol ) {
			colName = pColName;
			colDt   = pColDt;
			colExpr = pColExpr;
			bFlexPartCol = pIsPartCol;
            bFlexClustCol = pIsClustCol;
            bFlexSortCol = pIsSortCol;
		}
		public void set( String pProperty, boolean v )		{ 
			if      ( pProperty == PROP_TRG ) 	bTarget = v;
			else if ( pProperty == PROP_UD1 ) 	bUd1 = v;
			else if ( pProperty == PROP_UD2 ) 	bUd2 = v;
			else if ( pProperty == PROP_UD3 ) 	bUd3 = v;
			else if ( pProperty == PROP_FF_PART )	bFlexPartCol  = v;
			else if ( pProperty == PROP_FF_CLUST )  bFlexClustCol = v;
			else if ( pProperty == PROP_FF_SORT )	bFlexSortCol  = v;
		};
		public String getColName() { return colName; }
		public String getDataType() { return colDt; }
		public String getExpression() { return colExpr; }
		public boolean isTarget() { return bTarget; }
		public boolean isMapped() { return !colExpr.equals(EXPRESSION_NOT_SUPPORTED) && colExpr.trim().length()>0; };
		public boolean isUd1() { return bUd1; }
		public boolean isUd2() { return bUd2; }
		public boolean isUd3() { return bUd3; }
		public boolean isPartitionBy() { return bFlexPartCol; }
        public boolean isClusterBy() { return bFlexClustCol; }
        public boolean isSortBy() { return bFlexSortCol; }
	}

	// Return the version of the code gen API. 
	// Used for testing that all KMs in a session are using the same API version
	public static int getVersion() {
	    return 1;
	}
	
	public String initMetadata(
	        boolean dumpMetadata,
			String pAllCols,
			String pAllDts,
			String pAllExpr,
			String pTrgCols,
			String pUd1Cols,
			String pUd2Cols,
			String pUd3Cols,
			String pAllPartCols,
			String pAllClustCols,
			String pAllSortCols,
            String pAllTrgCols,
            String pAllTrgDts,
            String pAllTrgPartCols,
            String pAllTrgClustCols,
            String pAllTrgSortCols,
            String pKMOptionBuckets,
            String pFFBuckets
			) {	    
	    if (dumpMetadata) {
	        String pre = ""+(char)34;
	        String post = ""+(char)34+","+(char)10;
	        return 
            "/* inst.initMetadata("+(char)10+
            "false,"+(char)10+
            pre+pAllCols+post+
            pre+pAllDts+post+
            pre+pAllExpr+post+
            pre+pTrgCols+post+
            pre+pUd1Cols+post+
            pre+pUd2Cols+post+
            pre+pUd3Cols+post+
            pre+pAllPartCols+post+
            pre+pAllClustCols+post+
            pre+pAllSortCols+post+
            pre+pAllTrgCols+post+
            pre+pAllTrgDts+post+
            pre+pAllTrgPartCols+post+
            pre+pAllTrgClustCols+post+
            pre+pAllTrgSortCols+post+
            pre+pKMOptionBuckets+post+
            pre+pFFBuckets+(char)34+(char)10+
            "); */";
	    };
	    
        /* TODO: Sort cols still needs to be implemented */
		String[] allCols         = pAllCols.split(DELIMITER_REGEX,-1);
		String[] allDts          = pAllDts.split(DELIMITER_REGEX,-1);
		String[] allExpr         = pAllExpr.split(DELIMITER_REGEX,-1);
		String[] allPartCols     = pAllPartCols.split(DELIMITER_REGEX,-1);
		String[] allClustCols    = pAllClustCols.split(DELIMITER_REGEX,-1);
        String[] allSortCols     = pAllSortCols.split(DELIMITER_REGEX,-1);
        String[] allTrgCols      = pAllTrgCols.split(DELIMITER_REGEX,-1);
        String[] allTrgDts       = pAllTrgDts.split(DELIMITER_REGEX,-1);
        String[] allTrgPartCols  = pAllTrgPartCols.split(DELIMITER_REGEX,-1);
        String[] allTrgClustCols = pAllTrgClustCols.split(DELIMITER_REGEX,-1);
        String[] allTrgSortCols  = pAllTrgSortCols.split(DELIMITER_REGEX,-1);
		
		/* Create all column objects */
        cols = new LinkedHashMap();
	    for(int j=0; j<allCols.length; j++){
	        String  colName    = allCols[j];
	        String  colDt      = allDts[j];
	        String  colExpr    = allExpr[j];
        	boolean isPartCol  = false;
            boolean isClustCol = false; 
            boolean isSortCol  = false; 
	        /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
	           and must be ignored. */
	        if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isPartCol  = (allPartCols[j].equals("0"))? false : true;
	        }
	        if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isClustCol = (allClustCols[j].equals("0"))? false : true; 
	        }
            if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                isSortCol = (allSortCols[j].equals("0"))? false : true; 
            }
	        cols.put(colName, new ColInfo( colName, colDt, colExpr, isPartCol, isClustCol, isSortCol ) );
	    };
	    set( cols, ColInfo.PROP_TRG, pTrgCols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD1, pUd1Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD2, pUd2Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD3, pUd3Cols.split(DELIMITER_REGEX) );

	    /* Create allTargetCols list */
        allTargetCols = new LinkedHashMap();
        for(int j=0; j<allTrgCols.length; j++){
            String  colName    = allTrgCols[j];
            // Does this column already exist in cols ?
            ColInfo colObj = (ColInfo) cols.get( colName );
            if ( colObj != null )
                // then lets copy it
                allTargetCols.put( colName, colObj );
            else {
                // otherwise it's a column without any mapping and we need to create a new ColInfo Object for it
                String  colDt      = allTrgDts[j];
                boolean isPartCol  = false;
                boolean isClustCol = false; 
                boolean isSortCol = false; 
                /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
                   and must be ignored. */
                if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isPartCol  = (allTrgPartCols[j].equals("0"))? false : true;
                }
                if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isClustCol = (allTrgClustCols[j].equals("0"))? false : true; 
                }
                if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isSortCol = (allTrgSortCols[j].equals("0"))? false : true; 
                }
                allTargetCols.put(colName, new ColInfo( colName, colDt, EXPRESSION_NOT_SUPPORTED, isPartCol, isClustCol, isSortCol ) );
            };

        };
        
        /* Process buckets information */
        buckets = "";
        if ( pFFBuckets.length() > 0 && !pFFBuckets.startsWith(MISSING_FLEXFIELD_GETINFO) )
            buckets = pFFBuckets;
        if ( pKMOptionBuckets.length() > 0 )
            buckets = pKMOptionBuckets;
        
        return "";
	}
	
	/**
	 * Set property pField (UD1, UD2 etc) for all columns listed in pCols
	 * @param pAllCols
	 * @param pField
	 * @param pCols
	 */
	static void set( HashMap pAllCols, String pProperty, String[] pCols ){
		/* Check, if pCols just contains a single empty string */
		if ( pCols.length == 1 && pCols[0].length() == 0 ) return;
		/* Loop over all columns and set the respective property */
	    for(int j=0; j<pCols.length; j++){
	        String colName = pCols[j];
	    	ColInfo col = (ColInfo) pAllCols.get( colName );
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) throw new RuntimeException( "IKM Hive Control Append: set(): Internal Error: Cannot find column: " + colName );
	    	col.set( pProperty, true );
	    };			
	}
	
    public String getColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( cols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    public String getAllTargetColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( allTargetCols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    static private String getColList(
            LinkedHashMap cols,
			String pStart,
			String pPattern,
			String pSeparator,
			String pEnd,
			String pSelector) {
		StringBuffer rv = new StringBuffer();
		if ( ! (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) ||
						pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) ||
                        pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_SORT ) )) {
		    String msg = "IKM Hive Control Append: getColList(): invalid selector received: " + pSelector;
			/* Not yet supported in ODI 11.1.1.6.0:
			 * throw new RuntimeException( msg ); 
			 */
			return msg;
    }
        Iterator iter = cols.keySet().iterator();       
        while(iter. hasNext()){
        	String colName = (String) iter.next();
        	ColInfo col = (ColInfo) cols.get( colName );
        	
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) {
	    	    String msg = "IKM Hive Control Append: getColList(): Internal Error: Cannot find column: " + colName;
	    	    /* Not yet supported in ODI 11.1.1.6.0:
	    	     * throw new RuntimeException( msg );
	    	     */
	    	    return msg;
	    	}
	    	    
            /* Does the column match the selector? */
            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) &&          (col.isPartitionBy() && (!col.isMapped() || col.isTarget())) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isPartitionBy() || col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isSortBy()) ) || 
                    (pSelector.toUpperCase().equals( "" )) 
//            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isUd2() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isUd1() || col.isUd2() || col.isPartitionBy() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isUd3() || col.isSortBy()) ) || 
//                    (pSelector.toUpperCase().equals( "" )) 
        	) {
        		String s = pPattern;
        		/* Replace all patterns with their respective values */
        		s = s.replace( PATTERN_COL_NAME, col.getColName() );
        		s = s.replace( PATTERN_DEST_CRE_DT, col.getDataType() );
                s = s.replace( PATTERN_EXPRESSION, col.getExpression() );
                /* Handle EXPRESSION__NULL_IF_UNMAPPED_REGEX */
        		if (col.getExpression().equals(EXPRESSION_NOT_SUPPORTED)) {
        		    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, "cast(null as "+col.getDataType()+")" );
        		    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
        		} else {
                    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, col.getExpression() );        		    
        		}
                /* Handle MAPPED_ON_TARGET */
                s = s.replace( PATTERN_MAPPED_ON_TARGET, (col.isTarget())?"1":"0" );
                
                /* Handle UNMAPPED */
                s = s.replace( PATTERN_UNMAPPED, (!col.isMapped())?"1":"0" );
                
                /* Handle COL_NAME__EXPRESSION_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET, 
                        (col.isTarget())?col.getExpression():
                            ((!col.isMapped())?
                                    "cast(null as "+col.getDataType()+")":
                                    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                                    col.getColName())
                );
        		
                /* Handle COL_NAME__NULL_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__NULL_IF_ON_TARGET, 
                        (col.isTarget() || !col.isMapped())?
                            "cast(null as "+col.getDataType()+")" :
                            /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                            col.getColName()
                );
                
                /* Add separator for second and later columns */
        		if ( rv.length() > 0 )
        		  rv.append(pSeparator);
        		rv.append( s );

        	}
        }
		/* if any columns selected, insert/append pStart/pEnd */ 
		if (rv.length() > 0) {
			rv.insert(0, pStart);
			rv.append( pEnd );
		};
		/* return buffer after unescaping control characters */
		return rv.toString()
			.replaceAll( ""+(char)92+"Q"+(char)92+"n"+(char)92+"E", ""+(char)10 )
			.replaceAll( ""+(char)92+"Q"+(char)92+"t"+(char)92+"E", ""+(char)9 );
	}
    
    public String getBuckets(
            String pBefore,
            String pAfter) {
        /* Does this target have any cluster by columns ? */
        boolean isTargetClustered = (getAllTargetColList("","X","","",SELECTOR_CLUSTER).length()>0);
        return isTargetClustered ? (pBefore + buckets + pAfter) : "";
    }
    
    public static List getScriptInfo( String getFrom ) {
        String s = getFrom;
        List lst = new ArrayList();
        while ( s.indexOf( MARKER_SCRIPTNAME ) > -1 ) {
            int beginName     = s.indexOf( MARKER_SCRIPTNAME );
            int endName       = s.indexOf( MARKER_SCRIPTFULLNAME);
            int beginFullName = endName + MARKER_SCRIPTFULLNAME.length();
            int endFullName   = s.indexOf( MARKER_SCRIPT );
            int beginScript   = endFullName + MARKER_SCRIPT.length();
            int endScript     = s.indexOf( MARKER_SCRIPTEND );
            lst.add( new String[] {s.substring(beginName + MARKER_SCRIPTNAME.length(), endName), 
                                   s.substring(beginFullName, endFullName), 
                                   s.substring(beginScript, endScript)} );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return lst;
    }
    
    public static String removeScriptInfo( String getFrom ) {
        String s = getFrom;
        while ( s.indexOf( MARKER_SCRIPT ) > -1 ) {
            int beginName = s.indexOf( MARKER_SCRIPTNAME );
            int endScript = s.indexOf( MARKER_SCRIPTEND );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return s;
    }
        
	/**
	 * Some test stub
	 */
	public static void main(String[] args) {
	    
		/* getColList: Test for a permanent interface */
		IkmHiveApi inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"", 
				"", 
				"", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "",
                "4"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
		System.out.println();
		System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println("------------------------------"); 

		/* getColList: Test for a temporary interface */
		inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"sales_pers_id", 
				"sales_pers_id", 
				"sales_last_name", 
				"Exception getColList(...)", 
				"Exception getColList(...)", 
				"Exception getColList(...)",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "Exception getColList(...)", 
                "Exception getColList(...)", 
                "Exception getColList(...)",
                "4",
                "Exception getInfo(...)"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println("------------------------------"); 
        
        /* my test case */
        inst = new IkmHiveApi();
        inst.initMetadata(
                false,
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CUSTID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.LAST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.FIRST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.AGE$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CITY_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.SALES_PERS_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.DEAR$$SUNOPSIS$$1$$SUNOPSIS$$CUS.ADDRESS$$SUNOPSIS$$1$$SUNOPSIS$$CUS.PHONE",
                "",
                "",
                "dear",
                "",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "",
                "4"
                );
        System.out.println( inst.getColList("partition by (", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", ")", "PARTITION") );
        System.out.println( inst.getAllTargetColList("partition or cluster by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "PARTITION OR CLUSTER") );
        System.out.println( inst.getAllTargetColList("not partition by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "NOT PARTITION") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println( inst.getAllTargetColList("sort by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "SORT") );
        System.out.println("------------------------------"); 

        String getFrom = "select c1, c2, c3 from ( select c4, c5, c6 from (T1" + MARKER_SCRIPTNAME + "trafo1.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo1.pl" + MARKER_SCRIPT + "my script 1" + MARKER_SCRIPTEND + ") ODI_FROM, T2" +
                         MARKER_SCRIPTNAME + "trafo2.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo2.pl" + MARKER_SCRIPT + "my script 2" + MARKER_SCRIPTEND + ")";
        Iterator iter = getScriptInfo(getFrom).iterator();
        /* List scripts */
        while (iter.hasNext()) {
            String[] script = (String[])iter.next();
            System.out.println( script[0] + " : " + script[1] + " : " + script[2] ); 
        }
        System.out.println("------------------------------"); 
        System.out.println( removeScriptInfo(getFrom) ); 
        System.out.println("------------------------------"); 

	}

}

/* End of IkmHiveApi.java */

};

%>
<% /* -------- End of block ----- Keep this block in sync across all Hive KMs ----------- */ %>

<%
/* Pass metadata into KM specific code generation */
myRef = new IkmHiveApi();

String sColList_HIVE_PARTITION_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sColList_HIVE_CLUSTER_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sColList_HIVE_SORT_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_PARTITION_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_CLUSTER_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_SORT_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetTable_HIVE_BUCKETS = IkmHiveApi.MISSING_FLEXFIELD_GETINFO;

try { 
  sColList_HIVE_PARTITION_COLUMN = odiRef.getColList("", "[HIVE_PARTITION_COLUMN]", ""+(char)1, "", ""); 
  sColList_HIVE_CLUSTER_COLUMN = odiRef.getColList("", "[HIVE_CLUSTER_COLUMN]", ""+(char)1, "", ""); 
  sColList_HIVE_SORT_COLUMN = odiRef.getColList("", "[HIVE_SORT_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_PARTITION_COLUMN = odiRef.getAllTargetColList("", "[HIVE_PARTITION_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_CLUSTER_COLUMN = odiRef.getAllTargetColList("", "[HIVE_CLUSTER_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_SORT_COLUMN = odiRef.getAllTargetColList("", "[HIVE_SORT_COLUMN]", ""+(char)1, "", ""); 
  sTargetTable_HIVE_BUCKETS = odiRef.getTargetTable("HIVE_BUCKETS"); 
} catch (Exception e) {} 

out.print(myRef.initMetadata( 
	false,
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, ""), 
	odiRef.getColList("", "[DEST_CRE_DT]", ""+(char)1, ""), 
	odiRef.getColList("", "[EXPRESSION]", ""+(char)1, ""), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "TRG"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD1"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD2"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD3"), 
	sColList_HIVE_PARTITION_COLUMN, 
	sColList_HIVE_CLUSTER_COLUMN, 
	sColList_HIVE_SORT_COLUMN,
	odiRef.getAllTargetColList("", "[COL_NAME]", ""+(char)1, ""), 
	odiRef.getAllTargetColList("", "[DEST_CRE_DT]", ""+(char)1, ""), 
	sTargetColList_HIVE_PARTITION_COLUMN, 
	sTargetColList_HIVE_CLUSTER_COLUMN, 
	sTargetColList_HIVE_SORT_COLUMN,
	"",
	sTargetTable_HIVE_BUCKETS
));
%>

hive = new flexUtilHive( odiRef.getJDBCConnection("DEST") )
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[599]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e1cd35b4-352c-405d-9252-64cc12e1173f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[331]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create target table ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d6390506-0240-430e-8294-617f403e3316]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[599]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[sql = '''
create table if not exists <%=odiRef.getTable("L","TARG_NAME","A")%>
(
	<%=myRef.getAllTargetColList("", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", "", "NOT PARTITION")%>
)
<%
%><%=myRef.getAllTargetColList("partitioned by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", ")\n", "PARTITION")
%><%=myRef.getAllTargetColList("clustered by (", "[COL_NAME]", ", ", ")\n", "CLUSTER")
%><%=myRef.getAllTargetColList("sorted by (", "[COL_NAME]", ", ", ")\n", "SORT")
%><%=myRef.getBuckets("into ", " buckets\n")%>
'''

hive.executeQuery( sql )


]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[600]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[19a60adc-a399-4e7d-9964-39e9909312b9]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[332]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create flow table I$]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0278aee7-a7b4-4eaa-bf47-6139d424042f]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[600]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[sql = '''

create table if not exists <%=odiRef.getTable("L", "INT_NAME", "A")%>
(
	<%=myRef.getColList("", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", "", "NOT PARTITION")%>
)
<%
%><%=myRef.getColList("partitioned by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", ")\n", "PARTITION")
%><%=myRef.getColList("clustered by (", "[COL_NAME]", ", ", ")\n", "CLUSTER")
%><%=myRef.getColList("sorted by (", "[COL_NAME]", ", ", ")\n", "SORT")
%><%=myRef.getBuckets("into ", " buckets\n")%>
'''

hive.executeQuery( sql )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[601]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ff4461af-2449-4ca0-8041-3ef1d8433b15]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[333]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create/ Declare any inline-view scripts]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[838c0d74-7e2c-4cab-8fed-b5819fa3072f]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[601]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[// Create and declare any scripts files required for any inline-views

import org.apache.hadoop.fs.FileSystem
import org.apache.hadoop.fs.Path
import org.apache.hadoop.conf.Configuration
import java.net.URI
import java.io.BufferedWriter
import java.io.OutputStreamWriter
import org.apache.hadoop.fs.permission.FsPermission

<% { iter = myRef.getScriptInfo( odiRef.getFrom() ).iterator();
while ( iter.hasNext() ) { 
    scriptInfo = iter.next();
    scriptName = scriptInfo[0];
    scriptNameFull = scriptInfo[1];
    scriptText = scriptInfo[2]; 
%>

fileName = '''<%=scriptNameFull%>'''
script = <%=getQuotedMLString(scriptText)%>

// Does the interface contain the script?
if ( script.length() > 0) {
    // lets create the script
    fs = FileSystem.get( new URI( fileName ),  new Configuration() )
    pt = new Path( fileName )
    br = new BufferedWriter( new OutputStreamWriter( fs.create(pt)) )
    br.write( script )
    br.close()
    fs.setPermission( pt, new FsPermission( (Integer.parseInt("111111000",2)).shortValue() ) ) /* read,write,execute for user and group */
}

// Declare script file in Hive session
hive.executeQuery( '''add file <%=scriptNameFull%>''' )

<% }; } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[602]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7f73000f-c391-4bc4-9e00-327d137f3f78]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[334]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[130]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert flow into I$ table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[226f6a62-cc2c-4a52-a838-499cd77b74f1]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[602]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[hive.executeQuery( sql )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[603]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e31cca75-0c9c-4bbd-869e-551e88ee4e52]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[335]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[140]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Flow control]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[08e7597f-899f-4c74-af08-17d618f8c92e]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[603]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<%@ INCLUDE CKM_FLOW DELETE_ERRORS%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[604]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f653a8a9-e24f-424f-bc03-c7f25db3aca5]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[336]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert (new) rows]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d0422d5e-35d1-4caa-80de-5b704dda76ed]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[604]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% 
    mergeIntoTarget 	= odiRef.getOption("TRUNCATE").equals("0");
    flowControl 	= odiRef.getOption("FLOW_CONTROL").equals("1");
    singleDataSet	= (odiRef.getDataSetMin() == odiRef.getDataSetMax());
    targetName 	= odiRef.getTable("L","TARG_NAME","A");
    legacyHive 	= odiRef.getOption("HIVE_COMPATIBLE").equals("0.7");

    if ( mergeIntoTarget && legacyHive) { %>  
        // Create temp target table
        hive.executeQuery( '''create table <%=targetName%>_tmp like <%=odiRef.getTargetTable("RES_NAME")%>''' )
    <%} %>  

    sql = <%startCapture();%>
    
    <%if ( !mergeIntoTarget ) { %>     
      insert overwrite table <%=targetName%> <%=myRef.getAllTargetColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>
    <% } else if ( legacyHive ){ %>
      insert overwrite table <%=targetName%>_tmp <%=myRef.getAllTargetColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>
    <% } else { %>
      insert into table <%=targetName%> <%=myRef.getAllTargetColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>
    <% } %>
    
    <%if ( mergeIntoTarget && legacyHive) { %> 
       select	<%= /* first all non-partition columns */ myRef.getAllTargetColList( "", "[COL_NAME]", ",\n\t", "", "NOT PARTITION")%>
	        <%= /* then all partition columns */ myRef.getAllTargetColList( ",", "[COL_NAME]", ",\n\t", "", "PARTITION")%>

       from	-- Merge existing target data with new data
	(
	select	<%= /* first all non-partition columns */ myRef.getAllTargetColList( "", "TRG.[COL_NAME] \tas [COL_NAME]", ",\n\t\t", "", "NOT PARTITION")%>
		<%= /* then all partition columns */ myRef.getAllTargetColList( ",", "cast(TRG.[COL_NAME] as [DEST_CRE_DT]) \tas [COL_NAME]", ",\n\t\t", "", "PARTITION")%>
		<% /* work-around for HIVE-2421: partition variables are treated as strings during union queries, regardless of declared type */ %>
	from	<%=odiRef.getTargetTable("RES_NAME")%> TRG

	union all
     <% }  /* End of: mergeIntoTarget && legacyHive*/ %>
     
     <% if ( flowControl ) { %> 
        select	<%=myRef.getAllTargetColList("", "[COL_NAME__EXPRESSION_IF_ON_TARGET] \tas [COL_NAME]", ",\n\t", "", "NOT PARTITION")%>
	        <%=myRef.getAllTargetColList(",", "cast([COL_NAME__EXPRESSION_IF_ON_TARGET] as [DEST_CRE_DT]) \tas [COL_NAME]", ",\n\t", "", "PARTITION")%>
	        <% /* work-around for HIVE-2421: partition variables are treated as strings during union queries, regardless of declared type */ %>
        from (	 
	  -- Select checked table data with coalesced key
	  select <%= /* first all non-partition columns */ myRef.getColList( "", "CT_INNER.[COL_NAME]", ",\n\t\t", "", "NOT PARTITION")%>
		<%= /* add coalesced key columns */ odiRef.getColList(",","coalesce( cast( CT_INNER.[COL_NAME] as string ), '<<<NULL>>>' ) \tas coalesced_[COL_NAME]", ",\n\t\t", "", "UK")%>  
		<%= /* then all partition columns */ myRef.getColList( ",", "CT_INNER.[COL_NAME]", ",\n\t\t", "", "PARTITION")%>
	  from <%=odiRef.getTable("L", "INT_NAME", "A")%> CT_INNER
        ) CT
        left outer join (
	  -- Create a list of unique, coalesced PKs/UKs, which are in the error table
	  select distinct 
		<%=odiRef.getColList("","coalesce( cast( E_INNER.[COL_NAME] as string ), '<<<NULL>>>' ) \tas coalesced_[COL_NAME]", ",\n\t\t", "", "UK")%>  
	  from <%=odiRef.getTable("L","ERR_NAME", "W")%> E_INNER
	  where
		ODI_ERR_TYPE	= '<%=snpRef.getInfo("CT_ERR_TYPE")%>'  and
		ODI_ORIGIN	= '<%=snpRef.getInfo("CT_ORIGIN")%>'  and
		<% if (isODI12cOrLater) 
		{%>ODI_SESS_NO = '<%=snpRef.getSession("SESS_GUID")%>'<% } else 
		{%>ODI_SESS_NO = <%=snpRef.getSession("SESS_NO")%><% } %>
        ) E
        on (	<%=odiRef.getColList("","(E.coalesced_[COL_NAME] = CT.coalesced_[COL_NAME])", " and\n\t", "", "UK")%> )
        where 	-- Copy only those rows, which are not in the error table
	<%=odiRef.getColList("","E.coalesced_[COL_NAME] is null", " and\n\t", "", "UK")%>  


       <%} else { /* Begin of: FLOW_CONTROL = 0 */ %>

       <% if (  singleDataSet ) { %>

	select 	<%=odiRef.getPop("DISTINCT_ROWS")%>
		<%= /* first all non-partition columns */ myRef.getAllTargetColList( "", "[EXPRESSION__NULL_IF_UNMAPPED] \tas [COL_NAME]", 
		",\n\t\t", "", "NOT PARTITION")%>
		<%= /* then all partition columns */ myRef.getAllTargetColList( ",", "[EXPRESSION__NULL_IF_UNMAPPED] \tas [COL_NAME]", 
		",\n\t\t", "", "PARTITION")%>
	from	<%=myRef.removeScriptInfo( odiRef.getFrom() )%>
	where	<% if (odiRef.getPop("HAS_JRN").equals("1")) { %>
		JRN_FLAG <> 'D'	<%} else {%>	(1=1)	<% } %>
	<%=odiRef.getJoin()%>
	<%=odiRef.getFilter()%>
	<%=odiRef.getJrnFilter()%>
	<%=odiRef.getGrpBy()%>
	<%=odiRef.getHaving()%>

        <% } else { /* Begin of: Multiple DataSets */ %>
	
	select	<%= /* first all non-partition columns */ myRef.getAllTargetColList( "", "[COL_NAME__EXPRESSION_IF_ON_TARGET] \tas [COL_NAME]", 
		",\n\t\t", "", "NOT PARTITION")%>
		<%= /* then all partition columns */ myRef.getAllTargetColList( ",", "[COL_NAME__EXPRESSION_IF_ON_TARGET] \tas [COL_NAME]", 
		",\n\t\t", "", "PARTITION")%>
	from 	-- Merge data from DataSet Operations
		(

        <%for (int i=odiRef.getDataSetMin(); i <= odiRef.getDataSetMax(); i++){%>
                <%=odiRef.getDataSet(i, "Operator")%>
		select 	<%=odiRef.getPop("DISTINCT_ROWS")%>
			<%=odiRef.getColList(i,"", "[EXPRESSION] [COL_NAME]", ",\n\t\t\t", "", "((INS and !TRG) and REW)")%> 
		from	<%=myRef.removeScriptInfo( odiRef.getFrom(i) )%>
		where	<% if (odiRef.getDataSet(i, "HAS_JRN").equals("1")) { %>
			JRN_FLAG <> 'D'	<%} else {%>	(1=1)	<% } %>
		<%=odiRef.getJoin(i)%>
		<%=odiRef.getFilter(i)%>
		<%=odiRef.getJrnFilter(i)%>
		<%=odiRef.getGrpBy(i)%>
		<%=odiRef.getHaving(i)%>
       <% } /* DataSet Loop */ %>

       ) <%=odiRef.getInfo("DEST_TAB_ALIAS_WORD")%> ODI_GET_FROM

       <% } /* End of: Multiple DataSets */ %>
       <% } /* End of: FLOW_CONTROL=0 */ %>	

       <% if ( mergeIntoTarget && legacyHive ) { %> 
       ) <%=odiRef.getInfo("DEST_TAB_ALIAS_WORD")%> ODI_GET_FROM_OUTER
       <% } %>	

      <%= /* add distribute expression to avoid unbalanced dynamic partition creation and resulting failures */ 
      myRef.getColList( "distribute by\t", "[COL_NAME]", ",", "", "PARTITION")%>

      <%=getQuotedMLString(endCapture())%>

      hive.executeQuery( sql )


     <% if ( mergeIntoTarget && legacyHive) { %> 

       // Drop old target table
       hive.executeQuery( '''drop table <%=odiRef.getTargetTable("RES_NAME")%>''')


       // Rename temp target to new target table
       hive.executeQuery( '''alter table <%=odiRef.getTargetTable("RES_NAME")%>_tmp rename to <%=odiRef.getTargetTable("RES_NAME")%>''' )
     
       <% /* Omitting the schema names to work-around  HIVE-2496. The correct code should be
       hive.executeQuery( '''alter table < %=targetName% > rename to < %=odiRef.getTargetTable("RES_NAME")% >''' ) */ %>

    <%} /* End of: mergeIntoTarget && legacyHive */ %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[605]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0e3b6fc6-c209-4640-a6c2-6838c15e653f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[337]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Cleanup journalized table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7f44d1b3-7fda-41a1-ba5d-71a910946c57]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[605]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if ("C".equals(odiRef.getJrnInfo( "JRN_METHOD"))) { %>
/* Consistant journalization detected. */
/* Lock should be done by a specific step in a package */
<% } else { %>
delete from	<%=odiRef.getTable("L","JRN_NAME","A")%>
where	JRN_CONSUMED = '1'
<%=odiRef.getJrnFilter()%>
<% } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[606]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d792c078-267f-4151-86f6-09f99c41623f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[338]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop flow table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d12477ee-8d44-416e-9886-82906d4a0e69]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[606]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<%if ( odiRef.getUserExit("DELETE_TEMPORARY_OBJECTS").equals("1") ) { %> 
hive.executeQuery( '''drop table if exists <%=odiRef.getTable("L", "INT_NAME", "A")%>''' )
<% } %>
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[607]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7ddf9bb6-742a-4e28-afea-0dcdf8bdf803]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[339]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[190]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete/ Undeclare any inline-view scripts]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a307f651-44aa-4d1a-9202-e87a49bff2f3]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[607]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[// Delete any scripts files created for any inline-views

import org.apache.hadoop.fs.FileSystem
import org.apache.hadoop.fs.Path
import org.apache.hadoop.conf.Configuration
import java.net.URI

<% { iter = myRef.getScriptInfo( odiRef.getFrom() ).iterator();
while ( iter.hasNext() ) { 
    scriptInfo = iter.next();
    scriptName = scriptInfo[0];
    scriptNameFull = scriptInfo[1];
    scriptText = scriptInfo[2]; 
%>

fileName = '''<%=scriptNameFull%>'''
script = <%=getQuotedMLString(scriptText)%>

// Did we create the script?
if ( script.length() > 0) {
    // Lets remove the script file again
    fs = FileSystem.get( new URI( fileName ),  new Configuration() )
    pt = new Path( fileName )
    fs.delete( pt, 0==1 )
}


// Undeclare transformation script file
hive.executeQuery( '''delete file <%=scriptNameFull%>''' )

<% }; } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[608]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c6176fc0-854e-4b42-92c8-a6bd528c9ce6]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[340]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[200]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[sub-select inline view]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9220e1b2-a032-4839-bf62-fdcae5c7ad7f]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[608]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[(
<%for (int i=odiRef.getDataSetMin(); i <= odiRef.getDataSetMax(); i++){%>
<%=odiRef.getDataSet(i, "Operator")%>
select 	<%=odiRef.getPop("DISTINCT_ROWS")%>
	<%=odiRef.getColList(i,"", "[EXPRESSION] [ALIAS_SEP] [COL_NAME]", ",\n\t", "", "")%>
from	<%=odiRef.getFrom(i)%>
where	(1=1)
<%=odiRef.getJoin(i)%>
<%=odiRef.getFilter(i)%>
<%=odiRef.getGrpBy(i)%>
<%=odiRef.getHaving(i)%>
<%}%>
)]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[609]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0c1bc295-89a8-4ac8-8807-c38707ebb374]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[341]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Drop flow table]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1e2c15f0-8c89-4a96-aa0d-46425c3da06a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[609]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[hive.executeQuery( '''drop table if exists <%=odiRef.getTable("L", "INT_NAME", "A")%>''' )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[610]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[99aba01a-3e1c-495b-b2fe-1c31147869be]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[342]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[73]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:31.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Post-integration control]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1bf5b8cf-2e81-4828-8cca-53cf5ec05415]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[610]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<%@ INCLUDE CKM_STATIC%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b7a02df0-3676-45bb-92ce-b013ec89d857]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[328]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b9d490e7-fb1b-4cd4-b95b-fbae90858086]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[328]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[174]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[44311943-c8bf-44b4-adee-490ef727ba31]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[328]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[173]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4074de5d-e9d1-4808-8155-5d5fb224df40]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[328]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[175]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[fa6f9e8e-ac97-40da-8f6a-84f161b19059]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[328]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[177]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[60cfa0c6-5675-440e-a426-814f60ec7f77]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[328]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[176]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[006cf314-3227-41e5-afcc-54fb583f9b13]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[329]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[f122cb67-bcc1-4fb4-9728-3e2b6d497cc1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[330]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ce7555ea-1615-4296-b9ce-a48d85777af5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[330]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[177]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b01ee48d-04a3-48c4-989c-ba9499c11fe9]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[330]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[175]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[2a9c10b3-3cbd-4729-bab1-40c50ab7c242]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[330]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[176]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[ec7ffbc0-c975-4e16-9a39-13d416d5e420]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[330]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[173]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[96af7385-8d3d-4e9e-b246-23d8725a867c]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[330]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[174]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[71a9843d-cde4-4d2c-bc11-ea845bbfb9c4]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[331]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[175]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[83477f8b-4aaa-4939-bde7-5add8300d267]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[332]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[3def9a92-552b-4b55-bec1-9dfcd54f81b3]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[333]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c14603dc-6dc0-402c-93ed-ef0eafdc3a9a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[333]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[174]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b1c48f32-0466-458c-8daa-677c8d1ce2bb]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[333]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[173]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b3826266-0b99-4383-844e-f94a33e41e1d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[333]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[175]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[32c812f7-2537-4d39-b78f-d0060f244d22]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[333]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[177]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[dc902e7b-9b12-4fb5-a918-a4d2c0e6e906]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[333]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[176]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[cb7c3212-e1b8-473b-a2a0-e62a6ed6755b]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[334]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[f3e172dc-803a-4047-8450-03546b993ece]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[335]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[112cd30e-ec96-4c64-bce2-5ceaf1220de5]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[336]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[176]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[2757831f-bbf0-458d-b057-ecbabf1cf48e]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[336]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[6d712644-6f9d-4fac-b084-b0c30c9168bf]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[336]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[173]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b6a41b97-edcb-4a7d-9c70-d5a89b1ec929]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[336]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[174]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[e9fbc43f-7ba9-403f-b2cf-6426df019fc9]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[336]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[175]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[f060180b-92b2-4ed4-9f54-f0e1d7c104bd]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[336]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[177]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4b94edae-73c9-474f-b70c-ecc17b5f91f9]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[337]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c61b82b1-3b97-4ecb-9796-d99139bfc96f]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[337]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[174]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[83c54e04-7d4e-41e8-8889-266b2c01f6e3]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[337]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[173]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[9f60a784-16f9-48d2-bd2f-4a7e38aab4e1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[337]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[175]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c448b531-b5cd-460e-968e-896758f5a849]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[337]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[177]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[63de267b-4407-445d-b8f3-6ec97fbd0ae3]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[337]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[176]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[9e58b854-f166-4eb4-a217-8cb2bd95ac82]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[338]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[2d0e7655-8aee-4dda-96a3-16a5cdacfa61]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[339]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[177]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[97dd7299-c24f-47c9-ba6c-15a88834538c]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[340]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c935a42c-7a71-434c-a76d-c8afdb5a9d9f]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[340]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[174]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[d93dfb47-0b66-4096-9ef9-018725c3d6ca]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[340]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[173]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[da811382-8741-40cf-8197-a9881687035a]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[340]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[175]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[d7e70b5a-ec78-457f-a1ca-3c4fe7d28348]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[340]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[177]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[f48aabae-0cfe-4603-a422-3dc2a6bc97c3]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[340]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[176]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[c34b3703-2456-4d4b-9b5d-c40dba3209b1]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[341]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[172]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[9f201c8b-68e3-4617-b3f0-c1e96b83d393]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[342]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[6928]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[174]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="BaseKmType" type="java.lang.String">null</Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GenType" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9da73d07-4325-4ffb-ad35-2ea16060d611]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="IsConcurrent" type="java.lang.String">null</Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[611]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmDefault" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="KmVersion" type="java.lang.String"><![CDATA[9]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:36.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[2030472862]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[IKM Hive Transform]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[KI]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp"><![CDATA[2009-04-17 16:17:44.0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3f0d287a-d5a0-44ba-90e0-aca9b5322122]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[611]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[COMPONENT NAME: IKM Hive Transform
AUTHOR: Oracle

DESCRIPTION
	This KM integrates data into a Hive target table in replace mode after 
	the data has been transformed by a shell script. It can be used as an inline-view for "IKM Hive Control Append".

REQUIREMENTS
	- The transformation script must expect the input columns in the order defined by the source datastore.
	   Only mapped source columns are streamed into the transformation script.
	- The transformation script must provide the output columns in the order defined by the target datastore
	   Exception: 
	   if the target is a physical table and this table is partitioned, then partition columns must be located 
	   at the end of the column list.
	- The transformation script must provide as many output columns as the target datastore has columns.
	   No matter, whether all target columns have mappings or not.
	- CDH3: The hadoop-core.jar must be on ODI class path.
	- CDH4: $HADOOP_HOME/client/* must be on ODI class path and use same version as Hadoop cluster
	- hadoop configuration directory must be on ODI class path (containing e.g. core-default.xml, core-site.xml, hdfs-site.xml)
	- UNIX environment variable ODI_HIVE_SESSION_JARS must contain hive-contrib.jar, if RegExSerDe used anywhere; 
	- Please see KM options for further requirements

OPTIONS (Refer to Option descriptions for more information on each option)
	- CREATE_TARG_TABLE: Create target table?
	- DELETE_TEMPORARY_OBJECTS: Remove temporary objects after execution?
	- TRANSFORM_SCRIPT_NAME: script file name
	- TRANSFORM_SCRIPT: script content
	- PRE_TRANSFORM_DISTRIBUTE: distribute data before transformation
	- PRE_TRANSFORM_SORT: sort data before transformation
	- POST_TRANSFORM_DISTRIBUTE: distribute data after transformation
	- POST_TRANSFORM_SORT: sort data after transformation

LIMITATIONS
	- Only single source table or source inline-view allowed
	- Only straight mappings allowed
	- No support for datasets, joins, lookups, filters neither CDC
	- Any inline-view source must use either "IKM Hive Control Append" and "IKM Hive Transform".
	- Row counter/ insert counter does not reflect number of rows loaded
	- If used as an inline-view all limitations/requirements also apply to the main interface
	- All table aliases used in an interface and any of its inlive-view interfaces must be unique

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d0f66722-3dbb-4e02-abb8-54ac2d9300b6]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[612]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[179]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[CREATE_TARG_TABLE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Create the target table.]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9cafda28-1b2d-4d29-9ce3-0ac17a148245]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[612]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Check this option if you wish to create the target table ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a86815df-61ce-4e0f-83d8-8ab59d575aeb]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[613]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[290]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[DELETE_TEMPORARY_OBJECTS]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Delete temp objects post int]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[C]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[0e338e71-9d29-4302-bb0c-953d88fd3727]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[613]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Set this option to NO if you wish to retain temporary objects (tables, files and scripts) after integration.
Useful for debugging.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[96e2dea3-a959-4441-b3ae-d4e8c2b9fcd0]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[614]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[181]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[500]]></Field>
	<Field name="ShortValue" type="java.lang.String"><![CDATA[<Please specify your script file name here>]]></Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[TRANSFORM_SCRIPT_NAME]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[path+filename of transform script]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3f748c0b-9ad4-4c39-a18e-eaadd6a9bf05]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[614]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This option defines the file name of the transformation script. This transformation script is then used to transform the input data into the output structure.

Both local and HDFS paths are supported. E.g.
Local script: file:///tmp/script1.pl
hdfs script location: hdfs://namenode:nnPort/tmp/script1.pl

Note 1: this path/file must be accessible by both the ODI agent and the Hive server.
Note 2: in case TRANSFORM_SCRIPT is set the path/file must be writeable for the ODI agent.
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7145d41f-b277-4f1f-a2c7-c1ae7d13f495]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[615]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[182]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[510]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[TRANSFORM_SCRIPT]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Transformation script content]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[T]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[82662be7-356c-47ce-81b6-24fc0fd13d7b]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[615]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This optional option defines the transformation script content. This transformation script is then used to transform the input data into the output structure.

If left blank, the file given in TRANSFORM_SCRIPT_NAME must already exist. 
If not blank, the script file is created.

Script example (1-to-1 transformation):
#! /usr/bin/csh -f
cat

All mapped source columns are spooled as tab separated data into this script via stdin. This unix script then transforms the data and writes out the data as tab separated data on stdout. The script must provide as many output columns as there are target columns.
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8a2ca40c-b954-4f2c-a02d-dd14b8654f0c]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[616]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[183]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[600]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[PRE_TRANSFORM_DISTRIBUTE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Source columns to redistribute data]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b83c1359-9950-42b3-a2d8-634ac777e4b9]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[616]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This optional comma-separated list of source column names allows to distribute the data before the transformation script is applied.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a9b287c7-73e7-43e3-a9de-6fc1d843f73f]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[617]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[184]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[610]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[PRE_TRANSFORM_SORT]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Source columns to sort data on]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[af5e4fdc-1712-44ec-81e4-1d58b1040f47]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[617]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This optional comma-separated list of source column names allows to sort the data before the transformation script is applied.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c6effc62-61b5-4f6c-b84e-dfc66863fc0f]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[618]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[185]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[620]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[POST_TRANSFORM_DISTRIBUTE]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Target columns to redistribute data]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[08d4a718-250c-410c-991c-63853faf1d04]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[618]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This optional comma-separated list of target column names allows to distribute the data after the transformation script has been applied.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpUserExit">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[64a635df-6b81-462e-8721-917e6a673487]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="ITxtUeHelp" type="com.sunopsis.sql.DbInt"><![CDATA[619]]></Field>
	<Field name="ITxtValue" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[186]]></Field>
	<Field name="Position" type="com.sunopsis.sql.DbInt"><![CDATA[630]]></Field>
	<Field name="ShortValue" type="java.lang.String">null</Field>
	<Field name="Subtypes" type="java.lang.String">null</Field>
	<Field name="UeName" type="java.lang.String"><![CDATA[POST_TRANSFORM_SORT]]></Field>
	<Field name="UeSdesc" type="java.lang.String"><![CDATA[Target columns to sort data on]]></Field>
	<Field name="UeType" type="java.lang.String"><![CDATA[V]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[39beb1d4-a54d-4295-819b-557a84cad289]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[619]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[111]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[This optional comma-separated list of target column names allows to sort the data after the transformation script has been applied.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[620]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2a8449b2-0c97-498a-a973-59fa78b05ff1]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[343]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Prepare Hive session]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d28c48d1-b980-4ac7-a810-b2a8b6bc8beb]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[620]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% /* -------- Begin of block ----- Keep this block in sync across all Hive KMs ----------- */ %>
<%

/* Begin of BSh code gen extensions */

out2 = null;
buffer = null;

startCapture() {
    out2 = out;
    buffer = new ByteArrayOutputStream();
    out = new PrintWriter( buffer );
}

endCapture() {
    out.flush();
    out.close();
    captured = buffer.toString();
    out = out2;
    return captured;
}

getQuotedMLString( s ) {
// escape tripple single quotes
// escape backslashes
    return 
        "'''" + 
        s.replace(""+(char)92, ""+(char)92+(char)92)
        .replace( "'''", ""+(char)92+"'"+(char)92+"'"+(char)92+"'") +
        "'''";
}

/* End of BSh code gen extensions */

%>


<% /* Begin of Hive Runtime-API */ %>

import java.lang.System
import java.sql.Statement
import java.sql.Connection
import java.sql.SQLException


class flexUtilHive {
    Statement stmt;
    public Connection con;

    flexUtilHive( Connection pCon ) {
        con = pCon
        if (con == null) 
            throw new RuntimeException( "\nFailure to open JDBC connection. Please test DataServer connection." );


        // Set session parameters for dynamic partitions
        stmt = con.createStatement()
        stmt.execute( """set hive.exec.dynamic.partition=true""" )
        stmt.execute( """set hive.exec.dynamic.partition.mode=nonstrict""" )
        stmt.execute( """set hive.enforce.bucketing=true""" )
        stmt.execute( """set hive.optimize.bucketmapjoin=true""" )
        //stmt.execute( """set mapred.job.reuse.jvm.num.tasks=-1""" )
        // Add custom jars to this Hive session
        String sExtraJars = """<?=(System.getenv("ODI_HIVE_SESSION_JARS")!=null)?System.getenv("ODI_HIVE_SESSION_JARS"):""?>"""
        if (sExtraJars != "") {
            def lstExtraJars = sExtraJars.split( ":" )
            for (j in lstExtraJars) {
                stmt.execute( """add jar """ + j )
            }
        }
    }

    // Function for executing Hive SQL statements
    def executeQuery( String sql ) {
        try {
            stmt.executeUpdate( sql )
        } catch (SQLException re) {
            def msg = "Exception encountered while submitting: \n-------------------\n" + sql + "\n-------------------"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

    // Check if a table already exists
    def tableExists( String schema, String table ) {
        try {
            def dbm = con.getMetaData()
            def rs = dbm.getTables(null, schema.toLowerCase(), table.toLowerCase(), null)
            return rs.next()
        } catch (SQLException re) {
            def msg = "Exception encountered while checking existence of table "+schema+"."+table+" !"
            def count = 1
            def e = re
            while (e != null) {
                msg += "\n" + e.getMessage()
                e = e.getNextException()
                count += 1
            }
            throw new SQLException( msg )
        }
    }

}

<% /* End of hive Runtime-API */ %>


<%

// Is there already an API defined?
if (IkmHiveApi != void) {

    // Verify correct version and error out, if not
    if (IkmHiveApi.getVersion() != 1) 
        out.print( "<? throw new RuntimeException( \u0022\u0022+(char)10+(char)10+(char)10+\u0022You are using Hive KMs from different versions. Please make sure to use all Hive KMs from the same ODI version/patch.\u0022+(char)10+(char)10+(char)10 );?>");

} else {

/* Begin of IkmHiveApi.java */

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;

import com.sun.org.apache.xpath.internal.Expression;


public class IkmHiveApi {
	public static final String DELIMITER = ""+(char)1;
	public static final String RE_Q = ""+(char)92+"Q";
	public static final String RE_E = ""+(char)92+"E";

	       static final String MISSING_FLEXFIELD_GETCOLLIST = "Exception getColList(";
           static final String MISSING_FLEXFIELD_GETINFO = "Exception getInfo(";
           static final String EXPRESSION_NOT_SUPPORTED = "[EXPRESSION] not supported in getAllTargetColList";
	       static final String DELIMITER_REGEX = RE_Q+ DELIMITER +RE_E;
	public static final String SELECTOR_PARTITION =              "PARTITION";
	public static final String SELECTOR_NOT_PARTITION =          "NOT PARTITION";
    public static final String SELECTOR_PARTITION_COND1 =        "PARTITION AND (UNMAPPED OR TARGET)";
    public static final String SELECTOR_CLUSTER =                "CLUSTER";
	public static final String SELECTOR_PARTITION_OR_CLUSTER =   "PARTITION OR CLUSTER";
    public static final String SELECTOR_SORT =                   "SORT";
           static final String PATTERN_COL_NAME = "[COL_NAME]";
           static final String PATTERN_DEST_CRE_DT = "[DEST_CRE_DT]";
           static final String PATTERN_EXPRESSION = "[EXPRESSION]";
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED =      "[EXPRESSION__NULL_IF_UNMAPPED]";
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET = "[COL_NAME__EXPRESSION_IF_ON_TARGET]";
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET =       "[COL_NAME__NULL_IF_ON_TARGET]";
           static final String PATTERN_MAPPED_ON_TARGET =                  "[MAPPED_ON_TARGET]";
           static final String PATTERN_UNMAPPED =                          "[UNMAPPED]";
           /*static final String PATTERN_COL_NAME_REGEX = RE_Q+ PATTERN_COL_NAME +RE_E;
           static final String PATTERN_DEST_CRE_DT_REGEX = RE_Q+ PATTERN_DEST_CRE_DT +RE_E;
           static final String PATTERN_EXPRESSION_REGEX = RE_Q+ PATTERN_EXPRESSION +RE_E;
           static final String PATTERN_EXPRESSION__NULL_IF_UNMAPPED_REGEX = RE_Q+ PATTERN_EXPRESSION__NULL_IF_UNMAPPED +RE_E;
           static final String PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET +RE_E;
           static final String PATTERN_COL_NAME__NULL_IF_ON_TARGET_REGEX = RE_Q+ PATTERN_COL_NAME__NULL_IF_ON_TARGET +RE_E;
           static final String PATTERN_MAPPED_ON_TARGET_REGEX = RE_Q+ PATTERN_MAPPED_ON_TARGET +RE_E;
           */
	       
           static final String MARKER_SCRIPTNAME = "SNP$SCRIPTNAME";
           static final String MARKER_SCRIPTFULLNAME = "SNP$SCRIPTFULLNAME";
           static final String MARKER_SCRIPT = "SNP$SCRIPTTEXT";
           static final String MARKER_SCRIPTEND = "SNP$SCRIPTTEXTEND";
	
	LinkedHashMap 
	    cols,          // contains all columns (getColList)
	    allTargetCols; // contains all columns including the target columns (getAllTargetColList)
	String buckets;    // contains the number of buckets for this target

	private class ColInfo {
		static final String PROP_TRG = "TRG";
		static final String PROP_UD1 = "UD1";
		static final String PROP_UD2 = "UD2";
		static final String PROP_UD3 = "UD3";
		static final String PROP_FF_PART = "PART";
		static final String PROP_FF_CLUST = "CUST";
		static final String PROP_FF_SORT = "SORT";
		
		String colName, colDt, colExpr;
		boolean bTarget, bUd1, bUd2, bUd3, bFlexPartCol, bFlexClustCol, bFlexSortCol = false;
		
		public ColInfo( String pColName, String pColDt, String pColExpr, boolean pIsPartCol, boolean pIsClustCol, boolean pIsSortCol ) {
			colName = pColName;
			colDt   = pColDt;
			colExpr = pColExpr;
			bFlexPartCol = pIsPartCol;
            bFlexClustCol = pIsClustCol;
            bFlexSortCol = pIsSortCol;
		}
		public void set( String pProperty, boolean v )		{ 
			if      ( pProperty == PROP_TRG ) 	bTarget = v;
			else if ( pProperty == PROP_UD1 ) 	bUd1 = v;
			else if ( pProperty == PROP_UD2 ) 	bUd2 = v;
			else if ( pProperty == PROP_UD3 ) 	bUd3 = v;
			else if ( pProperty == PROP_FF_PART )	bFlexPartCol  = v;
			else if ( pProperty == PROP_FF_CLUST )  bFlexClustCol = v;
			else if ( pProperty == PROP_FF_SORT )	bFlexSortCol  = v;
		};
		public String getColName() { return colName; }
		public String getDataType() { return colDt; }
		public String getExpression() { return colExpr; }
		public boolean isTarget() { return bTarget; }
		public boolean isMapped() { return !colExpr.equals(EXPRESSION_NOT_SUPPORTED) && colExpr.trim().length()>0; };
		public boolean isUd1() { return bUd1; }
		public boolean isUd2() { return bUd2; }
		public boolean isUd3() { return bUd3; }
		public boolean isPartitionBy() { return bFlexPartCol; }
        public boolean isClusterBy() { return bFlexClustCol; }
        public boolean isSortBy() { return bFlexSortCol; }
	}

	// Return the version of the code gen API. 
	// Used for testing that all KMs in a session are using the same API version
	public static int getVersion() {
	    return 1;
	}
	
	public String initMetadata(
	        boolean dumpMetadata,
			String pAllCols,
			String pAllDts,
			String pAllExpr,
			String pTrgCols,
			String pUd1Cols,
			String pUd2Cols,
			String pUd3Cols,
			String pAllPartCols,
			String pAllClustCols,
			String pAllSortCols,
            String pAllTrgCols,
            String pAllTrgDts,
            String pAllTrgPartCols,
            String pAllTrgClustCols,
            String pAllTrgSortCols,
            String pKMOptionBuckets,
            String pFFBuckets
			) {	    
	    if (dumpMetadata) {
	        String pre = ""+(char)34;
	        String post = ""+(char)34+","+(char)10;
	        return 
            "/* inst.initMetadata("+(char)10+
            "false,"+(char)10+
            pre+pAllCols+post+
            pre+pAllDts+post+
            pre+pAllExpr+post+
            pre+pTrgCols+post+
            pre+pUd1Cols+post+
            pre+pUd2Cols+post+
            pre+pUd3Cols+post+
            pre+pAllPartCols+post+
            pre+pAllClustCols+post+
            pre+pAllSortCols+post+
            pre+pAllTrgCols+post+
            pre+pAllTrgDts+post+
            pre+pAllTrgPartCols+post+
            pre+pAllTrgClustCols+post+
            pre+pAllTrgSortCols+post+
            pre+pKMOptionBuckets+post+
            pre+pFFBuckets+(char)34+(char)10+
            "); */";
	    };
	    
        /* TODO: Sort cols still needs to be implemented */
		String[] allCols         = pAllCols.split(DELIMITER_REGEX,-1);
		String[] allDts          = pAllDts.split(DELIMITER_REGEX,-1);
		String[] allExpr         = pAllExpr.split(DELIMITER_REGEX,-1);
		String[] allPartCols     = pAllPartCols.split(DELIMITER_REGEX,-1);
		String[] allClustCols    = pAllClustCols.split(DELIMITER_REGEX,-1);
        String[] allSortCols     = pAllSortCols.split(DELIMITER_REGEX,-1);
        String[] allTrgCols      = pAllTrgCols.split(DELIMITER_REGEX,-1);
        String[] allTrgDts       = pAllTrgDts.split(DELIMITER_REGEX,-1);
        String[] allTrgPartCols  = pAllTrgPartCols.split(DELIMITER_REGEX,-1);
        String[] allTrgClustCols = pAllTrgClustCols.split(DELIMITER_REGEX,-1);
        String[] allTrgSortCols  = pAllTrgSortCols.split(DELIMITER_REGEX,-1);
		
		/* Create all column objects */
        cols = new LinkedHashMap();
	    for(int j=0; j<allCols.length; j++){
	        String  colName    = allCols[j];
	        String  colDt      = allDts[j];
	        String  colExpr    = allExpr[j];
        	boolean isPartCol  = false;
            boolean isClustCol = false; 
            boolean isSortCol  = false; 
	        /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
	           and must be ignored. */
	        if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isPartCol  = (allPartCols[j].equals("0"))? false : true;
	        }
	        if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
	        	isClustCol = (allClustCols[j].equals("0"))? false : true; 
	        }
            if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                isSortCol = (allSortCols[j].equals("0"))? false : true; 
            }
	        cols.put(colName, new ColInfo( colName, colDt, colExpr, isPartCol, isClustCol, isSortCol ) );
	    };
	    set( cols, ColInfo.PROP_TRG, pTrgCols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD1, pUd1Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD2, pUd2Cols.split(DELIMITER_REGEX) );
	    set( cols, ColInfo.PROP_UD3, pUd3Cols.split(DELIMITER_REGEX) );

	    /* Create allTargetCols list */
        allTargetCols = new LinkedHashMap();
        for(int j=0; j<allTrgCols.length; j++){
            String  colName    = allTrgCols[j];
            // Does this column already exist in cols ?
            ColInfo colObj = (ColInfo) cols.get( colName );
            if ( colObj != null )
                // then lets copy it
                allTargetCols.put( colName, colObj );
            else {
                // otherwise it's a column without any mapping and we need to create a new ColInfo Object for it
                String  colDt      = allTrgDts[j];
                boolean isPartCol  = false;
                boolean isClustCol = false; 
                boolean isSortCol = false; 
                /* in case of a temporary target table, all FlexField based parameters will contain an invalid value 
                   and must be ignored. */
                if ( !pAllPartCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isPartCol  = (allTrgPartCols[j].equals("0"))? false : true;
                }
                if ( !pAllClustCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isClustCol = (allTrgClustCols[j].equals("0"))? false : true; 
                }
                if ( !pAllSortCols.startsWith(MISSING_FLEXFIELD_GETCOLLIST)) {
                    isSortCol = (allTrgSortCols[j].equals("0"))? false : true; 
                }
                allTargetCols.put(colName, new ColInfo( colName, colDt, EXPRESSION_NOT_SUPPORTED, isPartCol, isClustCol, isSortCol ) );
            };

        };
        
        /* Process buckets information */
        buckets = "";
        if ( pFFBuckets.length() > 0 && !pFFBuckets.startsWith(MISSING_FLEXFIELD_GETINFO) )
            buckets = pFFBuckets;
        if ( pKMOptionBuckets.length() > 0 )
            buckets = pKMOptionBuckets;
        
        return "";
	}
	
	/**
	 * Set property pField (UD1, UD2 etc) for all columns listed in pCols
	 * @param pAllCols
	 * @param pField
	 * @param pCols
	 */
	static void set( HashMap pAllCols, String pProperty, String[] pCols ){
		/* Check, if pCols just contains a single empty string */
		if ( pCols.length == 1 && pCols[0].length() == 0 ) return;
		/* Loop over all columns and set the respective property */
	    for(int j=0; j<pCols.length; j++){
	        String colName = pCols[j];
	    	ColInfo col = (ColInfo) pAllCols.get( colName );
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) throw new RuntimeException( "IKM Hive Control Append: set(): Internal Error: Cannot find column: " + colName );
	    	col.set( pProperty, true );
	    };			
	}
	
    public String getColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( cols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    public String getAllTargetColList(
            String pStart,
            String pPattern,
            String pSeparator,
            String pEnd,
            String pSelector) {
        return getColList( allTargetCols, pStart, pPattern, pSeparator, pEnd, pSelector );
    }

    static private String getColList(
            LinkedHashMap cols,
			String pStart,
			String pPattern,
			String pSeparator,
			String pEnd,
			String pSelector) {
		StringBuffer rv = new StringBuffer();
		if ( ! (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) ||
						pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) ||
                        pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) ||
                        pSelector.toUpperCase().equals( SELECTOR_SORT ) )) {
		    String msg = "IKM Hive Control Append: getColList(): invalid selector received: " + pSelector;
			/* Not yet supported in ODI 11.1.1.6.0:
			 * throw new RuntimeException( msg ); 
			 */
			return msg;
    }
        Iterator iter = cols.keySet().iterator();       
        while(iter. hasNext()){
        	String colName = (String) iter.next();
        	ColInfo col = (ColInfo) cols.get( colName );
        	
	    	/* Avoid NPE in case of an invalid input string => column not found, e.g. in case of an invalid initialization string passed to initMetadata */  
	    	if (col == null) {
	    	    String msg = "IKM Hive Control Append: getColList(): Internal Error: Cannot find column: " + colName;
	    	    /* Not yet supported in ODI 11.1.1.6.0:
	    	     * throw new RuntimeException( msg );
	    	     */
	    	    return msg;
	    	}
	    	    
            /* Does the column match the selector? */
            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isPartitionBy()) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_COND1 ) &&          (col.isPartitionBy() && (!col.isMapped() || col.isTarget())) ) ||
                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isPartitionBy() || col.isClusterBy()) ) || 
                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isSortBy()) ) || 
                    (pSelector.toUpperCase().equals( "" )) 
//            if (    (pSelector.toUpperCase().equals( SELECTOR_PARTITION ) &&                (col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_NOT_PARTITION ) &&            !(col.isUd1() || col.isPartitionBy()) ) ||
//                    (pSelector.toUpperCase().equals( SELECTOR_CLUSTER ) &&                  (col.isUd2() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_PARTITION_OR_CLUSTER ) &&     (col.isUd1() || col.isUd2() || col.isPartitionBy() || col.isClusterBy()) ) || 
//                    (pSelector.toUpperCase().equals( SELECTOR_SORT ) &&                     (col.isUd3() || col.isSortBy()) ) || 
//                    (pSelector.toUpperCase().equals( "" )) 
        	) {
        		String s = pPattern;
        		/* Replace all patterns with their respective values */
        		s = s.replace( PATTERN_COL_NAME, col.getColName() );
        		s = s.replace( PATTERN_DEST_CRE_DT, col.getDataType() );
                s = s.replace( PATTERN_EXPRESSION, col.getExpression() );
                /* Handle EXPRESSION__NULL_IF_UNMAPPED_REGEX */
        		if (col.getExpression().equals(EXPRESSION_NOT_SUPPORTED)) {
        		    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, "cast(null as "+col.getDataType()+")" );
        		    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
        		} else {
                    s = s.replace( PATTERN_EXPRESSION__NULL_IF_UNMAPPED, col.getExpression() );        		    
        		}
                /* Handle MAPPED_ON_TARGET */
                s = s.replace( PATTERN_MAPPED_ON_TARGET, (col.isTarget())?"1":"0" );
                
                /* Handle UNMAPPED */
                s = s.replace( PATTERN_UNMAPPED, (!col.isMapped())?"1":"0" );
                
                /* Handle COL_NAME__EXPRESSION_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__EXPRESSION_IF_ON_TARGET, 
                        (col.isTarget())?col.getExpression():
                            ((!col.isMapped())?
                                    "cast(null as "+col.getDataType()+")":
                                    /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                                    col.getColName())
                );
        		
                /* Handle COL_NAME__NULL_IF_ON_TARGET */
                s = s.replace( PATTERN_COL_NAME__NULL_IF_ON_TARGET, 
                        (col.isTarget() || !col.isMapped())?
                            "cast(null as "+col.getDataType()+")" :
                            /* cast is required to work-around HIVE-2305 UNION ALL on different types throws runtime exception */
                            col.getColName()
                );
                
                /* Add separator for second and later columns */
        		if ( rv.length() > 0 )
        		  rv.append(pSeparator);
        		rv.append( s );

        	}
        }
		/* if any columns selected, insert/append pStart/pEnd */ 
		if (rv.length() > 0) {
			rv.insert(0, pStart);
			rv.append( pEnd );
		};
		/* return buffer after unescaping control characters */
		return rv.toString()
			.replaceAll( ""+(char)92+"Q"+(char)92+"n"+(char)92+"E", ""+(char)10 )
			.replaceAll( ""+(char)92+"Q"+(char)92+"t"+(char)92+"E", ""+(char)9 );
	}
    
    public String getBuckets(
            String pBefore,
            String pAfter) {
        /* Does this target have any cluster by columns ? */
        boolean isTargetClustered = (getAllTargetColList("","X","","",SELECTOR_CLUSTER).length()>0);
        return isTargetClustered ? (pBefore + buckets + pAfter) : "";
    }
    
    public static List getScriptInfo( String getFrom ) {
        String s = getFrom;
        List lst = new ArrayList();
        while ( s.indexOf( MARKER_SCRIPTNAME ) > -1 ) {
            int beginName     = s.indexOf( MARKER_SCRIPTNAME );
            int endName       = s.indexOf( MARKER_SCRIPTFULLNAME);
            int beginFullName = endName + MARKER_SCRIPTFULLNAME.length();
            int endFullName   = s.indexOf( MARKER_SCRIPT );
            int beginScript   = endFullName + MARKER_SCRIPT.length();
            int endScript     = s.indexOf( MARKER_SCRIPTEND );
            lst.add( new String[] {s.substring(beginName + MARKER_SCRIPTNAME.length(), endName), 
                                   s.substring(beginFullName, endFullName), 
                                   s.substring(beginScript, endScript)} );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return lst;
    }
    
    public static String removeScriptInfo( String getFrom ) {
        String s = getFrom;
        while ( s.indexOf( MARKER_SCRIPT ) > -1 ) {
            int beginName = s.indexOf( MARKER_SCRIPTNAME );
            int endScript = s.indexOf( MARKER_SCRIPTEND );
            s = s.substring(0, beginName) + s.substring( endScript + MARKER_SCRIPTEND.length() );
        }
        return s;
    }
        
	/**
	 * Some test stub
	 */
	public static void main(String[] args) {
	    
		/* getColList: Test for a permanent interface */
		IkmHiveApi inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"", 
				"", 
				"", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0", 
				"0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0", 
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$1",
                "",
                "4"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
		System.out.println();
		System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println("------------------------------"); 

		/* getColList: Test for a temporary interface */
		inst = new IkmHiveApi();
		inst.initMetadata( 
				false,
				"sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
				"STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
				"IKM_HIVE_CTL_APP_TEST001.sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$count( IKM_HIVE_CTL_APP_TEST001.dear )$$SUNOPSIS$$1$$SUNOPSIS$$max(IKM_HIVE_CTL_APP_TEST001.sales_last_name)", 
				"", 
				"sales_pers_id", 
				"sales_pers_id", 
				"sales_last_name", 
				"Exception getColList(...)", 
				"Exception getColList(...)", 
				"Exception getColList(...)",
                "first_column_unmapped$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear_cnt$$SUNOPSIS$$1$$SUNOPSIS$$sales_last_name", 
                "BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$BIGINT$$SUNOPSIS$$1$$SUNOPSIS$$STRING", 
                "Exception getColList(...)", 
                "Exception getColList(...)", 
                "Exception getColList(...)",
                "4",
                "Exception getInfo(...)"
			);
		System.out.println( inst.getColList("", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("partition by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("not partition: ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "NOT PARTITION") );
        System.out.println();
        System.out.println( inst.getAllTargetColList("sort by ", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", "", "SORT") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println("------------------------------"); 
        
        /* my test case */
        inst = new IkmHiveApi();
        inst.initMetadata(
                false,
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.TABLE_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CUSTID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.LAST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.FIRST_NAME$$SUNOPSIS$$1$$SUNOPSIS$$CUS.AGE$$SUNOPSIS$$1$$SUNOPSIS$$CUS.CITY_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.SALES_PERS_ID$$SUNOPSIS$$1$$SUNOPSIS$$CUS.DEAR$$SUNOPSIS$$1$$SUNOPSIS$$CUS.ADDRESS$$SUNOPSIS$$1$$SUNOPSIS$$CUS.PHONE",
                "",
                "",
                "dear",
                "",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "part_col1$$SUNOPSIS$$1$$SUNOPSIS$$table_name$$SUNOPSIS$$1$$SUNOPSIS$$custid$$SUNOPSIS$$1$$SUNOPSIS$$last_name$$SUNOPSIS$$1$$SUNOPSIS$$first_name$$SUNOPSIS$$1$$SUNOPSIS$$age$$SUNOPSIS$$1$$SUNOPSIS$$city_id$$SUNOPSIS$$1$$SUNOPSIS$$sales_pers_id$$SUNOPSIS$$1$$SUNOPSIS$$dear$$SUNOPSIS$$1$$SUNOPSIS$$address$$SUNOPSIS$$1$$SUNOPSIS$$phone",
                "STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING$$SUNOPSIS$$1$$SUNOPSIS$$STRING",
                "1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0$$SUNOPSIS$$1$$SUNOPSIS$$0",
                "",
                "4"
                );
        System.out.println( inst.getColList("partition by (", "[COL_NAME]\t[EXPRESSION]\t[COL_NAME__EXPRESSION_IF_ON_TARGET]", ",\n", ")", "PARTITION") );
        System.out.println( inst.getAllTargetColList("partition or cluster by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "PARTITION OR CLUSTER") );
        System.out.println( inst.getAllTargetColList("not partition by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "NOT PARTITION") );
        System.out.println( inst.getBuckets( "into ", " buckets") );
        System.out.println( inst.getAllTargetColList("sort by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n", ")", "SORT") );
        System.out.println("------------------------------"); 

        String getFrom = "select c1, c2, c3 from ( select c4, c5, c6 from (T1" + MARKER_SCRIPTNAME + "trafo1.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo1.pl" + MARKER_SCRIPT + "my script 1" + MARKER_SCRIPTEND + ") ODI_FROM, T2" +
                         MARKER_SCRIPTNAME + "trafo2.pl" + MARKER_SCRIPTFULLNAME + "/tmp/odi/trafo2.pl" + MARKER_SCRIPT + "my script 2" + MARKER_SCRIPTEND + ")";
        Iterator iter = getScriptInfo(getFrom).iterator();
        /* List scripts */
        while (iter.hasNext()) {
            String[] script = (String[])iter.next();
            System.out.println( script[0] + " : " + script[1] + " : " + script[2] ); 
        }
        System.out.println("------------------------------"); 
        System.out.println( removeScriptInfo(getFrom) ); 
        System.out.println("------------------------------"); 

	}

}

/* End of IkmHiveApi.java */

};

%>
<% /* -------- End of block ----- Keep this block in sync across all Hive KMs ----------- */ %>


<%
/* Pass metadata into KM specific code generation */
myRef = new IkmHiveApi();

String sColList_HIVE_PARTITION_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sColList_HIVE_CLUSTER_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sColList_HIVE_SORT_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_PARTITION_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_CLUSTER_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetColList_HIVE_SORT_COLUMN = IkmHiveApi.MISSING_FLEXFIELD_GETCOLLIST; 
String sTargetTable_HIVE_BUCKETS = IkmHiveApi.MISSING_FLEXFIELD_GETINFO;

try { 
  sColList_HIVE_PARTITION_COLUMN = odiRef.getColList("", "[HIVE_PARTITION_COLUMN]", ""+(char)1, "", ""); 
  sColList_HIVE_CLUSTER_COLUMN = odiRef.getColList("", "[HIVE_CLUSTER_COLUMN]", ""+(char)1, "", ""); 
  sColList_HIVE_SORT_COLUMN = odiRef.getColList("", "[HIVE_SORT_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_PARTITION_COLUMN = odiRef.getAllTargetColList("", "[HIVE_PARTITION_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_CLUSTER_COLUMN = odiRef.getAllTargetColList("", "[HIVE_CLUSTER_COLUMN]", ""+(char)1, "", ""); 
  sTargetColList_HIVE_SORT_COLUMN = odiRef.getAllTargetColList("", "[HIVE_SORT_COLUMN]", ""+(char)1, "", ""); 
  sTargetTable_HIVE_BUCKETS = odiRef.getTargetTable("HIVE_BUCKETS"); 
} catch (Exception e) {} 

out.print(myRef.initMetadata( 
	false,
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, ""), 
	odiRef.getColList("", "[DEST_CRE_DT]", ""+(char)1, ""), 
	odiRef.getColList("", "[EXPRESSION]", ""+(char)1, ""), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "TRG"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD1"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD2"), 
	odiRef.getColList("", "[COL_NAME]", ""+(char)1, "", "UD3"), 
	sColList_HIVE_PARTITION_COLUMN, 
	sColList_HIVE_CLUSTER_COLUMN, 
	sColList_HIVE_SORT_COLUMN,
	odiRef.getAllTargetColList("", "[COL_NAME]", ""+(char)1, ""), 
	odiRef.getAllTargetColList("", "[DEST_CRE_DT]", ""+(char)1, ""), 
	sTargetColList_HIVE_PARTITION_COLUMN, 
	sTargetColList_HIVE_CLUSTER_COLUMN, 
	sTargetColList_HIVE_SORT_COLUMN,
	"",
	sTargetTable_HIVE_BUCKETS
));
%>

hive = new flexUtilHive( odiRef.getJDBCConnection("DEST") )
]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[621]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a4ad52f4-1c2a-4b22-a933-51045812f5a5]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[344]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create target table ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f5aeec42-32b4-41e7-b87d-3e8189723cde]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[621]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[sql = '''
create table if not exists <%=odiRef.getTable("L","TARG_NAME","A")%>
(
	<%=myRef.getAllTargetColList("", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", "", "NOT PARTITION")%>
)
<%
%><%=myRef.getAllTargetColList("partitioned by (", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", ")\n", "PARTITION")
%><%=myRef.getAllTargetColList("clustered by (", "[COL_NAME]", ", ", ")\n", "CLUSTER")
%><%=myRef.getAllTargetColList("sorted by (", "[COL_NAME]", ", ", ")\n", "SORT")
%><%=myRef.getBuckets("into ", " buckets\n")%>
'''

hive.executeQuery( sql )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[622]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d7366b9f-0808-42d8-a7eb-64f2ea2b7214]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[345]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[220]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete/ Undeclare any inline-view scripts]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5a27ede7-830c-4d23-9bc3-9a4140ebfad8]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[622]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[// Delete any scripts files created for any inline-views

import org.apache.hadoop.fs.FileSystem
import org.apache.hadoop.fs.Path
import org.apache.hadoop.conf.Configuration
import java.net.URI

<% { iter = myRef.getScriptInfo( odiRef.getFrom() ).iterator();
while ( iter.hasNext() ) { 
    scriptInfo = iter.next();
    scriptName = scriptInfo[0];
    scriptNameFull = scriptInfo[1];
    scriptText = scriptInfo[2]; 
%>

fileName = '''<%=scriptNameFull%>'''
script = <%=getQuotedMLString(scriptText)%>

// Did we create the script?
if ( script.length() > 0) {
    // Lets remove the script file again
    fs = FileSystem.get( new URI( fileName ),  new Configuration() )
    pt = new Path( fileName )
    fs.delete( pt, 0==1 )
}

// Undeclare transformation script file
hive.executeQuery( '''delete file <%=scriptNameFull%>''' )


<% }; } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[623]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a371073d-de15-49dc-98b1-f084ed1ca4ae]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[346]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[90]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create/ Declare script]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d796bdc6-cf48-459e-920d-d08c34dac64a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[623]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[import org.apache.hadoop.fs.FileSystem
import org.apache.hadoop.fs.Path
import org.apache.hadoop.conf.Configuration
import java.net.URI
import java.io.BufferedWriter
import java.io.OutputStreamWriter
import org.apache.hadoop.fs.permission.FsPermission

fileName = '''<%=odiRef.getOption("TRANSFORM_SCRIPT_NAME")%>'''
script = <%=getQuotedMLString(odiRef.getOption("TRANSFORM_SCRIPT"))%>

// Does the interface contain the script itself?
if ( script.length() > 0) {
    // lets create the script
    fs = FileSystem.get( new URI( fileName ),  new Configuration() )
    pt = new Path( fileName )
    br = new BufferedWriter( new OutputStreamWriter( fs.create(pt)) )
    br.write( script )
    br.close()
    fs.setPermission( pt, new FsPermission( (Integer.parseInt("111111000",2)).shortValue() ) ) /* read,write,execute for user and group */
}

// Declare transformation script file
hive.executeQuery( '''add file <%=odiRef.getOption("TRANSFORM_SCRIPT_NAME")%>''' )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[624]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e4a5e286-55dc-4dae-87b5-7c84c3161224]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[347]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create/ Declare any inline-view scripts]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[bd75905a-a1f8-4ef9-8904-415e8a1d9fe4]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[624]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[// Create and declare any scripts files required for any inline-views

import org.apache.hadoop.fs.FileSystem
import org.apache.hadoop.fs.Path
import org.apache.hadoop.conf.Configuration
import java.net.URI
import java.io.BufferedWriter
import java.io.OutputStreamWriter
import org.apache.hadoop.fs.permission.FsPermission

<% { iter = myRef.getScriptInfo( odiRef.getFrom() ).iterator();
while ( iter.hasNext() ) { 
    scriptInfo = iter.next();
    scriptName = scriptInfo[0];
    scriptNameFull = scriptInfo[1];
    scriptText = scriptInfo[2]; 
%>

fileName = '''<%=scriptNameFull%>'''
script = <%=getQuotedMLString(scriptText)%>

// Does the interface contain the script?
if ( script.length() > 0) {
    // lets create the script
    fs = FileSystem.get( new URI( fileName ),  new Configuration() )
    pt = new Path( fileName )
    br = new BufferedWriter( new OutputStreamWriter( fs.create(pt)) )
    br.write( script )
    br.close()
    fs.setPermission( pt, new FsPermission( (Integer.parseInt("111111000",2)).shortValue() ) ) /* read,write,execute for user and group */
}

// Declare script file in Hive session
hive.executeQuery( '''add file <%=scriptNameFull%>''' )

<% }; } %>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[625]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[45a95efb-27df-483c-a2bd-3ea5f482778c]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[348]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Insert new rows]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f498bdc1-6c5d-40f1-96ab-20a7ddd855cf]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[625]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<%
    scriptShortName = odiRef.getOption("TRANSFORM_SCRIPT_NAME");
    li = scriptShortName.lastIndexOf("/");
    scriptShortName = (li >= 0) ? scriptShortName.substring(li+1) : "Invalid script name. Must contain at least one path separator";
    singleDataSet	= (odiRef.getDataSetMin() == odiRef.getDataSetMax());

%>
sql = <%startCapture();%>

insert overwrite table	  <%=odiRef.getTargetTable("RES_NAME")%>  <%=myRef.getAllTargetColList("partition (", "[COL_NAME]", ",", ")", "PARTITION")%>

<%for (int i=0; i < odiRef.getDataSetCount(); i++){ /* Note: only a single DataSet supported! */%>
<%=odiRef.getDataSet(i, "Operator")%>

select	<%=odiRef.getPop("DISTINCT_ROWS")%> transform( <% /* Input columns */ %>
		<%=odiRef.getSrcColList(i, "<? { firstCol = true; ?>", "", "<? if (firstCol) { firstCol=false; } else { out.print(\u0022,\u0022+(char)10+(char)9+(char)9);};?>INPUT.[COL_NAME]", "", "<?}?>")%>
	)
using '<%=scriptShortName%>'
as (	<% /* Output columns */ %>
	<%=myRef.getAllTargetColList("", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", "", "NOT PARTITION")%>
	<%=myRef.getAllTargetColList(",", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", "", "PARTITION")%>
)
from (
	select 
		<%=odiRef.getSrcColList(i, "<? { firstCol = true; ?>", "", "<? if (firstCol) { firstCol=false; } else { out.print(\u0022,\u0022+(char)10+(char)9+(char)9);};?>[POP_ALIAS].[COL_NAME]", "", "<?}?>")%>
	from	<%=myRef.removeScriptInfo( odiRef.getFrom(i) )%>
	where	(1=1)
	<%=odiRef.getJoin(i)%>
	<%=odiRef.getFilter(i)%>

	<% /* distribute/sort rows before transformation, if needed */ %>
	<% if (odiRef.getOption("PRE_TRANSFORM_DISTRIBUTE").length()>0) { out.print( "distribute by " + odiRef.getOption("PRE_TRANSFORM_DISTRIBUTE") ); }; %>
	<% if (odiRef.getOption("PRE_TRANSFORM_SORT").length()>0) { out.print( "sort  by " + odiRef.getOption("PRE_TRANSFORM_SORT") ); }; %>
) INPUT
<%}%>

<% /* distribute/sort rows after transformation, if needed */ %>
<% if (odiRef.getOption("POST_TRANSFORM_DISTRIBUTE").length()>0) { out.print( "distribute by " + odiRef.getOption("POST_TRANSFORM_DISTRIBUTE") ); }; %>
<% if (odiRef.getOption("POST_TRANSFORM_SORT").length()>0) { out.print( "sort  by " + odiRef.getOption("POST_TRANSFORM_SORT") ); }; %>

<%=getQuotedMLString(endCapture())%>

hive.executeQuery( sql )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[626]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d4d2f0fb-f8a9-459c-adc4-5bf24f53e151]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[349]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[210]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Delete / Undeclare script]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f3c9a223-4208-4e67-b165-4e96c8ea28df]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[626]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[import org.apache.hadoop.fs.FileSystem
import org.apache.hadoop.fs.Path
import org.apache.hadoop.conf.Configuration
import java.net.URI

fileName = '''<%=odiRef.getOption("TRANSFORM_SCRIPT_NAME")%>'''
script = <%=getQuotedMLString(odiRef.getOption("TRANSFORM_SCRIPT"))%>

// Did the interface create the script?
if ( script.length() > 0) {
    // then we also need to drop it
    fs = FileSystem.get( new URI( fileName ),  new Configuration() )
    pt = new Path( fileName )
    fs.delete( pt, 0==1 )
}

// Undeclare transformation script file
hive.executeQuery( '''delete file <%=odiRef.getOption("TRANSFORM_SCRIPT_NAME")%>''' )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[627]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[29fc2844-54a8-4e3a-ada0-285233837739]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[350]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[74]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:35.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[230]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[sub-select inline view]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d2ae7386-e797-45de-a2f1-d3b028b1ccad]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[627]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<%
    scriptShortName = odiRef.getOption("TRANSFORM_SCRIPT_NAME");
    li = scriptShortName.lastIndexOf("/");
    scriptShortName = (li >= 0) ? scriptShortName.substring(li+1) : "Invalid script name. Must contain at least one path separator";

%>(
<%for (int i=0; i < odiRef.getDataSetCount(); i++){%>
<%=odiRef.getDataSet(i, "Operator")%>

select	<%=odiRef.getPop("DISTINCT_ROWS")%> transform(
		<%=odiRef.getSrcColList(i, "<? { firstCol = true; ?>", "", "<? if (firstCol) { firstCol=false; } else { out.print(\u0022,\u0022+(char)10+(char)9+(char)9);}; ?>INPUT.[COL_NAME]", "", "<?}?>")%>
	)
using '<%=scriptShortName%>'
as (	<%=odiRef.getAllTargetColList("", "[COL_NAME]\t[DEST_CRE_DT]", ",\n\t", "", "")%>  )
from (
	select 
		<%=odiRef.getSrcColList(i, "<? { firstCol = true; ?>", "", "<? if (firstCol) { firstCol=false; } else { out.print(\u0022,\u0022+(char)10+(char)9+(char)9);};?>[POP_ALIAS].[COL_NAME]", "", "<?}?>")%>
	from	<%=odiRef.getFrom(i)%>
	where	(1=1)
	<%=odiRef.getJoin(i)%>
	<%=odiRef.getFilter(i)%>

	<% /* distribute/sort rows before transformation, if needed */ %>
	<% if (odiRef.getOption("PRE_TRANSFORM_DISTRIBUTE").length()>0) { out.print( "distribute by " + odiRef.getOption("PRE_TRANSFORM_DISTRIBUTE") ); }; %>
	<% if (odiRef.getOption("PRE_TRANSFORM_SORT").length()>0) { out.print( "sort  by " + odiRef.getOption("PRE_TRANSFORM_SORT") ); }; %>
) INPUT
<%}%>

)

<%
%>SNP$SCRIPTNAME<%=odiRef.getOption("TRANSFORM_SCRIPT_NAME")
%>SNP$SCRIPTFULLNAME<%=odiRef.getOption("TRANSFORM_SCRIPT_NAME")
%>SNP$SCRIPTTEXT<%=odiRef.getOption("TRANSFORM_SCRIPT")
%>SNP$SCRIPTTEXTEND]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[4e5830de-acd9-4ceb-9f7d-427b1bda7bc0]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[343]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[4653]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[179]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[fbd5b63e-bd88-4ae1-b31c-cf719691a926]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[343]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[4653]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[099adc85-4138-4f05-a176-785757ae207d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[344]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[4653]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[179]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[dfddeef1-b4f3-4979-96af-e103d1870e5d]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[345]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[4653]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrtUe">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[0a906733-7849-4ef5-afd2-4d36958b79ce]]></Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[349]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[4653]]></Field>
	<Field name="IUserExit" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="BaseKmType" type="java.lang.String">null</Field>
	<Field name="CleanupOnError" type="java.lang.String">null</Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GenType" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[590e197a-e337-4a1d-96cc-913c0fd6e875]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="IsConcurrent" type="java.lang.String">null</Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IState" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[75]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[628]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmSrcTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="KmTechno" type="java.lang.String">null</Field>
	<Field name="KmVersion" type="java.lang.String"><![CDATA[12]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:39.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[1330446576]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[RKM Hive]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[KR]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ba1e2439-4577-49f9-8205-0ea562668034]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[628]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[COMPONENT NAME: RKM HIVE
AUTHOR: Oracle

DESCRIPTION
	Reverse engineering Knowledge Module to retrieve the tables and columns from Hive. 
	This KM provides logging (Use Log & Log File Name) options.

REQUIREMENTS
	- Hive JDBC driver (and required jars) must be installed into ODI Studio/ Agent 
	(Make sure that the connection test for the Hive DataServer works.)

BASIC CONFIGURATION
	- Import this knowledge module as global knowledge module or into one of your projects.
	- Create a model, and choose the reverse context as well as the knowledge module in the "reverse" tab.
	- Execute the reverse engineering and follow up the steps in the logs

LIMITATIONS
	The mask of tables to reverse must not be empty, and at least contain the '%' character.
	The tab Selective reverse cannot be used with this knowledge module.

]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[629]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[64a78a3b-5f1b-4ba6-871f-ee48d22d2af4]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[351]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[75]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[71]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Start the Reverse]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fb03b219-22d5-47bb-8baa-2b5de9ea9890]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[629]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[srcCx = odiRef.getJDBCConnection("SRC")
srcSchema ='''<%=odiRef.getInfo("SRC_SCHEMA")%>'''

trgCx = odiRef.getJDBCConnection("DEST")
<% if (isODI12cOrLater) { %>
imod    =  '''<%=odiRef.getModel("GLOBAL_ID")%>'''
<%} else { %>
imod    =  '''<%=odiRef.getModel("ID")%>'''
<%}%>
tabpat  = [ 	'''<%=snpRef.getModel("REV_OBJ_PATT")%>''',  '''<%=snpRef.getModel("REV_OBJ_TYPE")%>''',  '''<%=snpRef.getModel("REV_ALIAS_LTRIM")%>''' ] 

 
// START THE REVERSE 
<% if (isODI12cOrLater) { %>
logger = odiRef.getLogger();
rev.initialize(imod, (String[])tabpat.toArray(), srcCx, srcSchema, trgCx, logger) 
<%} else {%>
logfile = <$startCapture();$><%=snpRef.getOption("LOG_FILE_NAME")%><$=getQuotedMLString(endCapture())$>
uselog = <%=odiRef.getOption("USE_LOG")%>==1 
rev.initialize(imod, (String[])tabpat.toArray(), srcCx, srcSchema, trgCx, uselog, logfile) 
<%}%>
rev.startReverse() 
rev.endReverse() ]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[630]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[49193bb9-97b2-428b-b511-60a656218a14]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[352]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[75]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[81]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Set MetaData]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4e88e62a-4c98-469a-9e31-bb6f4347f1bf]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[630]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (isODI12cOrLater) { /*if ODI 12C*/ %>
OdiReverseSetMetaData "-MODEL=<%=odiRef.getModel("GLOBAL_ID")%>" -USE_TABLE_NAME_FOR_UPDATE=true
<%} else { /*if ODI 10g or 11g*/%>
OdiReverseSetMetaData -MODEL=<%=odiRef.getModel("ID")%> -USE_TABLE_NAME_FOR_UPDATE=true
<%}%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[631]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[GROOVY]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[aee2cc6c-87ca-4952-923e-9da7e40afb28]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[353]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[75]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[5]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Create Java Classes]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[db28fb1b-8b6a-44e4-8074-48a55962679f]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[631]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% isODI12cOrLater = !odiRef.getInfo("ODI_MAJOR_VERSION").contains("ODI_MAJOR_VERSION"); %>
<$

/* Begin of BSh code gen extensions */

out2 = null;
buffer = null;

startCapture() {
    out2 = out;
    buffer = new ByteArrayOutputStream();
    out = new PrintWriter( buffer );
}

endCapture() {
    out.flush();
    out.close();
    captured = buffer.toString();
    out = out2;
    return captured;
}

getQuotedMLString( s ) {
// escape tripple single quotes
// escape backslashes
    return 
        "'''" + 
        s.replace(""+(char)92, ""+(char)92+(char)92)
        .replace( "'''", ""+(char)92+"'"+(char)92+"'"+(char)92+"'") +
        "'''";
}

/* End of BSh code gen extensions */

$>


/* Begin of RkmHive.java */

import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.PrintStream;
import java.io.FileOutputStream;
import java.sql.Connection;
import java.sql.DatabaseMetaData;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.Formatter;
import java.util.regex.Pattern;
import java.util.regex.Matcher;

import org.apache.hadoop.hive.service.HiveServerException;
import java.util.logging.Level;
<% if (isODI12cOrLater) { %>
import com.sunopsis.dwg.snpreference.OdiRefLogger;
<%}%>

    /**
     * class Log {
     * @return
     * Creates a log file and traces information
     */
    public class Log {
        protected boolean printToScreen = false;
        protected boolean append = false;
        protected boolean useLog = true;
        protected FileOutputStream out; 
        protected PrintStream p;
        
        public Log( String pLogfilename, boolean pUselog, boolean pAppend, boolean pPrinttoscreen) throws FileNotFoundException {
            printToScreen = pPrinttoscreen;
            useLog = pUselog;

            out = new FileOutputStream(pLogfilename,pAppend);
            p = new PrintStream( out );
        }

        public void log (Level level, String rec) {
            if (useLog) {
                String l = (new SimpleDateFormat("yyyy/MM/dd HH:mm:ss")).format(new Date()) + " - " + rec;
                p.println( l );
                p.flush();
                try {
                    out.flush();
                } catch (IOException e) {
                    e.printStackTrace();
                }
                if (printToScreen) { System.out.println( l ); };
            }
        }
        public void format(String pFormat, Object... args) {
            record( String.format( pFormat, args) );
        }
    }




public class RkmHive {

    // Hive data type driver constants
    protected static final String HIVE_DATATYPE_BIGINT   = "bigint";
    protected static final String HIVE_DATATYPE_INT      = "int";
    protected static final String HIVE_DATATYPE_SMALLINT = "smallint";
    protected static final String HIVE_DATATYPE_TINYINT  = "tinyint";
    protected static final String HIVE_DATATYPE_FLOAT    = "float";
    protected static final String HIVE_DATATYPE_DOUBLE   = "double";
    protected static final String HIVE_DATATYPE_STRING   = "string";
    protected static final String HIVE_DATATYPE_BOOLEAN  = "boolean";
    protected static final String HIVE_DATATYPE_BINARY   = "binary";
    protected static final String HIVE_DATATYPE_TIMESTAMP= "timestamp";
    protected static final String HIVE_DATATYPE_ARRAY    = "array";
    protected static final String HIVE_DATATYPE_MAP      = "map";
    protected static final String HIVE_DATATYPE_STRUCT   = "struct";
    
    // SQL commands
<% if (isODI12cOrLater) { %>
    protected static final String SQL_INSERT_TABLE     = "insert into SNP_REV_TABLE (MOD_GUID,TABLE_NAME,RES_NAME,TABLE_ALIAS,TABLE_DESC,IND_SHOW,TABLE_TYPE) values (?,?,?,?,?,?,?)";
    protected static final String SQL_INSERT_TABLE_FF  = "insert into SNP_REV_TABLE_FFV (MOD_GUID,TABLE_NAME,FF_CODE,NUM_VALUE) values (?,?,?,?)";
    protected static final String SQL_INSERT_COLUMNS   = "insert into SNP_REV_COL (MOD_GUID,TABLE_NAME,COL_NAME,COL_HEADING,COL_DESC,DT_DRIVER,POS,LONGC,SCALEC,BYTES,COL_MANDATORY,CHECK_FLOW,CHECK_STAT) values (?,?,?,?,?,?,?,?,?,?,?,?,?)";
    protected static final String SQL_INSERT_COLUMN_FF = "insert into SNP_REV_COL_FFV (MOD_GUID,TABLE_NAME,COL_NAME,FF_CODE,NUM_VALUE) values (?,?,?,?,?)";
<%} else {%>
    protected static final String SQL_INSERT_TABLE     = "insert into SNP_REV_TABLE (I_MOD,TABLE_NAME,RES_NAME,TABLE_ALIAS,TABLE_DESC,IND_SHOW,TABLE_TYPE) values (?,?,?,?,?,?,?)";
    protected static final String SQL_INSERT_TABLE_FF  = "insert into SNP_REV_TABLE_FFV (I_MOD,TABLE_NAME,FF_CODE,NUM_VALUE) values (?,?,?,?)";
    protected static final String SQL_INSERT_COLUMNS   = "insert into SNP_REV_COL (I_MOD,TABLE_NAME,COL_NAME,COL_HEADING,COL_DESC,DT_DRIVER,POS,LONGC,SCALEC,BYTES,COL_MANDATORY,CHECK_FLOW,CHECK_STAT) values (?,?,?,?,?,?,?,?,?,?,?,?,?)";
    protected static final String SQL_INSERT_COLUMN_FF = "insert into SNP_REV_COL_FFV (I_MOD,TABLE_NAME,COL_NAME,FF_CODE,NUM_VALUE) values (?,?,?,?,?)";
<%}%>

    // RegEx Constants for extracting additional metadata from extended table information 
    static protected String HIVE_MD_TABLEDEF_REGEX        = "^\\QTable(\\E.*";
    static protected String HIVE_MD_PARTITIONDEF_REGEX    = "\\QpartitionKeys:[\\E(.*?)\\]";
    static protected String HIVE_MD_PARTITIONCOLUMN_REGEX = "\\QFieldSchema(name:\\E(.*?)\\Q, type:\\E(.*?)\\Q, comment:\\E(.*?)\\)";
    static protected String HIVE_MD_BUCKETDEF_REGEX       = "\\QbucketCols:[\\E(.*?)\\]";
    static protected String HIVE_MD_BUCKETCOLUMN_REGEX    = "(\\w+)";
    static protected String HIVE_MD_BUCKETS_REGEX         = "\\QnumBuckets:\\E([0-9]+)";
    static protected String HIVE_MD_SORTDEF_REGEX         = "\\QsortCols:[\\E(.*?)\\]";
    static protected String HIVE_MD_SORTCOLUMN_REGEX      = "\\QOrder(col:\\E(.*?)\\Q, order:\\E(.*?)\\)";

    // FlexField codes
    static protected String HIVE_FFNAME_BUCKETS         = "HIVE_BUCKETS";
    static protected String HIVE_FFNAME_PARTITIONCOLUMN = "HIVE_PARTITION_COLUMN";
    static protected String HIVE_FFNAME_CLUSTERCOLUMN   = "HIVE_CLUSTER_COLUMN";
    static protected String HIVE_FFNAME_SORTCOLUMN      = "HIVE_SORT_COLUMN";


<% if (isODI12cOrLater) { %>
    OdiRefLogger logger;
<%} else {%>
    Log logger;
<%}%>
    Connection srcCx, repoCx;
    String srcSchema;
    String srcTabFilter, aliasRemoveChars;
    String[] tabType;
<% if (isODI12cOrLater) { %>
    String iMod;
<%} else {%>
    String iMod;
<%}%>
    private DatabaseMetaData metadata; 
    private ArrayList listOfPartitioningCols;
    private int numOfPartitionColumns;


    //Dummy constructor
    public RkmHive() {};

    /**
     * 
     *                     Constructor:
                            iMod:        I_MODEL/MODEL_GUID value for the current Model to be reversed
                            tabPattern:  Table pattern info [Filter, TableType, AliasRemoveChars]
                            srcConnect:  Source connection
                            repoConnect: Repository connection 

                    Example:
                            src     = odiRef.getJdbcConnection(SRC)
                            repo    = odiRef.getJdbcConnection(DEST)
                            imod    = 5111/"KLJoiu78hKFRAEJ8976"
                            tabpat  = ['%', 'T', 'TRG_']
                            rev     = SnpsReverse(imod, tabpat, src, repo, 1, logfile)
                            rev.startReverse(getcolumns=1, getkeys=1, getfks=1)
                            rev.endReverse()
     * @param iMod
     * @param tabPattern
     * @throws FileNotFoundException 
     */
    public void initialize(String piMod, String[] tabPattern, Connection pSrcConnect, String pSrcSchema, Connection pRepoConnect, Boolean pUseLog, String pLogFileName) throws FileNotFoundException {    
        logger = new Log(pLogFileName, pUseLog, false, true);
        initialize( piMod, tabPattern, pSrcConnect, pSrcSchema, pRepoConnect, logger );
    }

    public void initialize(String piMod, String[] tabPattern, Connection pSrcConnect, String pSrcSchema, Connection pRepoConnect, Object/*Logger*/ logger_in) throws FileNotFoundException {    
        logger = logger_in;
        logger.log(Level.INFO, "Reverse Started.");
        iMod = piMod;

        // Do some basic tests
        if (pSrcConnect == null) 
            throw new RuntimeException( "\nFailure to open Hive JDBC connection. Please test DataServer connection." );
        if (pRepoConnect == null) 
            throw new RuntimeException( "\nFailure to open Repository JDBC connection. Please test DataServer connection." );


        // Connect to the source database:
        srcSchema  = (pSrcSchema.length() == 0)?null:pSrcSchema;
        srcCx = pSrcConnect;

        // Connect to the Repostory database:
        repoCx = pRepoConnect;

        // Table Pattern information:
        srcTabFilter = tabPattern[0];
        tabType = getTableType(tabPattern[1]);
        aliasRemoveChars = tabPattern[2];
        logger.log(Level.INFO, "Reverse Options: Model " + iMod);
        logger.log(Level.INFO, "                 Tabfilter " + srcTabFilter);
        logger.log(Level.INFO, "                 TabType " + tabType);

        // intialize source metadata
        try {
            metadata = srcCx.getMetaData();
            logger.log(Level.INFO, "Driver Name:    " + metadata.getDriverName().toString());
            logger.log(Level.INFO, "Driver Version: " + metadata.getDriverVersion());
        } catch (SQLException e) {
            logger.log(Level.INFO, "Exception when initializing source metadata");
            e.printStackTrace();
        }
    }

    /**
     * 
                    Public method to start a reverse
                    set getcolumns, getkeys and getfks flags according to
                    what you want to reverse
     * @param getcolumns
     * @param getkeys
     * @param getfks
     * @throws SQLException 
     */
    public void startReverse() throws SQLException {
        getTables(true, true, true);
    }

    /**
     * 
                    Public Method that should be called to release all opened connections
     */
    public void endReverse(){
        /* Connection management is handled by ODI and should not be done inside RKM
                logger.log(Level.INFO, "Disconnecting from Source.");
                if (!srcCx.isClosed()) { srcCx.close() }
                logger.log(Level.INFO, "Disconnecting from Repository2");
                if (!self.repoCx.isClosed()) { repoCx.close() }
         */
        logger.log(Level.INFO, "Reverse End.");                
    }

    /*
     * Returns an empty string, if s is null;
     * Returns a string no longer than maxLen characters;
     */
    protected String restrictString( String s, int maxLen ) {
        String s2 = (s == null)?"":s;
        s2 = s2.substring(0, (s2.length()>maxLen)?maxLen:s2.length());
        return s2;
    }


    /**
     * 
                    Starts the Reverse of the Tables
                    retrieves columns, keys and fks according to the flags sent as parameters
     * @throws SQLException 
     */
    protected void getTables(boolean getcolumns, boolean getkeys, boolean getflexfields) throws SQLException {
        logger.log(Level.INFO, String.format("*** Getting %s List ***", tabType));
        ResultSet tlst = metadata.getTables(null, srcSchema, srcTabFilter, tabType);
        String sqltxt = SQL_INSERT_TABLE;
        PreparedStatement psTables = repoCx.prepareStatement(sqltxt);
        while (tlst.next()) {
            String tableCat = "";
            try{ tableCat = tlst.getString("TABLE_CAT"); } finally {};
            String tableSchem = "";
            try{ tableSchem = tlst.getString("TABLE_SCHEM"); }
            catch (SQLException e) {
                /* Due to HIVE-4549 getString("TABLE_SCHEM") causes s SQLException in some 
                   Hive versions. To deal with this problam, we need to consume the exception
                   and call getString("TABLE_SCHEMA") afterwards */
                logger.log(Level.WARNING,
                    String.format(
                        "SQLException caught during getString(TABLE_SCHEM):\n" +
                        "This is likely caused by HIVE-4549.\n" +
                        "\nMessage: %s\nStack trace:\n%s",
                        e.getMessage(),
                        org.apache.commons.lang.exception.ExceptionUtils.getStackTrace(e)
                    )
                 );
                 try{ tableSchem = tlst.getString("TABLE_SCHEMA"); } finally {};
            }
            finally {};
            String tableName = "";
            try{ tableName = tlst.getString("TABLE_NAME"); } finally {};
            String remarks = restrictString(tlst.getString("REMARKS"),250);
            String ttype = tlst.getString("TABLE_TYPE");
            String tableType = getTableType2(ttype);
            // Set table type to T for external tables. Otherwise reverse will not import them.
            if (tableType.equals("X")) tableType = "T";
            String tableAlias = restrictString((aliasRemoveChars.length()>0)?tableName.replace(aliasRemoveChars, ""):tableName,128);

            logger.log(Level.INFO, String.format("Table: %s,%s,%s,%s,%s,%s,%s (%s)", iMod, tableName, tableName, tableAlias, remarks, "1", tableType,ttype));
            psTables.clearParameters();
            <% if(isODI12cOrLater) { %>
            psTables.setString(1,iMod);
            <% } else { %>
            psTables.setInt(1,Integer.valueOf(iMod));
            <% } %>
            psTables.setString(2,tableName);
            psTables.setString(3,tableName);
            psTables.setString(4,tableAlias);
            psTables.setString(5,remarks);
            psTables.setString(6,"1");
            psTables.setString(7,tableType);
            psTables.executeUpdate();

            numOfPartitionColumns = 0;
            listOfPartitioningCols = new ArrayList();
            
            // Get FlexFields
            if (getflexfields) getFlexFields(tableName);
            // Get the columns
            if (getcolumns) getColumns(tableName);
        }

        psTables.close();
        tlst.close();
        repoCx.commit();
    }


    /**
     * Retrieves columns definition of a specified table
     * @throws SQLException 
     * @throws NumberFormatException 
     */
    protected void getColumns(String tableName) throws NumberFormatException, SQLException {
        logger.log(Level.INFO, "  *** Getting Columns for table: " + tableName);
        ResultSet clst = metadata.getColumns(null, srcSchema, tableName, "%");
        String sqltxt = SQL_INSERT_COLUMNS;
        PreparedStatement ps = repoCx.prepareStatement(sqltxt);
        int colPos = 0;

        while (clst.next()) {
            String colTable = clst.getString("TABLE_NAME");
            String colName = clst.getString("COLUMN_NAME");
            // Is this a partioning column?
            if (listOfPartitioningCols.contains(colName)) {
                // Paritioning column
                // Is this the first partitioning column? 
                // (so we have already processed all standard columns)
                if (colPos > numOfPartitionColumns) {
                    // This is the first partitioning column. 
                    // So we need to place it first.
                    colPos = 1;
                } else {
                    // This is the next partitioning column
                    colPos++;
                }
            } else {
                // Standard column
            	  colPos = numOfPartitionColumns + clst.getInt("ORDINAL_POSITION");
            }
            // coldt     = clst.getString("DATA_TYPE");
            String colTypeName = clst.getString("TYPE_NAME");
            colTypeName = (colTypeName.startsWith(HIVE_DATATYPE_ARRAY))?HIVE_DATATYPE_ARRAY:colTypeName; 
            colTypeName = (colTypeName.startsWith(HIVE_DATATYPE_MAP))?HIVE_DATATYPE_MAP:colTypeName; 
            colTypeName = (colTypeName.startsWith(HIVE_DATATYPE_STRUCT))?HIVE_DATATYPE_STRUCT:colTypeName; 
            String colRemark = restrictString(clst.getString("REMARKS"),35);
            String colHeading = colName;
            int colSize = 0;
            int colDec  = 0;
            int colLen  = 0;
            int colNull = 0;
            String colIsnull = "0";

            logger.log(Level.INFO, String.format("   Column: %s, %s, %d, %s, %d, %d, %d, %s", colName, colTypeName, colPos, colSize, colDec, colLen, colNull, colIsnull));

            insertColumn(ps, colPos, colTable, colName, colTypeName, colRemark);
        }
        clst.close();
        ps.close();
        repoCx.commit();
    }

    private void insertColumn(PreparedStatement ps, int colPos,
            String colTable, String colName, String colTypeName,
            String colRemark) throws SQLException {

        // Insert column into SNP_REV_COLUMN
        ps.clearParameters();
        //protected static final String SQL_INSERT_COLUMNS   = 
        //"insert into SNP_REV_COL (I_MOD,TABLE_NAME,COL_NAME,COL_HEADING,COL_DESC,DT_DRIVER,POS,LONGC,SCALEC,BYTES,COL_MANDATORY,CHECK_FLOW,CHECK_STAT) values (?,?,?,?,?,?,?,?,?,?,?,?,?)";

        <% if(isODI12cOrLater) { %>
        ps.setString(1, iMod);     // I_MOD
        <% } else { %>
        ps.setInt(1,Integer.valueOf(iMod));
        <% } %>
        ps.setString(2,restrictString(colTable,128));                // TABLE_NAME
        ps.setString(3,restrictString(colName,128));                 // COLUMN_NAME
        ps.setString(4,restrictString(colName,128));                 // COL_HEADING
        ps.setString(5,restrictString(colRemark,250));               // COL_REMARK
        ps.setString(6,colTypeName);                                 // DT_DRIVER
        ps.setInt(7,colPos);                                         // POS
        if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_BIGINT)) {        
            ps.setInt(8,21);                                         // LONGC 
            ps.setInt(9, 0);                                         // SCALEC
            ps.setInt(10,8);                                         // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_INT)) {        
            ps.setInt(8,11);                                         // LONGC 
            ps.setInt(9, 0);                                         // SCALEC
            ps.setInt(10,4);                                         // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_SMALLINT)) {        
            ps.setInt(8,6);                                          // LONGC 
            ps.setInt(9, 0);                                         // SCALEC
            ps.setInt(10,2);                                         // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_TINYINT)) {        
            ps.setInt(8,4);                                          // LONGC 
            ps.setInt(9, 0);                                         // SCALEC
            ps.setInt(10,1);                                         // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_FLOAT)) {        
            ps.setInt(8,10);                                         // LONGC 
            ps.setInt(9,10);                                         // SCALEC
            ps.setInt(10,4);                                         // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_DOUBLE)) {        
            ps.setInt(8,10);                                         // LONGC 
            ps.setInt(9,10);                                         // SCALEC
            ps.setInt(10,8);                                         // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_STRING)) {        
            ps.setInt(8,250);                                        // LONGC 
            ps.setNull(9, java.sql.Types.INTEGER);                   // SCALEC
            ps.setInt(10,250);                                       // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_BOOLEAN)) {        
            ps.setInt(8,1);                                          // LONGC 
            ps.setNull(9, java.sql.Types.INTEGER);                   // SCALEC
            ps.setInt(10,1);                                         // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_BINARY)) {        
            ps.setInt(8,1);                                          // LONGC 
            ps.setNull(9, java.sql.Types.INTEGER);                      // SCALEC
            ps.setInt(10,1);                                         // BYTES
        } else if (colTypeName.toLowerCase().equals(HIVE_DATATYPE_TIMESTAMP)) {        
            ps.setInt(8,0);                                         // LONGC 
            ps.setInt(9,9);                                         // SCALEC
            ps.setInt(10,29);                                         // BYTES
        } else { /* for complex data types (unsupported) */
            ps.setNull(8, java.sql.Types.INTEGER);                   // LONGC 
            ps.setNull(9, java.sql.Types.INTEGER);                   // SCALEC
            ps.setNull(10, java.sql.Types.INTEGER);                  // BYTES
        };
        ps.setString(11,"0");
        ps.setString(12,"0");
        ps.setString(13,"0");
        ps.executeUpdate();
    }


    /**
     * Returns the JDBC table Type according to the Sunopsis TYpe
     * @return
     */
    protected String[] getTableType(String tabPattern) {
        ArrayList tableType = new ArrayList();

        for (String snpstype : tabPattern.split(";")) {
            if (snpstype.equals("T"))       { tableType.add("TABLE"); 
                                              tableType.add("MANAGED_TABLE"); 
                                              tableType.add("EXTERNAL TABLE"); 
                                              tableType.add("EXTERNAL_TABLE"); 
                                            }
            else if (snpstype.equals("V"))  { tableType.add("VIEW");
                                              tableType.add("VIRTUAL_VIEW");
                                            };
            else if (snpstype.equals("ST")) tableType.add("SYSTEM TABLE");
            else if (snpstype.equals("AT")) tableType.add("ALIAS");
            else if (snpstype.equals("SY")) tableType.add("SYNONYM");
            else if (snpstype.equals("QE")) tableType.add("QUEUE");
            else if (snpstype.equals("GT")) tableType.add("GLOBAL TEMPORARY");
            else if (snpstype.equals("LT")) tableType.add("LOCAL TEMPORARY");
            else tableType.add("X");
        }
        //String []strArray = new String[tableType.size()];
        return (String[]) tableType.toArray();
    }

    /**
     * Returns the ODI table Type according to the JDBC TYpe
     * @return
     */
    protected String getTableType2(String tableType) {
        if (tableType.equals("TABLE"))            return("T");
        if (tableType.equals("MANAGED_TABLE"))    return("T");
        if (tableType.equals("EXTERNAL TABLE"))   return("T");
        if (tableType.equals("EXTERNAL_TABLE"))   return("T");
        if (tableType.equals("VIEW"))             return("V");
        if (tableType.equals("VIRTUAL_VIEW"))     return("V");
        if (tableType.equals("SYSTEM TABLE"))     return("ST");
        if (tableType.equals("ALIAS"))            return("AT");
        if (tableType.equals("SYNONYM"))          return("SY");
        if (tableType.equals("QUEUE"))            return("QE");
        if (tableType.equals("GLOBAL TEMPORARY")) return("GT");
        if (tableType.equals("LOCAL TEMPORARY"))  return("LT");
        return("X");
    }


    protected getFlexFields(String tableName) throws SQLException {

        Pattern p = Pattern.compile( HIVE_MD_TABLEDEF_REGEX );
        Matcher m;
        Statement stmt = srcCx.createStatement();
        String qualifiedTableName = srcSchema + "." + tableName;
        // Due to 
        // HIVE-1977 DESCRIBE TABLE syntax doesn't support specifying a database qualified table name
        // we have to use the unqualified table name for now
        //ResultSet lst = stmt.executeQuery( "describe extended " + qualifiedTableName );
        ResultSet lst = stmt.executeQuery( "describe extended " + tableName );
        String extendedTableInfo = ""; 
        // Iterate over lines of metadata returned to locate the line containing the detailed table information
        String s ="";
        try {
            while (lst.next()) {
                s = lst.getString(2);
                s = (s==null)?"":s;
                m = p.matcher( s );
                if (m.find()) {
                    extendedTableInfo = s;
                    logger.log(Level.INFO, String.format( "Extended Table information for table %s: >>>%s<<<", qualifiedTableName, extendedTableInfo));
                }
            }
        } catch (SQLException e) {
            // This catch is a work-around for HIVE-2381 SQLException thrown when the resultset becomes empty. 
        } finally {};
        lst.close();
        stmt.close();

        // Extract partitioning column definitions
        p = Pattern.compile( HIVE_MD_PARTITIONDEF_REGEX );
        m = p.matcher( extendedTableInfo );
        numOfPartitionColumns = 0;
        if (m.find()) {
            String sPartitionDef = m.group(1);
            logger.log(Level.INFO, String.format( "Partitioning Definition found: >>>%s<<<", sPartitionDef));

            // Do we have a non-empty partition definition?
            if (sPartitionDef != null && sPartitionDef.length()>0) {
                String sqltxt = SQL_INSERT_COLUMNS;
                PreparedStatement psCol = repoCx.prepareStatement(sqltxt);
                sqltxt = SQL_INSERT_COLUMN_FF;
                PreparedStatement psColFF = repoCx.prepareStatement(sqltxt);

                p = Pattern.compile( HIVE_MD_PARTITIONCOLUMN_REGEX );
                m = p.matcher( sPartitionDef );
                while (m.find()) {
                    String sColName = m.group(1); 
                    String sDataType = m.group(2); 
                    String sRemark = m.group(3); 
                    logger.log(Level.INFO, String.format( "Partition Column found: name:%s, type:%s, remark:%s",sColName, sDataType, sRemark));
                    // Remember the paritioning column name
                    listOfPartitioningCols.add(sColName);

                    // Previously needed due to the Hive JDBC driver in Hive 0.7.0 not reporting back partitioning columns
                    // Insert column
                    // insertColumn(psCol, numOfPartitionColumns, tableName, sColName, sDataType, sRemark);

                    // Set FF HIVE_PARTITION_COLUMN
                    psColFF.clearParameters();
                    <% if(isODI12cOrLater) { %>
                    psColFF.setString(1,iMod);
                    <% } else { %>
                    psColFF.setInt(1,Integer.valueOf(iMod));
                    <% } %>
                    psColFF.setString(1,iMod);
                    psColFF.setString(2,tableName);
                    psColFF.setString(3,sColName);
                    psColFF.setString(4,HIVE_FFNAME_PARTITIONCOLUMN);
                    psColFF.setInt(5,1);
                    psColFF.executeUpdate();

                    numOfPartitionColumns++;
                }
                psCol.close();
                psColFF.close();
            }

        }

        // Extract bucket column definitions
        p = Pattern.compile( HIVE_MD_BUCKETDEF_REGEX );
        m = p.matcher( extendedTableInfo );
        if (m.find()) {
            String sClusteringDef = m.group(1);
            logger.log(Level.INFO, String.format( "Bucket Definition found: >>>%s<<<", sClusteringDef));

            // Do we have a non-empty clustering definition?
            if (sClusteringDef != null && sClusteringDef.length()>0) {
                String sqltxt = SQL_INSERT_COLUMN_FF;
                PreparedStatement psColFF = repoCx.prepareStatement(sqltxt);

                p = Pattern.compile( HIVE_MD_BUCKETCOLUMN_REGEX );
                m = p.matcher( sClusteringDef );
                while (m.find()) {
                    String sColName = m.group(1); 
                    logger.log(Level.INFO, String.format( "Cluster Column found: name:%s",sColName));
                    // Set FF HIVE_CLUSTER_COLUMN
                    psColFF.clearParameters();
                    <% if(isODI12cOrLater) { %>
                    psColFF.setString(1,iMod);
                    <% } else { %>
                    psColFF.setInt(1,Integer.valueOf(iMod));
                    <% } %>
                    psColFF.setString(2,tableName);
                    psColFF.setString(3,sColName);
                    psColFF.setString(4,HIVE_FFNAME_CLUSTERCOLUMN);
                    psColFF.setInt(5,1);
                    psColFF.executeUpdate();
                }
                psColFF.close();
            }
        }


        // Extract number of buckets
        Pattern pBuckets = Pattern.compile( HIVE_MD_BUCKETS_REGEX );
        m = pBuckets.matcher( extendedTableInfo );
        Integer iBuckets = null;
        if (m.find()) {
            iBuckets = Integer.valueOf( m.group(1) );
            logger.log(Level.INFO, String.format("Number of bucket found: %d", iBuckets));
        }        
        // Set FF HIVE_BUCKETS
        if (iBuckets != null) {
            String sqltxt = SQL_INSERT_TABLE_FF;
            PreparedStatement psTableFF = repoCx.prepareStatement(sqltxt);
            psTableFF.clearParameters();
            <% if(isODI12cOrLater) { %>
            psTableFF.setString(1,iMod);
            <% } else { %>
            psTableFF.setInt(1,Integer.valueOf(iMod));
            <% } %>
            psTableFF.setString(2,tableName);
            psTableFF.setString(3,HIVE_FFNAME_BUCKETS);
            psTableFF.setInt(4,iBuckets);
            psTableFF.executeUpdate();
            psTableFF.close();
        }


        // Extract sort column definitions
        p = Pattern.compile( HIVE_MD_SORTDEF_REGEX );
        m = p.matcher( extendedTableInfo );
        if (m.find()) {
            String sSortDef = m.group(1);
            logger.log(Level.INFO, String.format( "Sort Definition found: >>>%s<<<", sSortDef));

            // Do we have a non-empty sorting definition?
            if (sSortDef != null && sSortDef.length()>0) {
                String sqltxt = SQL_INSERT_COLUMN_FF;
                PreparedStatement psColFF = repoCx.prepareStatement(sqltxt);

                p = Pattern.compile( HIVE_MD_SORTCOLUMN_REGEX );
                m = p.matcher( sSortDef );
                while (m.find()) {
                    String sColName = m.group(1); 
                    logger.log(Level.INFO, String.format( "Sort Column found: name:%s",sColName));
                    // Set FF HIVE_SORT_COLUMN
                    psColFF.clearParameters();
                    <% if(isODI12cOrLater) { %>
                    psColFF.setString(1,iMod);
                    <% } else { %>
                    psColFF.setInt(1,Integer.valueOf(iMod));
                    <% } %>
                    psColFF.setString(2,tableName);
                    psColFF.setString(3,sColName);
                    psColFF.setString(4,HIVE_FFNAME_SORTCOLUMN);
                    psColFF.setInt(5,1);
                    psColFF.executeUpdate();
                }
                psColFF.close();
            }
        }
        return numOfPartitionColumns;
    }


/*
    public static void main(String[] args) throws FileNotFoundException, SQLException, ClassNotFoundException {
        Class.forName("org.apache.hadoop.hive.jdbc.HiveDriver");
        String connectionURL = "jdbc:hive://vbcloudera:10000/default";
        Connection srcCx = DriverManager.getConnection (connectionURL);

        Class.forName("oracle.jdbc.driver.OracleDriver");
        connectionURL = "jdbc:oracle:thin:@//ckurz-de2:1521/orcl.ckurz-de2.de.oracle.com";
        Connection repoCx = DriverManager.getConnection (connectionURL,"KM_W_CK_LOCAL_DEV_11_1_1_6", "KM_W_CK_LOCAL_DEV_11_1_1_6");

        String srcSchema = "default";
        String imod    =  "173038";
        String[] tabpat  = { "rkm_hive_test%",  "T;V",  "src_" } ;

        RkmHive rev = new RkmHive();
        // START THE REVERSE 
        rev.initialize(imod, (String[])tabpat, srcCx, srcSchema, repoCx, odiRef.getLogger()); 
        rev.startReverse();
        rev.endReverse();
    }
*/
}

/* End of RkmHive.java */

rev     = new RkmHive()]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColPlanComp" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[HIVE]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[632]]></Field>
	<Field name="DefLschemaName" type="java.lang.String">null</Field>
	<Field name="DefPlanComp" type="java.lang.String">null</Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[SUNOPSIS_API]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[ccea537b-f256-4d10-a60e-6689cb265e77]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogMethod" type="java.lang.String">null</Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[354]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[75]]></Field>
	<Field name="KcmAk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmCond" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmErrDel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmJoin" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmNull" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KcmPk" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimDrvdSel" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KimJrnPop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmCreate" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmDrop" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmExtend" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmPurge" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetInstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSetUninstall" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmSubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmTableOrder" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KjmUnsubscribe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmAfterInt" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmIdx" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KlmJrn" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="KxmUsed" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 23:23:38.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[4]]></Field>
	<Field name="MapTaskType" type="java.lang.String">null</Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[51]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[Reset MetaData]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[95bba3d2-c482-49d5-9286-b181ce84d007]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[632]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[<% if (isODI12cOrLater) { /*if ODI 12C*/ %>
  OdiReverseResetTable -MODEL=<%=odiRef.getModel("GLOBAL_ID")%>
<%} else { /*if ODI 10g or 11g*/ %>
  OdiReverseResetTable -MODEL=<%=odiRef.getModel("ID")%>
<%}%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFolder">
		<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="FolderName" type="java.lang.String"><![CDATA[First Folder]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9ef4a1a8-0aee-4574-ae9a-930d60d0a918]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[12]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[13]]></Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2014-03-09 22:58:18.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[SUPERVISOR]]></Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ParIFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ReleaseTag" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PROJECT.13]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ff0075bc-ff55-4a52-b3a7-f6aa674d2046]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_GRPSTATE.14]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7bc0ee0b-2008-4e55-8967-1e8672031c86]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_GRPSTATE.15]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c9d974de-3420-424d-831b-9f9890babd55]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_GRPSTATE.16]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[38b62e1f-0614-478b-9abb-c05f8e66ace2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.513]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ec6aadd7-004a-4f5e-a7c7-c6c72fa47873]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.70]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ea761be9-9f0c-460b-bb6a-5f18a4e716f7]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.514]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5591ef7a-02d9-475e-903d-23ae2988653e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.515]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e0e33a27-0179-4eb8-a825-2391f9ecbba2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.516]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4218bc2e-2ec9-4f0c-ac9d-a8c5ba9c310d]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.517]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5e2c54b3-5b45-4b40-9d8b-ad3a13d2b2e6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.518]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[aeec37ad-6d59-47e9-af67-2669012d261e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.519]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[53fc44db-93e5-49dc-ab4a-5d88d919816b]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.520]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[8ae2f68c-1171-4fe4-8b7c-d4ceadb56e05]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.521]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d226802c-bd08-40c6-ae7c-3eceab5c5167]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.522]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[20798d8e-586b-453f-b7f7-4df4008acdb2]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.523]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[46be3557-f517-478a-8bf3-c5d95a474898]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.524]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7e7e5b1f-5b55-4299-864b-4de4499f0938]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.525]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[00f01d3e-76af-436d-a9e3-519241e5edfb]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.146]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[12390497-52f6-4b59-9f4a-a57dfa51efa6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.282]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[84911d9f-eaf8-4bf5-bf80-4d3cb0f8d98a]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.283]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2cc9c840-cadf-48c9-8632-d3c97b9fc0b5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.284]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3b3ea5ad-c7de-4bdd-859a-f58fa012fd29]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.285]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[912be322-a4c7-4b31-a31d-d957b3e56b6e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.286]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[807d6e03-8600-4c35-9075-9e83e9d04f07]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.287]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[919355ec-6999-4ce2-af42-1e16ba6fc6f0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.288]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2e45ede0-a0f5-4fe1-aca3-4551d1a71d2f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.289]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[447ecacd-4af0-4428-af28-6c7137f47141]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.290]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0c34fb7c-86eb-4f1f-98af-1b336da95030]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.291]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[83317b5e-d952-4dcc-be1e-2fab208208e7]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.526]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5411b001-9f1d-4b1a-ba26-b9f429dd0efc]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.71]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[8cfd885b-8db3-4b2c-bfe9-0a46ae86b980]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.527]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[49ca068c-d688-4e03-8f1d-3b5c9be8f2eb]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.528]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[316468da-eb19-4e1a-b9ed-7350f60db06d]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.529]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2fb36052-efe7-40c3-9ef9-5cfe31e70c7e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.530]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ddd77262-a645-46e3-8218-33b292a95b95]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.531]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[406868b6-db58-4de6-9ef9-fcabcf011968]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.532]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3b03177c-753e-4dc5-9100-33a6be7432d6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.533]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5be10207-95bb-46dc-b031-09d30b505f64]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.534]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0d3b344a-900d-4781-a0b7-41ebc4c11e3c]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.535]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f330a194-261c-4faa-80b4-0601b49a1f6b]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.536]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5fbc76c9-622e-46a6-91d1-5adc383674c9]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.538]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[8af928d6-6eb9-4686-a8a4-eac10ad3bfa0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.537]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a241ad9f-b61a-4ed0-8183-2182a57234cf]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.539]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[269fa5f0-4f6b-42a5-bf0c-3e0c285ae195]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.540]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c05c954b-a948-4356-8ba1-1b388144adcc]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.541]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1321cec9-7ad4-49a9-9e0e-0ebae8fb6ae7]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.542]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4650ed27-beab-45c5-ac00-41cd5c5a5f6e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.543]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[74fc5348-9034-4036-8e77-a17d4bc1695e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.544]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d91b91ff-c876-49f2-aab0-7363c34d9bdb]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.149]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9066a453-b9fe-4387-ac03-3989e9fa152d]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.292]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7d9c8642-3497-4bc6-a545-84f4c7124fa5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.153]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0512e867-cbf8-4843-8a23-9184a71fe67d]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.148]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2537701a-3939-4acf-88e2-667d317c842b]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.152]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[80e52c00-d932-4902-a5de-aa303ad6d473]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.151]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[fe940497-0174-4b4f-9ef4-f1594c9af541]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.150]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c1ae5988-8231-4428-891a-d7cce06b0b4d]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.293]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1de53582-c700-4a69-a9f0-5ab0d789c207]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.294]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3abe3308-78c2-4c58-a996-d9afdfd85dec]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.295]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f310f7a1-34f6-48fd-b1c7-5a4a44e3000e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.296]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[8e09012d-bd46-47c9-956f-151b49f7e83f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.297]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9d479535-765d-4d57-9f91-b5c96d4cbf89]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.156]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[44d22678-11ea-4997-b2b8-68b185db4685]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.299]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e55c74fb-a4df-43a3-a1bd-e736c0aead98]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.545]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5b0a9977-5f98-4a75-93bb-c3ff78610ee8]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.72]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[57fbdddc-71d6-4e38-b76c-eb08bd07fc60]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.546]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[b1f858f2-c218-4f0c-abcd-8d59f8c08e30]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.547]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5b8fd849-8b50-4dbc-be47-8b10d7a71ec9]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.548]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f23da6c4-6890-44c0-a29f-798cbd0e581a]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.549]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[772eaf70-5605-489b-8f0a-5fc605e4988e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.550]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[80ce6950-4ecd-40f2-8165-3b124915324e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.551]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a2fd777e-003d-4ad3-9f1f-9e4d9bfb4eb5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.552]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[03c5f14f-42ed-4f0a-88df-2de701123aed]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.553]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7c2387f8-e4e7-4a82-a68e-f48f6b8cbcff]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.554]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c4f8e377-2c76-4966-8ecb-e86e54e732cd]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.555]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d23e9e07-f9f5-459e-883a-6f0ba9d92f3b]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.556]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ec44ddef-4a66-466d-9803-bdbb9d5b069a]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.557]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[96ebc139-73cd-4779-9731-f2badede47c9]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.558]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4b764d01-3ef2-418c-90b3-78f2e6263046]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.559]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ffc2db53-11d5-4e8c-927a-521174852ed0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.560]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c7172967-d693-43ff-a773-389daa6124f3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.561]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[dde96ca9-2efd-4495-9d3b-2fb4dbd2e68c]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.562]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c5c6755f-0f19-41f8-b21c-169b78752327]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.563]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1b6361ab-4993-45b2-bd6b-9690d3367288]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.564]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[039d517b-a11b-4615-b17a-a4fe2d87820a]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.565]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[08585054-416f-433a-89be-eed29238c509]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.566]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[bca01b15-5b64-4929-ae1f-435bfc3ca294]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.567]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[807ed9c7-0aa3-4511-a172-2d1881704e99]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.568]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ac5a146d-d9b0-403f-9dc8-373e657d6cd4]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.569]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[366c4c7c-d14c-4ac6-a51f-d8747c61ad1f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.570]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a0552196-3020-4d68-8737-4cfb38b5073c]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.571]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[17808759-c045-49a7-b837-f88bfe9b1abe]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.572]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[779a8447-9ae1-4c4e-9d48-4f4f6e78684a]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.573]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5ea89b51-98f4-4b77-8390-34eb3e8ce970]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.574]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9cee6404-3d16-4393-b0d5-37254ac50d51]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.575]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a2231397-3244-42cd-a8b9-21419ad40b16]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.576]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3286fbfa-5f00-42f0-922f-3ce6df2ddf05]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.577]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4a8d2df1-f486-48e3-be88-ba08ae239b41]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.578]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[23f78820-8916-4f91-93f4-1a55d835a063]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.579]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1e10d7ce-3899-447e-993a-b88bfddb2f88]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.580]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d9e949a5-3022-4ac9-9d6a-177406abbb94]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.581]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7c1f5925-2a48-4345-8a22-5a5a73481fdf]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.582]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1e9cc554-f138-4d69-8cb7-d123a50a5360]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.583]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2a545cd5-2b42-4d9e-8c69-041d68d578ab]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.584]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1aecfde1-d3f3-467a-b21c-d63a30276e73]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.585]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3946632a-f59e-46fa-b46b-2eab7bf76f46]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.586]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[15891297-89cc-4a05-bed3-63df8948abe3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.587]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[69f098a8-cb4f-4370-89b5-461cca5b0a93]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.162]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[19a59ad1-52e8-4438-a94f-90f9bc3a8b1e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.300]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[6b46a03c-99f0-45e5-8bfa-17fc90135e41]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.160]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[38685251-1e4d-444b-99b7-7557a84e48ca]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.161]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[79adefcd-dc8c-4cc4-b789-586741f1d9fc]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.164]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9a578002-e6f8-47a8-b7cf-24f112ab019c]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.169]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d05999db-1200-4e39-9b03-c323f8d82bf6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.163]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4bf3f868-8296-4cae-9866-7a405b487290]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.301]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4c6d3d58-4fd7-4a6c-a5ce-03673f177e71]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.302]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5052c0dc-9b48-43fe-a8ca-eb650d17d908]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.303]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[196ca6c3-1ae7-4c9c-a8e7-25d967bb5a5b]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.304]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[57bea543-277e-461f-ab5a-af16ccfd9552]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.305]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[6df097c9-77a3-4513-99ee-f207bd3b63ee]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.306]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3b8d9e8d-818d-476f-a407-6d7935490f1d]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.307]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[db4b5399-112e-4e9a-86a4-fc1182e09853]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.308]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[87e575df-5299-45f8-8d47-ff97b12a5c4f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.309]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ab24c234-f9f8-4afe-8eb7-4b9b6785791f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.310]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f9d52726-9908-4ad3-b50c-af2b44ffbe38]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.311]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5d21df24-4ded-4e50-a85d-1528838a2c00]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.312]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[42b175d8-3237-4188-b10a-f61629484e43]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.320]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[70e4a7df-6249-441e-82a7-1993d7483be4]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.321]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[33137e28-c63d-4a01-b591-7c10ebba5f35]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.322]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[20aefed3-2a2b-4bff-adf1-e7d9ced846ec]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.323]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[83ad68a8-9b22-426e-a72d-5ede3e429cc8]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.324]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ba2d89d8-895c-4e46-b521-f2d98b5e203b]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.325]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1b92799c-45ce-43cd-8944-a8e929699d43]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.326]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[21163222-819d-488f-93ae-e6c11e66a110]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.327]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2bb7e16f-3d11-4ca0-aa16-2a4c211d3099]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.588]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3cf78c63-2ce6-425a-bc4f-7493ace72559]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.73]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[63ca866c-51e6-47e2-9558-f3232e2a4c37]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.589]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[131241b0-b4a4-49aa-9ecb-728798bd8933]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.590]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c5e149d1-df89-4f5d-9e6e-ed45239eab45]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.591]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[51ad897b-ca56-4d21-9311-3bc6e7a90376]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.592]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c3beafbc-d26b-45b5-ab94-02018de0a8fd]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.593]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[18eb20ae-0e13-4c1e-bce5-dd42d782b84d]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.594]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e64f5c99-fde2-4074-8e8e-0b584eafd2aa]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.595]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[47e11236-7943-4145-b7dd-29ad42a3c7ac]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.596]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a3c73b2f-1792-4e51-b1f1-fd772421c5ad]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.597]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[dc38aa38-0fd1-40eb-bec3-60d722a88322]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.598]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[066704dc-c6ee-49fa-8449-16e9b416aef0]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.599]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d6390506-0240-430e-8294-617f403e3316]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.600]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0278aee7-a7b4-4eaa-bf47-6139d424042f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.601]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[838c0d74-7e2c-4cab-8fed-b5819fa3072f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.602]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[226f6a62-cc2c-4a52-a838-499cd77b74f1]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.603]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[08e7597f-899f-4c74-af08-17d618f8c92e]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.604]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d0422d5e-35d1-4caa-80de-5b704dda76ed]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.605]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7f44d1b3-7fda-41a1-ba5d-71a910946c57]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.606]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d12477ee-8d44-416e-9886-82906d4a0e69]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.607]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a307f651-44aa-4d1a-9202-e87a49bff2f3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.608]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9220e1b2-a032-4839-bf62-fdcae5c7ad7f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.609]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1e2c15f0-8c89-4a96-aa0d-46425c3da06a]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.610]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1bf5b8cf-2e81-4828-8cca-53cf5ec05415]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.172]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c78c09e2-530d-4b74-883c-9baa82da476a]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.328]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[8573857a-3125-4867-9bfb-ec8299ad181c]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.174]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[23c74eda-9976-4526-a3b9-b782d05c09fc]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.173]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[8371f980-0295-4d4e-9fde-a83bf32a55d6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.175]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[70fcd5e5-cb14-40c7-90f7-459289338e13]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.177]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[8b60f15d-010e-4319-996f-eafa8fc3b0b8]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.176]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[772d5f7a-33c6-4eae-861b-b23cb64429e4]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.329]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4ba10f6c-ab25-4764-a767-8f21829f0934]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.330]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[962381e6-dc45-4a78-a609-9238055703e3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.331]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e1cd35b4-352c-405d-9252-64cc12e1173f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.332]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[19a60adc-a399-4e7d-9964-39e9909312b9]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.333]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ff4461af-2449-4ca0-8041-3ef1d8433b15]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.334]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7f73000f-c391-4bc4-9e00-327d137f3f78]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.335]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e31cca75-0c9c-4bbd-869e-551e88ee4e52]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.336]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f653a8a9-e24f-424f-bc03-c7f25db3aca5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.337]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0e3b6fc6-c209-4640-a6c2-6838c15e653f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.338]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d792c078-267f-4151-86f6-09f99c41623f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.339]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7ddf9bb6-742a-4e28-afea-0dcdf8bdf803]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.340]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c6176fc0-854e-4b42-92c8-a6bd528c9ce6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.341]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0c1bc295-89a8-4ac8-8807-c38707ebb374]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.342]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[99aba01a-3e1c-495b-b2fe-1c31147869be]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.611]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3f0d287a-d5a0-44ba-90e0-aca9b5322122]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.74]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9da73d07-4325-4ffb-ad35-2ea16060d611]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.612]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9cafda28-1b2d-4d29-9ce3-0ac17a148245]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.613]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[0e338e71-9d29-4302-bb0c-953d88fd3727]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.614]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3f748c0b-9ad4-4c39-a18e-eaadd6a9bf05]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.615]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[82662be7-356c-47ce-81b6-24fc0fd13d7b]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.616]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[b83c1359-9950-42b3-a2d8-634ac777e4b9]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.617]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[af5e4fdc-1712-44ec-81e4-1d58b1040f47]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.618]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[08d4a718-250c-410c-991c-63853faf1d04]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.619]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[39beb1d4-a54d-4295-819b-557a84cad289]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.620]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d28c48d1-b980-4ac7-a810-b2a8b6bc8beb]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.621]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f5aeec42-32b4-41e7-b87d-3e8189723cde]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.622]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5a27ede7-830c-4d23-9bc3-9a4140ebfad8]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.623]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d796bdc6-cf48-459e-920d-d08c34dac64a]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.624]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[bd75905a-a1f8-4ef9-8904-415e8a1d9fe4]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.625]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f498bdc1-6c5d-40f1-96ab-20a7ddd855cf]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.626]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f3c9a223-4208-4e67-b165-4e96c8ea28df]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.627]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d2ae7386-e797-45de-a2f1-d3b028b1ccad]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.179]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d0f66722-3dbb-4e02-abb8-54ac2d9300b6]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.343]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2a8449b2-0c97-498a-a973-59fa78b05ff1]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_USEREXIT.180]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a86815df-61ce-4e0f-83d8-8ab59d575aeb]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.344]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a4ad52f4-1c2a-4b22-a933-51045812f5a5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.345]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d7366b9f-0808-42d8-a7eb-64f2ea2b7214]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_LINETRT.349]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d4d2f0fb-f8a9-459c-adc4-5bf24f53e151]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.628]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[ba1e2439-4577-49f9-8205-0ea562668034]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.629]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[fb03b219-22d5-47bb-8baa-2b5de9ea9890]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.75]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[590e197a-e337-4a1d-96cc-913c0fd6e875]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.630]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4e88e62a-4c98-469a-9e31-bb6f4347f1bf]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.631]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[db28fb1b-8b6a-44e4-8074-48a55962679f]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.632]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[95bba3d2-c482-49d5-9286-b181ce84d007]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpImportRep">
		<Field name="GlobalId" type="java.lang.String"><![CDATA[b5325a4a-81ed-4c80-8678-607c3491720e]]></Field>
	<Field name="RepGuid" type="java.lang.String"><![CDATA[fb665016-abf4-412b-91ed-ab6c85f9ef51]]></Field>
	<Field name="RepShortId" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="RepTimestamp" type="java.lang.String"><![CDATA[1389998272933]]></Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[120]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[333]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[120]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.1.2 - 17/09/2013]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[2]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.01.01.16]]></Field>
</Object>
</SunopsisExport>
